{"remainingRequest":"D:\\VNT_vue\\node_modules\\babel-loader\\lib\\index.js!D:\\VNT_vue\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\VNT_vue\\src\\stores\\msstore.js","dependencies":[{"path":"D:\\VNT_vue\\src\\stores\\msstore.js","mtime":1653205086677},{"path":"D:\\VNT_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\VNT_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\VNT_vue\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJEOi9WTlRfdnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiRDovVk5UX3Z1ZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX2Fzc2VydFRoaXNJbml0aWFsaXplZCBmcm9tICJEOi9WTlRfdnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkQ6L1ZOVF92dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICJEOi9WTlRfdnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlciI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiRDovVk5UX3Z1ZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb3J0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zdGFydHMtd2l0aC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgaHR0cENsaWVudCBmcm9tICdAL2FwaXMvYmFzZS9odHRwQ2xpZW50JzsgLy8gaW1wb3J0IEZpbHRlciBmcm9tICdAL2FwaXMvZmlsdGVyJzsKCmltcG9ydCBjb21tb25GdW5jdGlvbiBmcm9tICdAL2NvbW1vbnMvY29tbW9uRnVuY3Rpb24nOwppbXBvcnQgeyBNU0V2ZW50TmFtZSB9IGZyb20gJ0AvY29tbW9ucy9ldmVudE5hbWUnOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCBtb2RlbFV0aWwgZnJvbSAnQC9jb21tb25zL21vZGVsVXRpbCc7CmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7IC8vIGltcG9ydCBjbGllbnREYXRhYmFzZSBmcm9tICdAL2NhY2hlL2NsaWVudERhdGFiYXNlJzsKCi8qKg0KICogxJDhu5FpIHTGsOG7o25nIHRo4buxYyBoaeG7h24gcXXhuqNuIGzDvSBk4buvIGxp4buHdTogY2jhu6lhICsgbG9hZC9hZGQvdXBkYXRlL2RlbGV0ZSB0csOqbiBjw6FjIGNvbnRyb2w6IGdyaWQgKyBjb21ibyArIGRyb3Bkb3cNCiAqIEhv4bq3YyBkw7luZyDEkeG7gyBsb2FkRGF0YSB0csOqbiBmb3JtLCAuLi4NCiAqIEThu68gbGnhu4d1IHPhur0gdGhhbyB0w6FjIHRyw6puIGBkYXRhYCAobMOgIGThu68gbGnhu4d1IMSRw6MgxJHGsOG7o2MgeOG7rSBsw706IHNvcnQsIGZpbHRlcikuDQogKiA9PiBWw60gZOG7pTogQ8OhYyBhY3Rpb24gUmVtb3ZlIGPFqW5nIHBo4bqjaSB44butIGzDvSB0csOqbiDEkcOieSwgbuG6v3UgdHLDqm4gYGRhdGFgIGtow7RuZyBjw7MgbcOgIHRyw6puIGRhdGFzb3VyY2UgY8OzIHRow6wgY2jhu4kgeMOzYSB0csOqbiBgZGF0YWANCiAqIEBhdXRob3IgRE5UaGFuZyAtIDA0LjA3LjIwMTkNCiAqLwoKdmFyIE1TU3RvcmUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9WdWUpIHsKICBfaW5oZXJpdHMoTVNTdG9yZSwgX1Z1ZSk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoTVNTdG9yZSk7CgogIC8qKg0KICAgKiBLaOG7n2kgdOG6oW8gU3RvcmUNCiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgVMO5eSBjaOG7jW4ga2jhu59pIHThuqFvDQogICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5wcm94eV0gxJDhu5FpIHTGsOG7o25nIHByb3h5IHBo4bulYyB24bulIGxvYWQgZOG7ryBsaeG7h3UNCiAgICogQHBhcmFtIHtBcnJheX0gW29wdGlvbnMuZGF0YV0gZOG7ryBsaeG7h3Uga2jhu59pIHThuqFvDQogICAqIEBhdXRob3IgRE5UaGFuZyAwMS4wNy4yMDE5DQogICAqLwogIGZ1bmN0aW9uIE1TU3RvcmUob3B0aW9ucykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNU1N0b3JlKTsKCiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImlkUHJvcGVydHkiLCBudWxsKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJpc1N0b3JlIiwgdHJ1ZSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiYXV0b0xvYWQiLCBmYWxzZSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAibG9hZGluZyIsIGZhbHNlKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJfbG9hZGVkIiwgZmFsc2UpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIl9sYXN0UmVxdWVzdFBhcmFtS2V5IiwgJycpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInNvcnRPbkxvYWQiLCB0cnVlKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJyZW1vdGVTb3J0IiwgZmFsc2UpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbW90ZUZpbHRlciIsIGZhbHNlKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJtb2RlbCIsIHVuZGVmaW5lZCk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY29tcGxldGUiLCB0cnVlKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJmaWx0ZXJzIiwgW10pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInNvcnRlcnMiLCBbXSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZGF0YVNvdXJjZSIsIHsKICAgICAgaXRlbXM6IFtdCiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJkYXRhIiwgewogICAgICBpdGVtczogW10sCgogICAgICAvKioNCiAgICAgICAqIEtp4buDbSB0cmEgaXRlbSBjw7MgbuG6sW0gdHJvbmcgYXJyYXkgaXRlbXMga2jDtG5nDQogICAgICAgKi8KICAgICAgY29udGFpbnM6IGZ1bmN0aW9uIGNvbnRhaW5zKGl0ZW0pIHsKICAgICAgICB2YXIgbWUgPSB0aGlzLAogICAgICAgICAgICBleGlzdCA9IGZhbHNlOwoKICAgICAgICBpZiAoaXRlbSkgewogICAgICAgICAgaWYgKG1lLml0ZW1zLmluZGV4T2YoaXRlbSkgPiAtMSkgewogICAgICAgICAgICBleGlzdCA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZXhpc3Q7CiAgICAgIH0KICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIl9yZW1vdmVkIiwgW10pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIl9vd25lckN0ciIsIG51bGwpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInByb3h5IiwgewogICAgICAvKioNCiAgICAgICAqIExv4bqhaSBwcm94eSBsw6AgZ8OsIChEZWZhdWx0IHPhur0gbMOgIHNlcnZlciwgbuG6v3UgY+G6p24gbG9hZCB04burIGNhY2hlIHRow6wgc+G6vSBj4bqldSBow6xuaCBsw6AgJ2NhY2hlJykNCiAgICAgICAqLwogICAgICB0eXBlOiAnJywKCiAgICAgIC8qKg0KICAgICAgICogS2V5IGPhu6dhIGThu68gbGnhu4d1IHPhur0gxJHhu41jIHRyb25nIGNhY2hlDQogICAgICAgKiAgKFPhu60gZOG7pW5nIHRyb25nIHTDrG5oIGh14buRbmcgdHlwZSA9PSAnY2FjaGUnKQ0KICAgICAgICovCiAgICAgIGtleUNhY2hlOiAnJywKCiAgICAgIC8qKg0KICAgICAgICogUGF0aCB1cmwgY+G7p2EgYXBpDQogICAgICAgKiAgKFPhu60gZOG7pW5nIHRyb25nIHTDrG5oIGh14buRbmcgdHlwZSAhPSAnY2FjaGUnKQ0KICAgICAgICovCiAgICAgIGFwaVVybDogJycsCgogICAgICAvKioNCiAgICAgICAqIE1ldGhvZCBj4bunYSBhcGkNCiAgICAgICAqICAoU+G7rSBk4bulbmcgdHJvbmcgdMOsbmggaHXhu5FuZyB0eXBlICE9ICdjYWNoZScpDQogICAgICAgKi8KICAgICAgbWV0aG9kOiAnR0VUJwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAibG9hZEZuIiwgbnVsbCk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicGFnZVNpemUiLCAyMCk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicGFnZVRvdGFsIiwgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic3VtbWFyeURhdGEiLCBudWxsKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzdW1tYXJ5R3JvdXBEYXRhIiwgbnVsbCk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicGFnZUFwcGVuZCIsIGZhbHNlKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJ1c2VTcCIsIGZhbHNlKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjbGVhck9uUGFnZUxvYWQiLCB0cnVlKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjdXJyZW50UGFnZSIsIDEpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImNvbHVtbnMiLCAnJyk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAidmlld05hbWUiLCAnJyk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic3VtbWFyeUNvbHVtbnMiLCAnJyk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2FuY2VsU291cmNlIiwgbnVsbCk7CgogICAgdmFyIF9tZSA9IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpOwoKICAgIGlmIChvcHRpb25zKSB7CiAgICAgIHZhciBpdGVtcyA9IG51bGw7CgogICAgICBmb3IgKHZhciBwcm9wZXJ0eSBpbiBvcHRpb25zKSB7CiAgICAgICAgc3dpdGNoIChwcm9wZXJ0eSkgewogICAgICAgICAgY2FzZSAnZGF0YSc6CiAgICAgICAgICAgIGl0ZW1zID0gb3B0aW9ucy5kYXRhOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBfbWVbcHJvcGVydHldID0gb3B0aW9uc1twcm9wZXJ0eV07CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGl0ZW1zICYmIGl0ZW1zLmxlbmd0aCA+IDApIHsKICAgICAgICBpZiAoaXRlbXMgaW5zdGFuY2VvZiBBcnJheSkgewogICAgICAgICAgX21lLmxvYWRSZWNvcmRzKGl0ZW1zKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gX3RoaXM7CiAgfSAvLyNyZWdpb24gUHJvcGVydGllcwoKICAvKioNCiAgICogUHJpbWFyeUtleSBj4bunYSBFbnRpdHkgKE7hur91IGPDsyBj4bqldSBow6xuaCBNb2RlbCkNCiAgICovCgoKICBfY3JlYXRlQ2xhc3MoTVNTdG9yZSwgW3sKICAgIGtleTogImNoZWNrSGFzTGlzdGVuZXIiLAogICAgdmFsdWU6IC8vI2VuZHJlZ2lvbiBQcm9wZXJ0aWVzCiAgICAvLyNyZWdpb24gUHJpdmF0ZQoKICAgIC8qKg0KICAgICAqIEtp4buDbSB0cmEgeGVtIHN0b3JlIGPDsyDEkcaw4bujYyDEkcSDbmcga8O9IGzhuq9uZyBuZ2hlIGV2ZW50TmFtZSBoYXkga2jDtG5nDQogICAgICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZSB0w6puIGV2ZW50IGPhuqduIGNoZWNrDQogICAgICogQGF1dGhvciBETlRoYW5nIC0gMDUuMDcuMjAxOQ0KICAgICAqIEBwcml2YXRlDQogICAgICovCiAgICBmdW5jdGlvbiBjaGVja0hhc0xpc3RlbmVyKGV2ZW50TmFtZSkgewogICAgICB2YXIgbWUgPSB0aGlzOyAvLyByZXR1cm4gbWUuJGxpc3RlbmVycyAmJiBtZS4kbGlzdGVuZXJzW2V2ZW50TmFtZV07CgogICAgICByZXR1cm4gbWUuX2V2ZW50cyAmJiBtZS5fZXZlbnRzW2V2ZW50TmFtZV07CiAgICB9CiAgICAvKioNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gbGlzdA0KICAgICAqIEBwYXJhbSB7Kn0gc3RhcnQNCiAgICAgKiBAcHJpdmF0ZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJ0b0FycmF5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0b0FycmF5KGxpc3QsIHN0YXJ0KSB7CiAgICAgIHN0YXJ0ID0gc3RhcnQgfHwgMDsKICAgICAgdmFyIGkgPSBsaXN0Lmxlbmd0aCAtIHN0YXJ0OwogICAgICB2YXIgcmV0ID0gbmV3IEFycmF5KGkpOwoKICAgICAgd2hpbGUgKGktLSkgewogICAgICAgIHJldFtpXSA9IGxpc3RbaSArIHN0YXJ0XTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJldDsKICAgIH0KICAgIC8qKg0KICAgICAqIFJhaXNlIGV2ZW50IGNobyBjw6FjIGNvbnRyb2wgdGjhu7FjIGhp4buHbiB44butIGzDvSBiaW5kaW5nIGRhdGENCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnROYW1lIHTDqm4gZXZlbnQNCiAgICAgKiBAcGFyYW0ge0FycmF5fSBbYXJnc10gZGFuaCBzw6FjaCBjw6FjIHRoYW0gc+G7kSBj4bunYSBldmVudA0KICAgICAqIEBhdXRob3IgRE5UaGFuZyAtIDA1LjA3LjIwMTkNCiAgICAgKiBAcHJpdmF0ZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJub3RpZnkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5vdGlmeShldmVudE5hbWUpIHsKICAgICAgdmFyIG1lID0gdGhpczsKCiAgICAgIGlmIChldmVudE5hbWUpIHsKICAgICAgICB2YXIgZXZlbnRFbnVtID0gTVNFdmVudE5hbWUuTVNTdG9yZSwKICAgICAgICAgICAgZXZlbnREYXRhQ2hhbmdlZDsgLy9LaeG7g20gdHJhIHThu6sgZXZlbnQgaGnhu4duIHThuqFpIGPDsyBj4bqnbiByYWlzZSBldmVudCBkYXRhQ2hhbmdlZCBraMO0bmcKCiAgICAgICAgc3dpdGNoIChldmVudE5hbWUpIHsKICAgICAgICAgIGNhc2UgZXZlbnRFbnVtLmFkZDoKICAgICAgICAgIGNhc2UgZXZlbnRFbnVtLnJlbW92ZToKICAgICAgICAgIGNhc2UgZXZlbnRFbnVtLmNsZWFyOgogICAgICAgICAgICBldmVudERhdGFDaGFuZ2VkID0gZXZlbnRFbnVtLmRhdGFDaGFuZ2VkOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHZhciBhcmdzID0gbWUudG9BcnJheShhcmd1bWVudHMsIDEpOyAvL07hur91IHN0b3JlIGtow7RuZyDEkWMgbOG6r25nIG5naGUgZXZlbnROYW1lIHRow6wga2jDtG5nIGPhuqduIGVtaXQgbuG7r2EKCiAgICAgICAgaWYgKG1lLmNoZWNrSGFzTGlzdGVuZXIoZXZlbnROYW1lKSkgewogICAgICAgICAgdmFyIGFyZ3NUZW1wID0gYXJncy5jbG9uZSgpOwogICAgICAgICAgYXJnc1RlbXAuaW5zZXJ0QXQoMCwgZXZlbnROYW1lKTsKICAgICAgICAgIG1lLiRlbWl0LmFwcGx5KG1lLCBhcmdzVGVtcCk7IC8vIG1lLiRlbWl0KGV2ZW50TmFtZSwgYXJncyk7CiAgICAgICAgfQoKICAgICAgICBpZiAoZXZlbnREYXRhQ2hhbmdlZCAmJiBtZS5jaGVja0hhc0xpc3RlbmVyKGV2ZW50RGF0YUNoYW5nZWQpKSB7CiAgICAgICAgICBhcmdzLmluc2VydEF0KDAsIGV2ZW50RGF0YUNoYW5nZWQpOwogICAgICAgICAgbWUuJGVtaXQuYXBwbHkobWUsIGFyZ3MpOyAvLyBtZS4kZW1pdChldmVudERhdGFDaGFuZ2VkLCBhcmdzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIFRo4buxYyBoaeG7h24gY2xlYXIgdG/DoG4gYuG7mSBk4buvIGxp4buHdSB0csOqbiBzdG9yZQ0KICAgICAqIEBhdXRob3IgRE5UaGFuZyAtIDA0LjA3LjIwMTkNCiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IHNpbGVudDogQ8OzIHJhaXNlIGV2ZW50IGRhdGFDaGFuZ2Uga2jDtG5nDQogICAgICogQHByaXZhdGUNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiY2xlYXJEYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhckRhdGEoKSB7CiAgICAgIHZhciBzaWxlbnQgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwogICAgICB2YXIgbWUgPSB0aGlzLAogICAgICAgICAgZGF0YSA9IG1lLmRhdGEsCiAgICAgICAgICBkYXRhU291cmNlID0gbWUuZGF0YVNvdXJjZTsKCiAgICAgIGlmIChkYXRhICYmIGRhdGEuaXRlbXMgJiYgZGF0YS5pdGVtcy5sZW5ndGggPiAwKSB7CiAgICAgICAgZGF0YS5pdGVtcy5yZW1vdmVBbGwoKTsKICAgICAgfQoKICAgICAgaWYgKGRhdGFTb3VyY2UgJiYgZGF0YVNvdXJjZS5pdGVtcyAmJiBkYXRhU291cmNlLml0ZW1zLmxlbmd0aCA+IDApIHsKICAgICAgICBkYXRhU291cmNlLml0ZW1zLnJlbW92ZUFsbCgpOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiBSZXNldCB0cuG6oW5nIHRow6FpIGNvbWJvYm94IHbhu4EgbmjGsCBraGkgduG7q2Ega2jhu59pIHThuqFvIHhvbmcNCiAgICAgKiBDcmVhdGVkQnkgUERLSUVOIDcvMS8yMDIwDQogICAgICovCgogIH0sIHsKICAgIGtleTogInJlc2V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXNldCgpIHsKICAgICAgLy9DbGVhciBkYXRhCiAgICAgIHRoaXMuY2xlYXJEYXRhKCk7IC8vQ2xlYXIgdHLhuqFuZyB0aMOhaSBsb2FkZWQKCiAgICAgIHRoaXMuX2xvYWRlZCA9IGZhbHNlOyAvL1BES0lFTiBDbGVhciBmaWx0ZXIgduG7gSBmaWx0ZXIgdGhp4bq/dCBs4bqtcCBiYW4gxJHhuqd1IChjaMawYSBsw6BtIG5nYXkgxJHGsOG7o2MgdsOsIGPGoSBjaOG6vyBmaWx0ZXIgaGnhu4duIHThuqFpIGNoxrBhIHBow6JuIGJp4buHdCkKICAgIH0KICAgIC8qKg0KICAgICAqIFjDoWMgxJHhu4tuaCB4ZW0gc3RvcmUgxJHDoyB0aOG7sWMgaGnhu4duIHZp4buHYyBsb2FkIGThu68gbGnhu4d1IGNoxrBhDQogICAgICogRMO5bmcgxJHhu4MgdOG7kWkgxrB1IHRyw6FuaCBjYWxsIGzDqm4gYXBpIG5oaeG7gXUgbOG6p24NCiAgICAgKiBDw6FjIGNo4buXIGLDqm4gbmdvw6BpIHRyw6FuaCBraMO0bmcgbOG6pXkgdHLhu7FjIHRp4bq/cCBfbG9hZGVkLCDEkeG7gyBzYXUgY8OzIHJlbmFtZSB0aMOsIGPFqW5nIGtow7RuZyB24bqlbiDEkeG7gSBnw6wNCiAgICAgKiBAYXV0aG9yIEROVGhhbmcgLSAyMy4wNC4yMDIwDQogICAgICovCgogIH0sIHsKICAgIGtleTogImlzTG9hZGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0xvYWRlZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2xvYWRlZDsKICAgIH0KICAgIC8qKg0KICAgICAqIFNpbmggRmlsdGVyIEZ1bmN0aW9uIGNobyBhcnJheSBkYXRhIHBo4bulYyB24bulIGZpbHRlciB0csOqbiBjbGllbnQNCiAgICAgKiBAcmV0dXJucyBmdW5jdGlvbiBkw7luZyBjaG8gZmlsdGVyDQogICAgICogQGF1dGhvciBETlRoYW5nIC0gMTAuMDcuMjAxOQ0KICAgICAqIEBwcml2YXRlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImdlbkZpbHRlckZuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5GaWx0ZXJGbigpIHsKICAgICAgdmFyIG1lID0gdGhpczsgLy9O4bq/dSBjaMawYSB04buTbiB04bqhaSBGaWx0ZXIgRnVuY3Rpb24gdGjDrCBzaW5oCgogICAgICBpZiAobWUuZmlsdGVycy5sZW5ndGggPiAwICYmICFtZS5fZmlsdGVyRm4pIHsKICAgICAgICB2YXIgZmlsdGVyRm4gPSBGaWx0ZXIuZ2VuRmlsdGVyRnVuY3Rpb24obWUuZmlsdGVycyk7CiAgICAgICAgbWUuX2ZpbHRlckZuID0gZmlsdGVyRm47CiAgICAgIH0KCiAgICAgIHJldHVybiBtZS5fZmlsdGVyRm47CiAgICB9CiAgICAvKioNCiAgICAgKiBTaW5oIHNvcnQgZnVuY3Rpb24gY2hvIGFycmF5IGRhdGEgcGjhu6VjIHbhu6Ugc+G6r3AgeOG6v3AgdHLDqm4gY2xpZW50DQogICAgICogKENo4buJIHRo4buxYyBoaeG7h24ga2hpIHJlbW90ZVNvcnQgPT09IGBmYWxzZWApDQogICAgICogQHJldHVybnMgZnVuY3Rpb24gZMO5bmcgY2hvIHNvcnQNCiAgICAgKiBAYXV0aG9yIEROVGhhbmcgLSAwNi4wNy4yMDE5DQogICAgICogQHByaXZhdGUNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2VuU29ydEZuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5Tb3J0Rm4oKSB7CiAgICAgIHZhciBtZSA9IHRoaXM7IC8vTuG6v3UgY2jGsGEgY8OzIHNvcnRGbiB0aMOsIHRo4buxYyBoaeG7h24gc2luaAoKICAgICAgaWYgKCFtZS5fc29ydEZuKSB7CiAgICAgICAgLy9JbnB1dCBj4bunYSBow6BtIGzDoCBkYW5oIHPDoWNoIGPDoWMgc29ydGVyCiAgICAgICAgdmFyIHNvcnRfYnkgPSBmdW5jdGlvbiBzb3J0X2J5KCkgewogICAgICAgICAgdmFyIGZpZWxkcyA9IGFyZ3VtZW50c1swXSwKICAgICAgICAgICAgICAvL1tdLnNsaWNlLmNhbGwoYXJndW1lbnRzKSwKICAgICAgICAgIG5fZmllbGRzID0gZmllbGRzLmxlbmd0aDsKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoQSwgQikgewogICAgICAgICAgICB2YXIgYSwgYiwgZmllbGQsIHByb3BlcnR5LCBkZXNjLCByZXN1bHQsIGk7CgogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbl9maWVsZHM7IGkrKykgewogICAgICAgICAgICAgIHJlc3VsdCA9IDA7CiAgICAgICAgICAgICAgZmllbGQgPSBmaWVsZHNbaV07CiAgICAgICAgICAgICAgcHJvcGVydHkgPSB0eXBlb2YgZmllbGQgPT09ICdzdHJpbmcnID8gZmllbGQgOiBmaWVsZC5wcm9wZXJ0eTsKICAgICAgICAgICAgICBhID0gQVtwcm9wZXJ0eV07CiAgICAgICAgICAgICAgYiA9IEJbcHJvcGVydHldOwogICAgICAgICAgICAgIGRlc2MgPSBmaWVsZC5kZXNjID8gLTEgOiAxOwogICAgICAgICAgICAgIGlmIChhIDwgYikgcmVzdWx0ID0gZGVzYyAqIC0xOwogICAgICAgICAgICAgIGlmIChhID4gYikgcmVzdWx0ID0gZGVzYyAqIDE7CiAgICAgICAgICAgICAgaWYgKHJlc3VsdCAhPT0gMCkgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgICB9OwogICAgICAgIH07CgogICAgICAgIG1lLl9zb3J0Rm4gPSBzb3J0X2J5OwogICAgICB9CgogICAgICByZXR1cm4gbWUuX3NvcnRGbjsKICAgIH0KICAgIC8qKg0KICAgICAqIFRo4buxYyBoaeG7h24gY29udmVydCBk4buvIGxp4buHdSBzYW5nIE1TRW50aXR5IMSR4buDIHjhu60gbMO9IHRy4bqhbmcgdGjDoWkNCiAgICAgKiBAcGFyYW0ge09iamVjdC9BcnJheX0gcmVjb3Jkcw0KICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNUZW1wIEPDsyBwaOG6o2kgbMOgIHRlbXAgbW9kZWwga2jDtG5nDQogICAgICovCgogIH0sIHsKICAgIGtleTogImNvbnZlcnRPYmplY3RUb01vZGVsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb252ZXJ0T2JqZWN0VG9Nb2RlbChyZWNvcmRzLCBpc1RlbXAsIGlzUGhhbnRvbSkgewogICAgICB2YXIgbWUgPSB0aGlzLAogICAgICAgICAgbW9kZWwgPSBtZS5tb2RlbCwKICAgICAgICAgIHJlc3VsdDsgLy9O4bq/dSBraMO0bmcgY8OzIE1vZGVsIHRow6wgcmV0dXJuIHJlY29yZCBPYmplY3QgaGnhu4duIHThuqFpIGx1w7RuIChxdeG6o24gbMO9IHRy4buxYyB0aeG6v3AgdHLDqm4gT2JqZWN0IGx1w7RuKQoKICAgICAgaWYgKCFtb2RlbCkgewogICAgICAgIHJldHVybiByZWNvcmRzOwogICAgICB9CgogICAgICByZXN1bHQgPSBtb2RlbFV0aWwuY3JlYXRlTW9kZWwocmVjb3JkcywgbW9kZWwsIGlzVGVtcCwgaXNQaGFudG9tKTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKg0KICAgICAqIFRo4buxYyBoaeG7h24gc+G6r3AgeOG6v3AgY2hvIGThu68gbGnhu4d1IHRyw6puIHN0b3JlDQogICAgICogY2jhu4kgdGjhu7FjIGhp4buHbiBraGkgcmVtb3RlU29ydCA9IGBmYWxzZWANCiAgICAgKiBAcHVibGljDQogICAgICovCgogIH0sIHsKICAgIGtleTogImxvY2FsU29ydCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9jYWxTb3J0KCkgewogICAgICB2YXIgbWUgPSB0aGlzOwoKICAgICAgaWYgKG1lLnJlbW90ZVNvcnQgPT09IGZhbHNlICYmIG1lLmRhdGEuaXRlbXMubGVuZ3RoID4gMCAmJiBtZS5zb3J0ZXJzICYmIG1lLnNvcnRlcnMubGVuZ3RoID4gMCkgewogICAgICAgIG1lLmdlblNvcnRGbigpOwoKICAgICAgICBpZiAobWUuX3NvcnRGbikgewogICAgICAgICAgbWUuZGF0YS5pdGVtcy5zb3J0KG1lLl9zb3J0Rm4obWUuc29ydGVycykpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqDQogICAgICogVGjhu7FjIGhp4buHbiBmaWx0ZXIgZOG7ryBsaeG7h3UgcGjDrWEgbG9jYWwgdHLDqm4gc3RvcmUNCiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGZvcmNlIGPDsyBmb3JjZSBmaWx0ZXIga2jDtG5nDQogICAgICogQHB1YmxpYw0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJsb2NhbEZpbHRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9jYWxGaWx0ZXIoZm9yY2UpIHsKICAgICAgdmFyIG1lID0gdGhpczsKCiAgICAgIGlmIChtZS5yZW1vdGVGaWx0ZXIgPT09IGZhbHNlICYmIG1lLmRhdGFTb3VyY2UuaXRlbXMubGVuZ3RoID4gMCkgewogICAgICAgIGlmIChmb3JjZSB8fCBtZS5fZmlsdGVyQ2hhbmdlKSB7CiAgICAgICAgICAvL0ROVGhhbmcgLSAwOS4xMC4yMDE5OiBO4bq/dSBGb3JjZSB0aMOsIHRo4buxYyBoaeG7h24gc2luaCBs4bqhaSBmaWx0ZXJGbgogICAgICAgICAgaWYgKGZvcmNlKSB7CiAgICAgICAgICAgIG1lLl9maWx0ZXJGbiA9IG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGZpbHRlckZuID0gbWUuZ2VuRmlsdGVyRm4oKTsKICAgICAgICAgIHZhciBmaWx0ZXJlZDsKCiAgICAgICAgICBpZiAoZmlsdGVyRm4pIHsKICAgICAgICAgICAgZmlsdGVyZWQgPSBtZS5kYXRhU291cmNlLml0ZW1zLmZpbHRlcihmaWx0ZXJGbik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmaWx0ZXJlZCA9IG1lLmRhdGFTb3VyY2UuaXRlbXM7CiAgICAgICAgICB9CgogICAgICAgICAgbWUuZGF0YS5pdGVtcy5yZW1vdmVBbGwoKTsKICAgICAgICAgIG1lLmRhdGEuaXRlbXMuYXBwZW5kKGZpbHRlcmVkKTsKICAgICAgICAgIG1lLmxvY2FsU29ydCgpOwogICAgICAgICAgZGVsZXRlIG1lLl9maWx0ZXJDaGFuZ2U7CiAgICAgICAgfQogICAgICB9CiAgICB9IC8vI2VuZHJlZ2lvbiBQcml2YXRlCiAgICAvLyNyZWdpb24gTWV0aG9kCgogICAgLyoqDQogICAgICogVGjhu7FjIGhp4buHbiB0aMOqbSBt4bubaSByZWNvcmQgdsOgbyBk4buvIGxp4buHdSBj4bunYSBzdG9yZQ0KICAgICAqIEBwYXJhbSB7aW50fSBpbmRleCB24buLIHRyw60gY+G6p24gdGjDqm0NCiAgICAgKiBAcGFyYW0ge0FycmF5L09iamVjdH0gcmVjb3JkcyBi4bqjbiBnaGkgaG/hurdjIGFycmF5IGLhuqNuIGdoaSBj4bqnbiB0aMOqbQ0KICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNUZW1wIEPDsyBwaOG6o2kgbMOgIHRlbXAgbW9kZWwga2jDtG5nDQogICAgICogQGF1dGhvciBETlRoYW5nIC0gMDQuMDcuMjAxOQ0KICAgICAqIEBwdWJsaWMNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaW5zZXJ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnNlcnQoaW5kZXgsIHJlY29yZHMsIGlzVGVtcCkgewogICAgICAvLwogICAgICB2YXIgbWUgPSB0aGlzLAogICAgICAgICAgbGVuLAogICAgICAgICAgaSwKICAgICAgICAgIHJlc3VsdDsKICAgICAgcmVzdWx0ID0gbWUuY29udmVydE9iamVjdFRvTW9kZWwocmVjb3JkcywgaXNUZW1wKTsgLy8gaWYgKG1lLmRhdGEuaXRlbXMpIHsKCiAgICAgIG1lLmRhdGFTb3VyY2UuaXRlbXMuaW5zZXJ0QXJyYXkoaW5kZXgsIHJlc3VsdCk7CiAgICAgIG1lLmRhdGEuaXRlbXMuaW5zZXJ0QXJyYXkoaW5kZXgsIHJlc3VsdCk7CiAgICAgIG1lLmxvY2FsRmlsdGVyKHRydWUpOwogICAgICBtZS5sb2NhbFNvcnQoKTsgLy9SYWlzZSBldmVudCBjaG8gY29udHJvbAoKICAgICAgbWUubm90aWZ5KE1TRXZlbnROYW1lLk1TU3RvcmUuYWRkLCBtZSwgcmVjb3JkcywgaW5kZXgpOwoKICAgICAgaWYgKG1lLnBhZ2VUb3RhbCkgewogICAgICAgIHZhciBsZW5ndGggPSAxOwoKICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgQXJyYXkpIHsKICAgICAgICAgIGxlbmd0aCA9IHJlc3VsdC5sZW5ndGg7CiAgICAgICAgfQoKICAgICAgICBtZS5wYWdlVG90YWwgKz0gbGVuZ3RoOwogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OyAvLyB9CiAgICB9CiAgICAvKioNCiAgICAgKiBM4bqleSByYSBtb2RlbCB0aGVvIEluZGV4DQogICAgICogQHBhcmFtIHtJbnR9IGlkeCBpbmRleCBj4bunYSBtb2RlbCBj4bqnbiBs4bqleQ0KICAgICAqIEBwdWJsaWMNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0QXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEF0KGluZGV4KSB7CiAgICAgIHJldHVybiB0aGlzLmdldERhdGEoKVtpbmRleF0gfHwgbnVsbDsKICAgIH0KICAgIC8qKg0KICAgICAqIEzhuqV5IHJhIGLhuqNuIGdoaSB0aGVvIGZpZWxkIHbDoCB2YWx1ZQ0KICAgICAqIEByZXR1cm4ge0ludH0NCiAgICAgKiBAcHVibGljDQogICAgICovCgogIH0sIHsKICAgIGtleTogImZpbmRSZWNvcmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRSZWNvcmQoZmllbGQsIHZhbHVlLCBzdGFydElkeCwgY2FzZVNlbnNpdGl2ZSkgewogICAgICB2YXIgbWUgPSB0aGlzLAogICAgICAgICAgZm4gPSBmdW5jdGlvbiBmbihpdGVtKSB7CiAgICAgICAgdmFyIHJlc3VsdCwKICAgICAgICAgICAgZmllbGRWYWx1ZSA9IGl0ZW1bZmllbGRdOwoKICAgICAgICBpZiAodHlwZW9mIGZpZWxkVmFsdWUgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICByZXN1bHQgPSBjYXNlU2Vuc2l0aXZlID8gZmllbGRWYWx1ZSA9PT0gdmFsdWUgOiBmaWVsZFZhbHVlID09PSB2YWx1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0ID0gZmllbGRWYWx1ZSA9PT0gdmFsdWU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICB9OwoKICAgICAgdmFyIHJlY29yZCA9IG1lLmZpbmRCeShmbiwgc3RhcnRJZHgpOwogICAgICByZXR1cm4gcmVjb3JkOwogICAgfQogICAgLyoqDQogICAgICogVGjhu7FjIGhp4buHbiB0w6xtIGtp4bq/bSB0aGVvIFByaW1hcnlLZXkNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30ga2V5IHByaW1hcnkga2V5IGPhu6dhIGLhuqNuIGdoaQ0KICAgICAqIEBwYXJhbSB7Kn0gY2FzZVNlbnNpdGl2ZSBDw7MgcGjDom4gYmnhu4d0IGhvYSB0aMaw4budbmcga28/DQogICAgICovCgogIH0sIHsKICAgIGtleTogImZpbmRCeUtleSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmluZEJ5S2V5KGtleSwgY2FzZVNlbnNpdGl2ZSkgewogICAgICB2YXIgbWUgPSB0aGlzLAogICAgICAgICAgaWRQcm9wZXJ0eSA9IG1lLmdldElkUHJvcGVydHkoKTsKCiAgICAgIGlmIChpZFByb3BlcnR5ICYmIG1lLm1vZGVsKSB7CiAgICAgICAgcmV0dXJuIG1lLmZpbmRSZWNvcmQoaWRQcm9wZXJ0eSwga2V5LCAwLCBjYXNlU2Vuc2l0aXZlKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICAvKioNCiAgICAgKiBM4bqleSByYSBpdGVtIMSR4bqndSB0acOqbiB0aGVvIGZ1bmN0aW9uIHRydXnhu4FuIHbDoG8NCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBIw6BtIGZpbHRlciBpdGVtIChjw7MgdGhhbSBz4buRIGzDoCBpdGVtIGPhu6dhIHN0b3JlKQ0KICAgICAqIEBwYXJhbSB7SW50fSBzdGFydElkeCB24buLIHRyw60gYuG6r3QgxJHhuqd1DQogICAgICogQHJldHVybiB7TW9kZWx9DQogICAgICogQHB1YmxpYw0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJmaW5kQnkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRCeShmbiwgc3RhcnRJZHgpIHsKICAgICAgdmFyIG1lID0gdGhpcywKICAgICAgICAgIGl0ZW1zID0gbWUuZ2V0RGF0YSgpLAogICAgICAgICAgbGVuZ3RoID0gaXRlbXMubGVuZ3RoLAogICAgICAgICAgaTsKCiAgICAgIGZvciAoaSA9IHN0YXJ0SWR4IHx8IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIHZhciBpdGVtID0gaXRlbXNbaV07CgogICAgICAgIGlmIChmbi5jYWxsKG1lLCBpdGVtKSkgewogICAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm47CiAgICB9CiAgICAvKioNCiAgICAgKiBUcuG6oyByYSB04buVbmcgc+G7kSByZWNvcmQgxJFhbmcgY8OzIHRyw6puIHN0b3JlDQogICAgICogKG7hur91IGPDsyBydWxlIGfDrCDEkcOzIGxpw6puIHF1YW4gxJHhur9uIEdyb3VwIHRow6wgc2F1IHPhur0geOG7rSBsw70gdOG6oWkgxJHDonkpDQogICAgICogQGF1dGhvciBETlRoYW5nIC0gMDUuMDcuMjAxOQ0KICAgICAqIEBwdWJsaWMNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0Q291bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvdW50KCkgewogICAgICB2YXIgbWUgPSB0aGlzOwogICAgICB2YXIgY291bnQgPSAwOwoKICAgICAgaWYgKG1lLmRhdGEgJiYgbWUuZGF0YS5pdGVtcykgewogICAgICAgIGNvdW50ID0gbWUuZGF0YS5pdGVtcy5sZW5ndGg7CiAgICAgIH0KCiAgICAgIHJldHVybiBjb3VudDsKICAgIH0KICAgIC8qKg0KICAgICAqIFRo4buxYyBoaeG7h24geMOzYSAxIGhv4bq3YyBuaGnhu4F1IGLhuqNuIGdoaSB0csOqbiBzdG9yZQ0KICAgICAqIEBwYXJhbSB7TW9kZWwvQXJyYXl9IEByZWNvcmRzIERhbmggc2FjaHMgY8OhYyBi4bqjbiBnaGkgY+G6p24geMOzYQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyZW1vdmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZShyZWNvcmRzLCBzaWxlbnQpIHsKICAgICAgdmFyIG1lID0gdGhpcywKICAgICAgICAgIHJlc3VsdCA9IFtdLAogICAgICAgICAgZGF0YSA9IG1lLmRhdGEsCiAgICAgICAgICBsc3RSZW1vdmU7CgogICAgICBpZiAocmVjb3JkcykgewogICAgICAgIGlmIChyZWNvcmRzIGluc3RhbmNlb2YgQXJyYXkpIHsKICAgICAgICAgIGxzdFJlbW92ZSA9IHJlY29yZHM7CiAgICAgICAgfSBlbHNlIGlmIChyZWNvcmRzIGluc3RhbmNlb2YgT2JqZWN0KSB7CiAgICAgICAgICBsc3RSZW1vdmUgPSBbcmVjb3Jkc107CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcignREVWOiBTdG9yZSBjaMawYSBo4buXIHRy4bujIHjDs2EgY2hvIHRyxrDhu51uZyBo4bujcCBuw6B5LicpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGkgPSAwOwoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbHN0UmVtb3ZlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB2YXIgcmVjb3JkID0gbHN0UmVtb3ZlW2ldOwoKICAgICAgICAgIGlmIChyZWNvcmQuaXNNb2RlbCkgewogICAgICAgICAgICAvL07hur91IGl0ZW0gbsOgeSBu4bqxbSB0cm9uZyB04bqtcCBkYXRhIHRow6wgeOG7rSBsw70KICAgICAgICAgICAgaWYgKGRhdGEuY29udGFpbnMocmVjb3JkKSA+IC0xKSB7CiAgICAgICAgICAgICAgLy9O4bq/dSBraMO0bmcgcGjhuqNpIGzDoCBi4bqjbiBnaGkgdGjDqm0gbeG7m2kgdOG7qyBDbGllbnQgdGjDrCB0aOG7sWMgaGnhu4duIEFkZCB2w6BvIGRhbmggc8OhY2ggY8OhYyBi4bqjbiBnaGkgxJFjIHjDs2EgxJHhu4Mgc2F1IGPDsm4geOG7rSBsw70gdHLhuqFuZyB0aMOhaSBi4bqjbiBnaGkgeMOzYQogICAgICAgICAgICAgIGlmICghcmVjb3JkLl9waGFudG9tKSB7CiAgICAgICAgICAgICAgICBtZS5fcmVtb3ZlZC5hZGQocmVjb3JkKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICByZXN1bHQuYWRkKHJlY29yZCk7CiAgICAgICAgfSAvL1jDs2EgdHLDqm4gZGF0YSB2w6AgZGF0YVNvdXJjZQoKCiAgICAgICAgbWUuZGF0YVNvdXJjZS5pdGVtcy5yZW1vdmUocmVzdWx0KTsKICAgICAgICBtZS5kYXRhLml0ZW1zLnJlbW92ZShyZXN1bHQpOwoKICAgICAgICBpZiAobWUucGFnZVRvdGFsKSB7CiAgICAgICAgICB2YXIgbGVuZ3RoID0gMTsKCiAgICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgQXJyYXkpIHsKICAgICAgICAgICAgbGVuZ3RoID0gcmVzdWx0Lmxlbmd0aDsKICAgICAgICAgIH0KCiAgICAgICAgICBtZS5wYWdlVG90YWwgLT0gbGVuZ3RoOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCFzaWxlbnQpIHsKICAgICAgICAvL1JhaXNlIGV2ZW50IHJlbW92ZSArIGRhdGFDaGFuZ2VkIGNobyBjb250cm9sCiAgICAgICAgbWUubm90aWZ5KE1TRXZlbnROYW1lLk1TU3RvcmUucmVtb3ZlLCBtZSwgcmVzdWx0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKg0KICAgICAqIFRo4buxYyBoaeG7h24geMOzYSB0b8OgbiBi4buZIGPDoWMgcmVjb3JkIHRyw6puIHN0b3JlDQogICAgICogQHBhcmFtIHtCb29sZWFuID0gZmFsc2V9IHNpbGVudCBgdHJ1ZWAga2jDtG5nIHJhaXNlIGV2ZW50LCBgZmFsc2VgIGPDsyByYWlzZSBldmVudA0KICAgICAqIEBwdWJsaWMNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicmVtb3ZlQWxsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVBbGwoc2lsZW50KSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgIHZhciByZWNvcmRzID0gbWUuZGF0YS5pdGVtczsKICAgICAgcmV0dXJuIG1lLnJlbW92ZShyZWNvcmRzLCBzaWxlbnQpOwogICAgfQogICAgLyoqDQogICAgICogWMOzYSBtb2RlbCB04bqhaSB24buLIHRyw60gaW5kZXgNCiAgICAgKiBAcGFyYW0ge0ludH0gaW5kZXg6IHbhu4sgdHLDrSBj4bunYSBtb2RlbCBj4bqnbiB4w7NhDQogICAgICogQGRlc2NyaXB0aW9uIE7hur91IGluZGV4IDwgMCB0aMOsIHPhur0gbeG6t2MgxJHhu4tuaCB4w7NhIHThuqFpIHbhu4sgdHLDrSDEkeG6p3UgdGnDqm4NCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicmVtb3ZlQXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUF0KGluZGV4KSB7CiAgICAgIHZhciBtZSA9IHRoaXMsCiAgICAgICAgICByZWNvcmQgPSBtZS5kYXRhLml0ZW1zW2luZGV4XTsKICAgICAgaW5kZXggPSBNYXRoLm1heChpbmRleCwgMCk7CgogICAgICBpZiAocmVjb3JkKSB7CiAgICAgICAgbWUucmVtb3ZlKHJlY29yZCk7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIFjDs2EgZmlsdGVyIHRoZW8ga2V5IChwcm9wZXJ0eSkNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZmlsdGVyS2V5IGtleS9wcm9wZXJ0eSBj4bunYSBmaWx0ZXINCiAgICAgKiBAcGFyYW0ge0FycmF5fSBmaWx0ZXJzIDogZGFuaCBzw6FjaCBjw6FjIGZpbHRlcg0KICAgICAqIEBwcml2YXRlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInJlbW92ZUZpbHRlckJ5S2V5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVGaWx0ZXJCeUtleShmaWx0ZXJLZXksIGZpbHRlcnMpIHsKICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgdmFyIGZpbHRlciA9IGZpbHRlcnMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0ucHJvcGVydHkgPT09IGZpbHRlcktleSB8fCBpdGVtLmlkICYmIGl0ZW0uaWQgPT09IGZpbHRlcktleTsKICAgICAgfSk7CiAgICAgIGZpbHRlcnMucmVtb3ZlKGZpbHRlcik7IC8vQuG7jyBfZmlsdGVyRm4gxJHhu4MgZ2VuIGzhuqFpCgogICAgICBtZS5fZmlsdGVyRm4gPSBudWxsOwogICAgfQogICAgLyoqDQogICAgICogTOG6pXkgcmEgZmlsdGVyIHRoZW8gaWQgaG/hurdjIGtleQ0KICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgaWQgaG/hurdjIHByb3BlcnR5IGPhu6dhIGZpbHRlciBj4bqnbiBs4bqleQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRGaWx0ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEZpbHRlcihrZXkpIHsKICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgdmFyIGZpbHRlcnMgPSBtZS5maWx0ZXJzLAogICAgICAgICAgZmlsdGVyID0gZmlsdGVycy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5pZCAmJiBpdGVtLmlkID09PSBrZXkgfHwgaXRlbS5wcm9wZXJ0eSA9PT0ga2V5OwogICAgICB9KTsKICAgICAgcmV0dXJuIGZpbHRlcjsKICAgIH0KICAgIC8qKg0KICAgICAqIFjDs2EgRmlsdGVyIGto4buPaSBkYW5oIHPDoWNoIGZpbHRlciBoaeG7h24gdOG6oWkgY+G7p2Egc3RvcmUNCiAgICAgKiBAcGFyYW0ge09iamVjdC9LZXl9IGZpbHRlcjogxJHhu5FpIHTGsOG7o25nIEZpbHRlciBob+G6t2MgS2V5IChwcm9wZXJ0eSkgY+G7p2EgZmlsdGVyDQogICAgICogQHBhcmFtIHtCb29sZWFufSBzaWxlbnQgOiBjw7MgcmFpc2UgZXZlbnQga2hpIHJlbW92ZSBraMO0bmcNCiAgICAgKiBAcHVibGljDQogICAgICogTW9kaWZpZWRCeSBETlRoYW5nIC0gMTMuMTEuMjAxOTogU+G7rWEgcGFyYW0gc2lsZW50IHbhu4EgbeG6t2MgxJHhu4tuaCBsw6AgPSBmYWxzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyZW1vdmVGaWx0ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUZpbHRlcihmaWx0ZXIsIHNpbGVudCkgewogICAgICB2YXIgbWUgPSB0aGlzLAogICAgICAgICAgZmlsdGVycyA9IG1lLmZpbHRlcnM7CgogICAgICBpZiAoZmlsdGVycy5sZW5ndGggPiAwICYmIGZpbHRlcikgewogICAgICAgIC8vTuG6v3UgeMOzYSB0aGVvIGtleQogICAgICAgIGlmICh0eXBlb2YgZmlsdGVyID09PSAnc3RyaW5nJykgewogICAgICAgICAgbWUucmVtb3ZlRmlsdGVyQnlLZXkoZmlsdGVyLCBmaWx0ZXJzKTsKICAgICAgICB9IGVsc2UgaWYgKGZpbHRlciBpbnN0YW5jZW9mIEFycmF5KSB7CiAgICAgICAgICBmaWx0ZXJzLnJlbW92ZShmaWx0ZXIpOwogICAgICAgIH0gZWxzZSBpZiAoZmlsdGVyIGluc3RhbmNlb2YgT2JqZWN0KSB7CiAgICAgICAgICBmaWx0ZXJzLnJlbW92ZShmaWx0ZXIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSAvL0Lhu48gX2ZpbHRlckZuIMSR4buDIGdlbiBs4bqhaQoKCiAgICAgICAgbWUuX2ZpbHRlckZuID0gbnVsbDsKICAgICAgICBtZS5fZmlsdGVyQ2hhbmdlID0gdHJ1ZTsKICAgICAgICBtZS5sb2NhbEZpbHRlcigpOyAvL1JhaXNlIGV2ZW50IGZpbHRlckNoYW5nZWQKCiAgICAgICAgaWYgKCFzaWxlbnQpIHsKICAgICAgICAgIG1lLm5vdGlmeShNU0V2ZW50TmFtZS5NU1N0b3JlLmZpbHRlckNoYW5nZWQsIG1lLCBmaWx0ZXJzKTsKICAgICAgICB9IC8vIGRlbGV0ZSBtZS5fZmlsdGVyQ2hhbmdlOwoKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICogWMOzYSB0b8OgbiBi4buZIGZpbHRlciBj4bunYSBzdG9yZQ0KICAgICAqIEBwdWJsaWMNCiAgICAgKiBNb2RpZmllZEJ5IEROVGhhbmcgLSAxMy4xMS4yMDE5OiBT4butYSBwYXJhbSBzaWxlbnQgduG7gSBt4bq3YyDEkeG7i25oIGzDoCA9IGZhbHNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImNsZWFyRmlsdGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhckZpbHRlcihzaWxlbnQpIHsKICAgICAgdmFyIG1lID0gdGhpcywKICAgICAgICAgIGZpbHRlcnMgPSBtZS5maWx0ZXJzOwoKICAgICAgaWYgKGZpbHRlcnMubGVuZ3RoID4gMCkgewogICAgICAgIGZpbHRlcnMubGVuZ3RoID0gMDsgLy9C4buPIF9maWx0ZXJGbiDEkeG7gyBnZW4gbOG6oWkKCiAgICAgICAgbWUuX2ZpbHRlckZuID0gbnVsbDsKICAgICAgICBtZS5fZmlsdGVyQ2hhbmdlID0gdHJ1ZTsKICAgICAgICBtZS5sb2NhbEZpbHRlcigpOyAvL1JhaXNlIGV2ZW50IGZpbHRlckNoYW5nZWQKCiAgICAgICAgaWYgKCFzaWxlbnQpIHsKICAgICAgICAgIG1lLm5vdGlmeShNU0V2ZW50TmFtZS5NU1N0b3JlLmZpbHRlckNoYW5nZWQsIG1lLCBmaWx0ZXJzKTsKICAgICAgICB9IC8vIGRlbGV0ZSBtZS5fZmlsdGVyQ2hhbmdlOwoKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICogS2nhu4NtIHRyYSB4ZW0gZmlsdGVyIMSRw6MgdOG7k24gdOG6oWkgY2jGsGENCiAgICAgKiBAcGFyYW0ge09iamVjdC9LZXl9IGZpbHRlcg0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJoYXNGaWx0ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhc0ZpbHRlcihmaWx0ZXIpIHsKICAgICAgdmFyIG1lID0gdGhpczsKCiAgICAgIGlmIChtZS5maWx0ZXJzICYmIG1lLmZpbHRlcnMubGVuZ3RoID4gMCkgewogICAgICAgIGlmICh0eXBlb2YgZmlsdGVyID09PSAnc3RyaW5nJykgewogICAgICAgICAgdmFyIGkgPSAwOwoKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBtZS5maWx0ZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBmaWx0ZXJUZW1wID0gbWUuZmlsdGVyc1tpXTsKCiAgICAgICAgICAgIGlmIChmaWx0ZXJUZW1wLnByb3BlcnR5ID09PSBmaWx0ZXIgfHwgZmlsdGVyVGVtcC5pZCAmJiBmaWx0ZXJUZW1wLmlkID09PSBmaWx0ZXIpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKG1lLmZpbHRlcnMuaW5kZXhPZihmaWx0ZXIpID4gLTEpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiBUaMOqbSBmaWx0ZXIgdsOgbyBkYW5oIHPDoWNoIGZpbHRlciBoaeG7h24gdOG6oWkgY+G7p2Egc3RvcmUNCiAgICAgKiBAcGFyYW0ge0FycmF5L09iamVjdH0gZmlsdGVycw0KICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gc2lsZW50DQogICAgICogQHB1YmxpYw0KICAgICAqIE1vZGlmaWVkQnkgRE5UaGFuZyAtIDEzLjExLjIwMTk6IFPhu61hIHBhcmFtIHNpbGVudCB24buBIG3hurdjIMSR4buLbmggbMOgID0gZmFsc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiYWRkRmlsdGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRGaWx0ZXIoZmlsdGVycywgc2lsZW50KSB7CiAgICAgIHZhciBtZSA9IHRoaXM7IC8vxJDhuql5IHbDoG8gYXJyYXkgZmlsdGVycyBj4bunYSBzdG9yZQoKICAgICAgaWYgKGZpbHRlcnMgaW5zdGFuY2VvZiBBcnJheSkgewogICAgICAgIG1lLmZpbHRlcnMuYXBwZW5kKGZpbHRlcnMpOwogICAgICB9IGVsc2UgaWYgKGZpbHRlcnMgaW5zdGFuY2VvZiBPYmplY3QpIHsKICAgICAgICBtZS5maWx0ZXJzLnB1c2goZmlsdGVycyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vQuG7jyBfZmlsdGVyRm4gxJHhu4MgZ2VuIGzhuqFpCgoKICAgICAgbWUuX2ZpbHRlckZuID0gbnVsbDsKICAgICAgbWUuX2ZpbHRlckNoYW5nZSA9IHRydWU7IC8vVGjhu7FjIGhp4buHbiBmaWx0ZXIgbOG6oWkgZOG7ryBsaeG7h3UKCiAgICAgIG1lLmxvY2FsRmlsdGVyKCk7IC8vUmFpc2UgZXZlbnQgZmlsdGVyQ2hhbmdlZAoKICAgICAgaWYgKCFzaWxlbnQpIHsKICAgICAgICBtZS5ub3RpZnkoTVNFdmVudE5hbWUuTVNTdG9yZS5maWx0ZXJDaGFuZ2VkLCBtZSwgZmlsdGVycyk7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIFRo4buxYyBoaeG7h24gbG9hZCBkYW5oIHPDoWNoIGThu68gbGnhu4d1IHbDoG8gc3RvcmUNCiAgICAgKiBAcGFyYW0ge01TRW50aXR5W10vT2JqZWN0W119IGRhdGEgQXJyYXkgZOG7ryBsaeG7h3UgY+G6p24gbG9hZCB2w6BvIHN0b3JlDQogICAgICogQHBhcmFtIHtCb29sZWFuPWZhbHNlfSBhcHBlbmQgYHRydWVgIHRo4buxYyBoaeG7h24gYWRkIHJlY29yZHMgdsOgbyBkYW5oIHPDoWNoIGPDoWMgcmVjb3JkcyDEkcOjIHThu5NuIHThuqFpLCBgZmFsc2VgIHRo4buxYyBoaeG7h24gcmVtb3ZlIGPDoWMgcmVjb3JkcyDEkcOjIHThu5NuIHThuqFpIHRyxrDhu5tjLg0KICAgICAqIEBwYXJhbSB7Qm9vbGVhbj1mYWxzZX0gaXNUZW1wIEPhu50gxJHDoW5oIGThuqV1IGzDoCBkw7JuZyBUZW1wIGhheSBraMO0bmcNCiAgICAgKiBAcHVibGljDQogICAgICovCgogIH0sIHsKICAgIGtleTogImxvYWREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkRGF0YShkYXRhLCBhcHBlbmQsIGlzVGVtcCwgaXNQaGFudG9tKSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CgogICAgICBpZiAoZGF0YSkgewogICAgICAgIG1lLnJhd0RhdGEgPSBkYXRhOwogICAgICAgIHZhciBuZXdEYXRhID0gbWUuY29udmVydE9iamVjdFRvTW9kZWwoZGF0YSwgaXNUZW1wLCBpc1BoYW50b20pOwogICAgICAgIG5ld0RhdGEgPSBtZS5wcmVwYXJlRGF0YUJlZm9yZUxvYWQobmV3RGF0YSk7CiAgICAgICAgbWUubG9hZFJlY29yZHMobmV3RGF0YSwgYXBwZW5kKTsgLy9SYWlzZSBldmVudCBsb2FkZWQKCiAgICAgICAgbWUubm90aWZ5KE1TRXZlbnROYW1lLk1TU3RvcmUubG9hZGVkLCBtZSwgbmV3RGF0YSk7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIFjhu60gbMO9IGThu68gbGnhu4d1IHRyxrDhu5tjIGtoaSB0aOG7sWMgaGnhu4duIGxvYWQNCiAgICAgKiBDaG8gcGjDqXAgZGVyaXZlIGPDsyB0aOG7gyBvdmVycmlkZQ0KICAgICAqIEBvdmVycmlkZUFibGUNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicHJlcGFyZURhdGFCZWZvcmVMb2FkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwcmVwYXJlRGF0YUJlZm9yZUxvYWQoZGF0YSkgewogICAgICByZXR1cm4gZGF0YTsKICAgIH0KICAgIC8qKg0KICAgICAqIExvYWQgbeG7mXQgYXJyYXkgY8OhYyByZWNvcmQgdsOgbyBTdG9yZQ0KICAgICAqIEBwYXJhbSB7YXJyYXl9IHJlY29yZHM6IGRhbmggc8OhY2ggY8OhYyBi4bqjbiBnaGkgbG9hZCBsw6puDQogICAgICogQHBhcmFtIHtCb29sZWFuPWZhbHNlfSBhcHBlbmQgYHRydWVgIHRo4buxYyBoaeG7h24gYWRkIHJlY29yZHMgdsOgbyBkYW5oIHPDoWNoIGPDoWMgcmVjb3JkcyDEkcOjIHThu5NuIHThuqFpLCBgZmFsc2VgIHRo4buxYyBoaeG7h24gcmVtb3ZlIGPDoWMgcmVjb3JkcyDEkcOjIHThu5NuIHThuqFpIHRyxrDhu5tjLg0KICAgICAqIE7hur91IHNhdSBuw6B5IHjhu60gbMO9IGxvYWRPbkRlbWFuZCB0aMOsIHPhur0gc+G7rSBk4bulbmcgY+G7nSBhcHBlbmQgbsOgeQ0KICAgICAqIEBwdWJsaWMNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAibG9hZFJlY29yZHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRSZWNvcmRzKHJlY29yZHMsIGFwcGVuZCkgewogICAgICB2YXIgbWUgPSB0aGlzOwogICAgICBtZS5sYXN0U291cmNlRGF0YSA9IHJlY29yZHM7CgogICAgICBpZiAoIWFwcGVuZCkgewogICAgICAgIG1lLmNsZWFyRGF0YSh0cnVlKTsKICAgICAgfSAvL0NodeG6qW4gaMOzYTogbuG6v3UgdHJ1eeG7gW4gdsOgbyBPYmplY3QgdGjDrCBjaHV54buDbiBzYW5nIEFycmF5CgoKICAgICAgaWYgKCEocmVjb3JkcyBpbnN0YW5jZW9mIEFycmF5KSkgewogICAgICAgIHJlY29yZHMgPSBbcmVjb3Jkc107CiAgICAgIH0gLy/EkOG6qXkgdsOgbyBkYXRhU291cmNlCgoKICAgICAgbWUuZGF0YVNvdXJjZS5pdGVtcy5hcHBlbmQocmVjb3Jkcyk7IC8vxJDhuql5IHbDoG8gZOG7ryBsaeG7h3UgaGnhu4duIHThuqFpCgogICAgICBtZS5kYXRhLml0ZW1zLmFwcGVuZChyZWNvcmRzKTsgLy8gbWUuZGF0YS5pdGVtcyA9IG1lLmRhdGFTb3VyY2UuaXRlbXMuY2xvbmUoKTsKCiAgICAgIGlmIChtZS5yZW1vdGVGaWx0ZXIgPT09IGZhbHNlKSB7CiAgICAgICAgbWUubG9jYWxGaWx0ZXIodHJ1ZSk7CiAgICAgIH0KCiAgICAgIGlmIChtZS5yZW1vdGVTb3J0ID09PSBmYWxzZSkgewogICAgICAgIG1lLmxvY2FsU29ydCgpOwogICAgICB9CgogICAgICBtZS5sb2FkaW5nID0gZmFsc2U7CiAgICAgIG1lLmNvbXBsZXRlID0gdHJ1ZTsgLy9SYWlzZSBldmVudCBkYXRhQ2hhbmdlZCBjaG8gY29udHJvbAoKICAgICAgbWUubm90aWZ5KE1TRXZlbnROYW1lLk1TU3RvcmUuZGF0YUNoYW5nZWQsIG1lKTsKICAgIH0KICAgIC8qKg0KICAgICAqIExvYWQgZOG7ryBsaeG7h3UgdGhlbyBwYWdlIChwaOG7pWMgduG7pSBsb2FkIHBhZ2luZyB2w60gZOG7pSBjaG8gR3JpZCBob+G6t2MgbG9hZE9uRGVtYW5kIGNobyBjb21ibykNCiAgICAgKiBAYXV0aG9yIEROVGhhbmcgLSAwNi4wNy4yMDE5DQogICAgICogQHB1YmxpYw0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJsb2FkUGFnZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZFBhZ2UocGFnZSkgewogICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgIHZhciBheGlvc09wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKICAgICAgdmFyIG1lID0gdGhpcywKICAgICAgICAgIHNpemUgPSBtZS5wYWdlU2l6ZSwKICAgICAgICAgIGV4dHJhUGFyYW1zID0gbnVsbDsKCiAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMucGFnZVNpemUpIHsKICAgICAgICBzaXplID0gb3B0aW9ucy5wYWdlU2l6ZTsKICAgICAgfQoKICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5leHRyYVBhcmFtcykgewogICAgICAgIGV4dHJhUGFyYW1zID0gb3B0aW9ucy5leHRyYVBhcmFtczsKICAgICAgfSAvL2zGsHUgbOG6oWkgcGFnZSBoaeG7h24gdOG6oWkKCgogICAgICBtZS5jdXJyZW50UGFnZSA9IHBhZ2U7CiAgICAgIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKG9wdGlvbnMgfHwge30sIHsKICAgICAgICBwYWdpbmc6IHRydWUsCiAgICAgICAgcGFnZUluZGV4OiBwYWdlLAogICAgICAgIHBhZ2VTaXplOiBzaXplLAogICAgICAgIGV4dHJhUGFyYW1zOiBleHRyYVBhcmFtcywKICAgICAgICB1c2VTcDogbWUudXNlU3AKICAgICAgfSk7CiAgICAgIHJldHVybiBtZS5sb2FkKG9wdGlvbnMsIGF4aW9zT3B0aW9ucyk7CiAgICB9CiAgICAvKioNCiAgICAgKiBTYW5nIHRyYW5nIHRp4bq/cCB0aGVvDQogICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAibmV4dFBhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5leHRQYWdlKG9wdGlvbnMpIHsKICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgbWUubG9hZFBhZ2UobWUuY3VycmVudFBhZ2UgKyAxLCBvcHRpb25zKTsKICAgIH0KICAgIC8qKg0KICAgICAqIFRy4bufIHbhu4EgdHJhbmcgdHLGsOG7m2MNCiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucw0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJwcmV2aW91c1BhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByZXZpb3VzUGFnZShvcHRpb25zKSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgIG1lLmxvYWRQYWdlKG1lLmN1cnJlbnRQYWdlIC0gMSwgb3B0aW9ucyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2FuY2VsIiwKICAgIHZhbHVlOgogICAgLyoqDQogICAgICogSOG7p3kgcmVxdWVzdCDEkWFuZyBsb2FkDQogICAgICovCiAgICBmdW5jdGlvbiBjYW5jZWwoKSB7CiAgICAgIGlmICh0aGlzLmxvYWRpbmcgJiYgdGhpcy5jYW5jZWxTb3VyY2UpIHsKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICB0aGlzLmNhbmNlbFNvdXJjZS5jYW5jZWwoKTsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICogVGjhu7FjIGhp4buHbiBsb2FkIGThu68gbGnhu4d1IGNobyBzdG9yZSB04burIHNlcnZlcg0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zOiB7Y2FsbGJhY2s6IGZ1bmN0aW9uLCB9DQogICAgICogQG1vZGlmaWVkQnkgRE5UaGFuZyAxOC4xMC4yMDE5OiBC4buVIHN1bmcgdMOsbmggaHXhu5FuZyBjaG8gcGjDqXAgbG9hZCB0aGVvIGZ1bmN0aW9uIGN1c3RvbSAobG9hZEZuKQ0KICAgICAqIEBwdWJsaWMNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAibG9hZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZChvcHRpb25zLCBheGlvc09wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5jYW5jZWxMb2FkaW5nKSB7CiAgICAgICAgdGhpcy5jYW5jZWwoKTsKICAgICAgfQoKICAgICAgdmFyIG1lID0gdGhpcywKICAgICAgICAgIHByb3h5ID0gbWUucHJveHksCiAgICAgICAgICBDYW5jZWxUb2tlbiA9IGF4aW9zLkNhbmNlbFRva2VuLAogICAgICAgICAgc291cmNlID0gQ2FuY2VsVG9rZW4uc291cmNlKCksCiAgICAgICAgICBjYW5jZWxPcHRpb25zID0gewogICAgICAgIGNhbmNlbFRva2VuOiBzb3VyY2UudG9rZW4KICAgICAgfTsKICAgICAgYXhpb3NPcHRpb25zID0gXy5hc3NpZ24oY2FuY2VsT3B0aW9ucyB8fCB7fSwgYXhpb3NPcHRpb25zKTsgLy9UaGnhur90IGzhuq1wIGNhbmNlbFNvdXJjZSDEkeG7gyBjYW5jZWwgcmVxdWVzdCDEkWFuZyBsb2FkCgogICAgICBtZS5jYW5jZWxTb3VyY2UgPSBzb3VyY2U7CgogICAgICBpZiAoIW1lLmxvYWRpbmcpIHsKICAgICAgICAvL07hur91IGNoxrBhIGNvbmZpZyBQcm94eSBjaG8gc3RvcmUgdGjDrCB0aHJvdyBleHAgY+G6o25oIGLDoW8KICAgICAgICBpZiAoKCFwcm94eSB8fCBwcm94eS50eXBlID09PSAnY2FjaGUnICYmIHByb3h5LmtleUNhY2hlLmlzTnVsbE9yV2hpdGVTcGFjZSgpIHx8IHByb3h5LnR5cGUgIT09ICdjYWNoZScgJiYgcHJveHkuYXBpVXJsLmlzTnVsbE9yV2hpdGVTcGFjZSgpKSAmJiAhbWUubG9hZEZuKSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RFVjogY29uZmlnIHByb3h5L2xvYWRGbiBpbnZhbGlkLicpOwogICAgICAgIH0KCiAgICAgICAgdmFyIHBhZ2luZyA9IG9wdGlvbnMgJiYgb3B0aW9ucy5wYWdpbmcsCiAgICAgICAgICAgIGlzUGFyYW0gPSBmYWxzZSwKICAgICAgICAgICAgbHN0TWV0aG9kc1BhcmFtID0gWydkZWxldGUnLCAnZ2V0JywgJ2hlYWQnLCAnb3B0aW9ucyddOwogICAgICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgLy9GdW5jdGlvbiB44butIGzDvSBraGkgY2FsbCBhcGkgdGjDoG5oIGPDtG5nCiAgICAgICAgICB2YXIgbG9jYWxDYWxsYmFja09uU3VjY2VzcyA9IGZ1bmN0aW9uIGxvY2FsQ2FsbGJhY2tPblN1Y2Nlc3MocmVzcG9uc2UpIHsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgdmFyIHJlY29yZHMgPSBbXSwKICAgICAgICAgICAgICAgICAgYXBwZW5kID0gZmFsc2U7CiAgICAgICAgICAgICAgbWUubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIG1lLl9sb2FkZWQgPSB0cnVlOwoKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgaW5zdGFuY2VvZiBBcnJheSkgewogICAgICAgICAgICAgICAgcmVjb3JkcyA9IHJlc3BvbnNlOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHJlc3BvbnNlLnN0YXR1cyA9PSAyMDA7CgogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IHJlc3BvbnNlLmRhdGEuU3VjY2VzczsKCiAgICAgICAgICAgICAgICAgIGlmIChzdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHBhZ2luZykgewogICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuRGF0YS5EYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlY29yZHMgPSByZXNwb25zZS5kYXRhLkRhdGEuRGF0YTsKICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1vbkZuLmluZm9Mb2dnaW5nKCdHZXQgUGFnaW5nIG5vIGRhdGEuJyk7CiAgICAgICAgICAgICAgICAgICAgICB9IC8vR8OhbiBs4bqhaSBUb3RhbAoKCiAgICAgICAgICAgICAgICAgICAgICBtZS5wYWdlVG90YWwgPSByZXNwb25zZS5kYXRhLkRhdGEuVG90YWw7IC8vIERWUXVhbiAyLjExLjIwMTk6IEfDoW4gbOG6oWkgc3VtbWFucnlEYXRhCgogICAgICAgICAgICAgICAgICAgICAgbWUuc3VtbWFyeURhdGEgPSByZXNwb25zZS5kYXRhLkRhdGEuU3VtbWFyeURhdGE7CiAgICAgICAgICAgICAgICAgICAgICBtZS5zdW1tYXJ5R3JvdXBEYXRhID0gcmVzcG9uc2UuZGF0YS5EYXRhLlN1bW1hcnlHcm91cERhdGE7CiAgICAgICAgICAgICAgICAgICAgICBhcHBlbmQgPSBtZS5wYWdlQXBwZW5kOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5EYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICByZWNvcmRzID0gcmVzcG9uc2UuZGF0YS5EYXRhOwogICAgICAgICAgICAgICAgICAgIH0gLy9ETlRoYW5nIC0gMjIuMDQuMjAyMDogS2jDtG5nIGhp4buDdSBzYW8gbOG6oWkgY8OzIMSRb+G6oW4gY29kZSBuw6B5IOG7nyDEkcOieSB2w6wgZ8OhbiB0aOG6vyBuw6B5IHRow6wgbOG6oWkgxJFpIGfDoW4gcmVjb3JkcyA9IE9iamVjdCBTZXJ2aWNlUmVzcG9uc2UgdOG7qyBzZXJ2ZXIgPT4gU2FpIGThu68gbGnhu4d1CiAgICAgICAgICAgICAgICAgICAgLy8gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gCXJlY29yZHMgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgICAgICAgICAgIC8vIH0KCgogICAgICAgICAgICAgICAgICAgIGlmIChyZWNvcmRzLkRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgIHJlY29yZHMgPSByZWNvcmRzLkRhdGE7CiAgICAgICAgICAgICAgICAgICAgfSAvLyByZXR1cm4gcmVjb3JkczsKCiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy9O4bq/dSBjw7MgbOG7l2kgdGjDrCBn4buNaSBow6BtIHjhu60gbMO9IGzhu5dpCiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IC8vIGlmIChyZWNvcmRzLmxlbmd0aCA+IDApewoKCiAgICAgICAgICAgICAgbWUubG9hZERhdGEocmVjb3JkcywgYXBwZW5kKTsgLy8gfQoKICAgICAgICAgICAgICByZXNvbHZlKHsKICAgICAgICAgICAgICAgIHJlc3BvbnNlOiByZXNwb25zZSwKICAgICAgICAgICAgICAgIHJlY29yZHM6IHJlY29yZHMKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfTsgLy9GdW5jdGlvbiB44butIGzDvSBraGkgY2FsbCBhcGkgdGjhuqV0IGLhuqFpCgoKICAgICAgICAgIHZhciBsb2NhbENhbGxiYWNrT25FcnJvciA9IGZ1bmN0aW9uIGxvY2FsQ2FsbGJhY2tPbkVycm9yKGVycm9yKSB7CiAgICAgICAgICAgIG1lLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgY29tbW9uRm4uaGFuZGxlRXhjZXB0aW9uKGVycm9yKTsKICAgICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgICAgIH07CgogICAgICAgICAgaWYgKG1lLmxvYWRGbikgewogICAgICAgICAgICBtZS5sb2FkaW5nID0gdHJ1ZTsKCiAgICAgICAgICAgIHZhciBfY3VzdG9tRmlsdGVyID0gb3B0aW9ucyAmJiBvcHRpb25zLmN1c3RvbUZpbHRlciA/IG9wdGlvbnMuY3VzdG9tRmlsdGVyIDogW10sCiAgICAgICAgICAgICAgICBxdWVyeVN0cmluZyA9IF9jdXN0b21GaWx0ZXJbMF0gPyBfY3VzdG9tRmlsdGVyWzBdLnZhbHVlIDogJycsCiAgICAgICAgICAgICAgICByZXN1bHQgPSBtZS5sb2FkRm4uY2FsbChudWxsLCBxdWVyeVN0cmluZywgb3B0aW9ucywgbWUpOwoKICAgICAgICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIFByb21pc2UpIHsKICAgICAgICAgICAgICByZXN1bHQudGhlbihsb2NhbENhbGxiYWNrT25TdWNjZXNzLCBsb2NhbENhbGxiYWNrT25FcnJvcik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbWUubG9hZGluZyA9IGZhbHNlOwoKICAgICAgICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdCBpbnN0YW5jZW9mIEFycmF5KSB7CiAgICAgICAgICAgICAgICBsb2NhbENhbGxiYWNrT25TdWNjZXNzLmNhbGwobWUsIHJlc3VsdCk7IC8vbWUubG9hZERhdGEocmVzdWx0KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gLy9LaMO0bmcgeOG7rSBsw70gdMOsbmggaHXhu5FuZyBsb2FkIHF1YSBodHRwQ2xpZW50IG7hu69hCgoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSBlbHNlIGlmIChwcm94eS50eXBlID09PSAnY2FjaGUnKSB7CiAgICAgICAgICAgIGNsaWVudERhdGFiYXNlLmdldChwcm94eS5rZXlDYWNoZSkudGhlbihsb2NhbENhbGxiYWNrT25TdWNjZXNzLCBsb2NhbENhbGxiYWNrT25FcnJvcik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgcGFyYW1zID0ge307IC8vTuG6v3UgY8OzIEN1c3RvbSBGaWx0ZXIgdGjDrCB0aOG7sWMgaGnhu4duIHRydXnhu4FuIGzDqm4gc2VydmVyCgogICAgICAgICAgdmFyIGN1c3RvbUZpbHRlciA9IFtdOwoKICAgICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuY3VzdG9tRmlsdGVyICYmIG9wdGlvbnMuY3VzdG9tRmlsdGVyLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgb3B0aW9ucy5jdXN0b21GaWx0ZXIuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgIGN1c3RvbUZpbHRlci5wdXNoKGl0ZW0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmNoZWNrUGFyYW1CZWZvcmVMb2FkKSB7CiAgICAgICAgICAgIHZhciBrZXlzID0gW107CgogICAgICAgICAgICBpZiAob3B0aW9ucykgewogICAgICAgICAgICAgIGlmIChvcHRpb25zLmV4dHJhUGFyYW1zKSB7CiAgICAgICAgICAgICAgICBrZXlzLnB1c2gob3B0aW9ucy5leHRyYVBhcmFtcyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobWUucmVtb3RlRmlsdGVyICYmIG1lLmZpbHRlcnMgJiYgbWUuZmlsdGVycy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAga2V5cy5wdXNoKG1lLmZpbHRlcnMpOwogICAgICAgICAgICB9IC8vUmFpc2UgZXZlbnQgY2hvIGNvbnRyb2wKCgogICAgICAgICAgICBtZS5ub3RpZnkoJ2JlZm9yZUxvYWQnLCBtZSwgcGFyYW1zLCBjdXN0b21GaWx0ZXIpOwoKICAgICAgICAgICAgaWYgKGN1c3RvbUZpbHRlcikgewogICAgICAgICAgICAgIGtleXMucHVzaChjdXN0b21GaWx0ZXIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBrZXlzLnB1c2gocGFyYW1zKTsKICAgICAgICAgICAgdmFyIGNoZWNrS2V5ID0gSlNPTi5zdHJpbmdpZnkoa2V5cyk7CgogICAgICAgICAgICBpZiAoY2hlY2tLZXkgPT09IG1lLl9sYXN0UmVxdWVzdFBhcmFtS2V5KSB7CiAgICAgICAgICAgICAgLy9yZXR1cm4ga2jDtG5nIGxvYWQgZOG7ryBsaeG7h3UKICAgICAgICAgICAgICB2YXIgbmV3RGF0YSA9IG1lLmxhc3RTb3VyY2VEYXRhOwogICAgICAgICAgICAgIG1lLmxvYWRSZWNvcmRzKG5ld0RhdGEsIGZhbHNlKTsgLy9SYWlzZSBldmVudCBsb2FkZWQKCiAgICAgICAgICAgICAgbWUubm90aWZ5KE1TRXZlbnROYW1lLk1TU3RvcmUubG9hZGVkLCBtZSwgbmV3RGF0YSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBtZS5fbGFzdFJlcXVlc3RQYXJhbUtleSA9IGNoZWNrS2V5OwogICAgICAgICAgfSAvL0ROVGhhbmcgLSAyMy4wOC4yMDE5OiBC4buVIHN1bmcgdGjDqm0gdMOsbmggaHXhu5FuZyBjdXN0b20gcGFyYW0gY2hvIGPDoWMgdMOsbmggaHXhu5FuZyDEkeG6t2MgdGjDuQogICAgICAgICAgLy/EkOG6t3QgxJHhuqd1IHRpw6puIMSR4buDIMawdSB0acOqbiBjw6FjIHBhcmFtIGtow6FjIGPhu6dhIGjhu4cgdGjhu5FuZwoKCiAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmV4dHJhUGFyYW1zKSB7CiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocGFyYW1zLCBvcHRpb25zLmV4dHJhUGFyYW1zKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAobWUucmVtb3RlU29ydCAmJiBtZS5zb3J0ZXJzICYmIG1lLnNvcnRlcnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAvLyBwYXJhbXMuc29ydCA9IE1TSnNvbi5zZXJpYWxpemUobWUuc29ydGVycyk7CiAgICAgICAgICAgIC8vIHBhcmFtcy5zb3J0ID0gY29tbW9uRm4uY29udmVydFRvQmFzZTY0KG1lLnNvcnRlcnMpOwogICAgICAgICAgICBwYXJhbXMuc29ydCA9IG1lLmJ1aWxkU29ydFBhcmFtKG1lLnNvcnRlcnMpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChtZS5yZW1vdGVGaWx0ZXIgJiYgbWUuZmlsdGVycyAmJiBtZS5maWx0ZXJzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgLy8gcGFyYW1zLmZpbHRlciA9IE1TSnNvbi5zZXJpYWxpemUobWUuZmlsdGVycyk7CiAgICAgICAgICAgIHBhcmFtcy5maWx0ZXIgPSBtZS5idWlsZEZpbHRlclBhcmFtKG1lLmZpbHRlcnMpOwogICAgICAgICAgICBwYXJhbXMuZmlsdGVyID0gY29tbW9uRm4uY29udmVydFRvQmFzZTY0KHBhcmFtcy5maWx0ZXIpOwogICAgICAgICAgfSAvL1JhaXNlIGV2ZW50IGNobyBjb250cm9sCgoKICAgICAgICAgIG1lLm5vdGlmeSgnYmVmb3JlTG9hZCcsIG1lLCBwYXJhbXMsIGN1c3RvbUZpbHRlcik7CgogICAgICAgICAgaWYgKG9wdGlvbnMgJiYgY3VzdG9tRmlsdGVyLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgcGFyYW1zLmN1c3RvbUZpbHRlciA9IG1lLmJ1aWxkRmlsdGVyUGFyYW0oY3VzdG9tRmlsdGVyKTsKICAgICAgICAgICAgcGFyYW1zLmN1c3RvbUZpbHRlciA9IGNvbW1vbkZuLmNvbnZlcnRUb0Jhc2U2NChwYXJhbXMuY3VzdG9tRmlsdGVyKTsKICAgICAgICAgIH0gLy9O4bq/dSBjw7MgeOG7rSBsw70gcGjDom4gdHJhbmcgdGjDrCB0cnV54buBbiB0aMOqbSBjw6FjIHRoYW0gc+G7kSBwaOG7pWMgduG7pSBwYWdpbmcgLgoKCiAgICAgICAgICBpZiAocGFnaW5nKSB7CiAgICAgICAgICAgIGlmIChvcHRpb25zLmdyb3VwX2tleSkgewogICAgICAgICAgICAgIHBhcmFtcy5ncm91cF9rZXkgPSBvcHRpb25zLmdyb3VwX2tleTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcGFyYW1zLnRha2VSZW1haW4gPSBvcHRpb25zLnRha2VSZW1haW47CiAgICAgICAgICAgIHBhcmFtcy5za2lwID0gKG9wdGlvbnMucGFnZUluZGV4IC0gMSkgKiBvcHRpb25zLnBhZ2VTaXplOwogICAgICAgICAgICBwYXJhbXMudGFrZSA9IG9wdGlvbnMucGFnZVNpemU7IC8vIHBhcmFtcy5UYXhDb2RlID0gIjAxMDEyNDMxNTAtOTk5IjsKICAgICAgICAgICAgLy8gcGFyYW1zLnVzZVNwID0gb3B0aW9ucy51c2VTcDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAobWUuY29sdW1ucyAmJiBtZS5jb2x1bW5zICE9PSAnJykgewogICAgICAgICAgICBwYXJhbXMuY29sdW1ucyA9IG1lLmNvbHVtbnM7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG1lLnZpZXdOYW1lICYmIG1lLnZpZXdOYW1lICE9ICcnKSB7CiAgICAgICAgICAgIHBhcmFtcy52aWV3ID0gbWUudmlld05hbWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGxzdE1ldGhvZHNQYXJhbS5pbmRleE9mKG1lLnByb3h5Lm1ldGhvZCAhPT0gLTEpKSB7CiAgICAgICAgICAgIGlzUGFyYW0gPSB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChtZS5zdW1tYXJ5Q29sdW1ucyAmJiBtZS5zdW1tYXJ5Q29sdW1ucyAhPT0gJycpIHsKICAgICAgICAgICAgcGFyYW1zLnN1bW1hcnlDb2x1bW5zID0gbWUuc3VtbWFyeUNvbHVtbnM7CiAgICAgICAgICB9CgogICAgICAgICAgbWUubG9hZGluZyA9IHRydWU7CiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBHaeG7ryBs4bqhaSB0aGFtIHPhu5EgbOG6p24gbG9hZCBjdeG7kWkgxJHhu4MgeOG7rSBsw70geHXhuqV0IGto4bqpdQ0KICAgICAgICAgICAqLwoKICAgICAgICAgIG1lLmxhc3RQYXJhbSA9IHBhcmFtczsKICAgICAgICAgIHZhciBvcHRpb25BamF4ID0gewogICAgICAgICAgICB1cmw6IG1lLnByb3h5LmFwaVVybCwKICAgICAgICAgICAgbWV0aG9kOiBtZS5wcm94eS5tZXRob2QsCiAgICAgICAgICAgIGRhdGE6IGlzUGFyYW0gPyBudWxsIDogcGFyYW1zLAogICAgICAgICAgICBwYXJhbXM6IGlzUGFyYW0gPyBwYXJhbXMgOiBudWxsCiAgICAgICAgICB9OyAvL1BES0lFTiBC4buVIHN1bmcgdGhp4bq/dCBs4bqtcCBheGlvcyBu4bq/dSBjw7MKCiAgICAgICAgICBpZiAoYXhpb3NPcHRpb25zKSB7CiAgICAgICAgICAgIF8uYXNzaWduKG9wdGlvbkFqYXgsIGF4aW9zT3B0aW9ucyk7CiAgICAgICAgICB9IC8vICBodHRwQ2xpZW50CiAgICAgICAgICAvLyAgICAgIC5yZXF1ZXN0KG9wdGlvbkFqYXgpCiAgICAgICAgICAvLyAgICAgIC50aGVuKGxvY2FsQ2FsbGJhY2tPblN1Y2Nlc3MsIGxvY2FsQ2FsbGJhY2tPbkVycm9yKTsKCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHByb21pc2U7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIEJ1aWxkIHBhcmFtIGZpbHRlciB04burIGFycmF5IGZpbHRlciBoaeG7h24gdOG6oWkgxJHhu4MgdMawxqFuZyB0aMOtY2ggduG7m2kgeOG7rSBsw70gdHLDqm4gc2VydmVyDQogICAgICogdGhlbyBmb3JtYXQ6IFtb4oCcSXNBY3RpdmXigJ0s4oCdPeKAnSwxXSwg4oCcYW5k4oCdLCBb4oCcU3RhdHVz4oCdLOKAnT3igJ0sMF0s4oCdYW5k4oCdLFtb4oCcQ291cnNlR3JvdXBJROKAnSwg4oCcPeKAnSwgMTM1Nl1dXQ0KICAgICAqIFsiTmFtZSIsICJjb250YWlucyIsICJNaSJdDQogICAgICogWyJpc192ZW5kb3IiLCAiPSIsICJ0cnVlIl0NCiAgICAgKiBAcGFyYW0ge0FycmF5L09iamVjdH0gZmlsdGVycw0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJidWlsZEZpbHRlclBhcmFtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBidWlsZEZpbHRlclBhcmFtKGZpbHRlcnMpIHsKICAgICAgdmFyIG1lID0gdGhpcywKICAgICAgICAgIHNGaWx0ZXIgPSAnJzsKCiAgICAgIGlmIChmaWx0ZXJzICYmICEoZmlsdGVycyBpbnN0YW5jZW9mIEFycmF5KSkgewogICAgICAgIGZpbHRlcnMgPSBbZmlsdGVyc107CiAgICAgIH0KCiAgICAgIHZhciBsZW5ndGggPSBmaWx0ZXJzLmxlbmd0aDsKCiAgICAgIGlmIChsZW5ndGggPiAwKSB7CiAgICAgICAgdmFyIGksCiAgICAgICAgICAgIGFycmF5RmlsdGVycyA9IFtdLAogICAgICAgICAgICBzSm9pbiA9ICcsJzsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB2YXIgZmlsdGVyID0gZmlsdGVyc1tpXSwKICAgICAgICAgICAgICBzID0gJyInICsgZmlsdGVyLnByb3BlcnR5ICsgJyIsJyArIChmaWx0ZXIub3BlcmF0b3IgPyAnIicgKyBmaWx0ZXIub3BlcmF0b3IgKyAnIiwnIDogJycpLAogICAgICAgICAgICAgIC8vTeG6t2MgxJHhu4tuaCBvcGVyYW5kIGzDoCBgYW5kYAogICAgICAgICAgb3BlcmFuZCA9ICciYW5kIic7IC8vIGlmICh0eXBlb2YgZmlsdGVyLnZhbHVlID09PSAibnVtYmVyIikgewogICAgICAgICAgLy8gICBzICs9IGZpbHRlci52YWx1ZS50b1N0cmluZygpOwogICAgICAgICAgLy8gfSBlbHNlIHsKICAgICAgICAgIC8vICAgcyArPSAnIicgKyBmaWx0ZXIudmFsdWUgKyAnIic7CiAgICAgICAgICAvLyB9CgogICAgICAgICAgcyArPSBtZS5ub21hbGl6ZUZpbHRlclZhbHVlKGZpbHRlci5vcGVyYXRvciwgZmlsdGVyLnZhbHVlKTsKICAgICAgICAgIHMgPSAnWycgKyBzICsgJ10nOwoKICAgICAgICAgIGlmIChpICE9PSAwKSB7CiAgICAgICAgICAgIGlmIChmaWx0ZXIub3BlcmFuZCkgewogICAgICAgICAgICAgIG9wZXJhbmQgPSAnIicgKyBmaWx0ZXIub3BlcmFuZCArICciJzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYXJyYXlGaWx0ZXJzLmFkZChvcGVyYW5kKTsKICAgICAgICAgIH0KCiAgICAgICAgICBhcnJheUZpbHRlcnMuYWRkKHMpOwogICAgICAgIH0KCiAgICAgICAgc0ZpbHRlciA9IGFycmF5RmlsdGVycy5qb2luKHNKb2luKTsKCiAgICAgICAgaWYgKGxlbmd0aCA+IDEpIHsKICAgICAgICAgIHNGaWx0ZXIgPSAnWycgKyBzRmlsdGVyICsgJ10nOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHNGaWx0ZXI7CiAgICB9CiAgICAvKioNCiAgICAgKiBCdWlsZCBzb3J0IHThu6sgZOG6oW5nIEFycmF5IGhp4buHbiB04bqhaSBzYW5nIGThuqFuZyBwaMO5IGjhu6NwIHbhu5tpIHNlcnZlcg0KICAgICAqIFThu6sgZOG6oW5nIFt7cHJvcGVydHk6ICdpbnZlbnRvcnlfaXRlbV9jb2RlJyxkZXNjOiBmYWxzZX1dIHNhbmcgZOG6oW5nICJpbnZlbnRvcnlfaXRlbV9jb2RlIEFTQyINCiAgICAgKiBAcGFyYW1zIHNvcnRlcnMgQXJyYXkgY+G6p24gY2h1eeG7g24NCiAgICAgKiBAcmV0dXJuIE1hbmcgZOG7ryBsaeG7h3Uga2nhu4N1IFN0cmluZw0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJidWlsZFNvcnRQYXJhbSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYnVpbGRTb3J0UGFyYW0oc29ydGVycykgewogICAgICB2YXIgcGFyYW1zID0gW107CgogICAgICBpZiAoc29ydGVycyAmJiBzb3J0ZXJzLmxlbmd0aCA+IDApIHsKICAgICAgICBzb3J0ZXJzLmZvckVhY2goZnVuY3Rpb24gKF9pdGVtKSB7CiAgICAgICAgICB2YXIgcGFyYW0gPSBfaXRlbS5wcm9wZXJ0eSArICIgIiArIChfaXRlbS5kZXNjID8gIkRFU0MiIDogIkFTQyIpOwogICAgICAgICAgcGFyYW1zLnB1c2gocGFyYW0pOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBwYXJhbXMgPSBwYXJhbXMuam9pbignLCcpOwogICAgICByZXR1cm4gcGFyYW1zOwogICAgfQogICAgLyoqDQogICAgICogQ2h14bqpbiBow7NhIGdpw6EgdHLhu4sgZMO5bmcgxJHhu4MgYnVpbGQgZmlsdGVyIGzDqm4gc2VydmVyDQogICAgICogQHBhcmFtIHtTdHJpbmd9IG9wZXJhdG9yIHRvw6FuIHThu60gZmlsdGVyDQogICAgICogQHBhcmFtIHsqfSB2YWx1ZSBjw6FjIGdpw6EgdHLhu4sgZMO5bmcgxJHhu4MgZmlsdGVyDQogICAgICogQ3JlYXRlZEJ5IEROVGhhbmcgLSAyNi4xMS4yMDE5DQogICAgICovCgogIH0sIHsKICAgIGtleTogIm5vbWFsaXplRmlsdGVyVmFsdWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5vbWFsaXplRmlsdGVyVmFsdWUob3BlcmF0b3IsIHZhbHVlKSB7CiAgICAgIHZhciBtZSA9IHRoaXMsCiAgICAgICAgICByZXQgPSAnJzsKCiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHsKICAgICAgICByZXQgPSAnIicgKyB2YWx1ZS50b1VUQ0RhdGVUaW1lKCkgKyAnIic7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3dpdGNoIChvcGVyYXRvcikgewogICAgICAgICAgY2FzZSAnaW4nOgogICAgICAgICAgY2FzZSAnbm90aW4nOgogICAgICAgICAgICAvKiBUcm9uZyB0csaw4budbmcgaOG7o3ANCiAgICAgICAgICAgICAgLSBMw6AgbnVtYmVyIHRow6wgY2jhu4kgxJHDoXAg4bupbmc6IHZhbHVlOiB4eHgNCiAgICAgICAgICAgICAgLSBO4bq/dSBsw6Agc3RyaW5nIHRow6wgY2jhu4kgxJHDoXAg4bupbmc6ICIxLCAyLCAzIiBob+G6t2MgIigxLCAyLCAzKSINCiAgICAgICAgICAgICAgLSBO4bq/dSBsw6AgQXJyYXkgdGjDrCB04buxIGJ1aWxkDQogICAgICAgICAgICAqLwogICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykgewogICAgICAgICAgICAgIHJldCA9IHZhbHVlLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkgewogICAgICAgICAgICAgIC8vVHJvbmcgdHLGsOG7nW5nIGjhu6NwIGzDoCBt4bqjbmcgdGjDrCBjaHXhuqluIGjDs2EgdGnhur9wCiAgICAgICAgICAgICAgdmFyIHNWYWx1ZTsKICAgICAgICAgICAgICB2YWx1ZS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICdudW1iZXInKSB7CiAgICAgICAgICAgICAgICAgIHNWYWx1ZSA9IGl0ZW0udG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHNWYWx1ZSA9ICInIiArIGl0ZW0gKyAiJyI7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHJldCkgewogICAgICAgICAgICAgICAgICByZXQgKz0gJywnICsgc1ZhbHVlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgcmV0ID0gc1ZhbHVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBpZiAocmV0KSB7CiAgICAgICAgICAgICAgICAvL3JldCA9ICciKCcgKyByZXQgKyAnKSInCiAgICAgICAgICAgICAgICByZXQgPSAnIicgKyByZXQgKyAnIic7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUudG9TdHJpbmcoKTsKCiAgICAgICAgICAgICAgaWYgKHZhbHVlLnN0YXJ0c1dpdGgoJygnKSkgewogICAgICAgICAgICAgICAgcmV0ID0gJyInICsgdmFsdWUgKyAnIic7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldCA9ICciKCcgKyB2YWx1ZSArICcpIic7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykgewogICAgICAgICAgICAgIHJldCA9IHZhbHVlLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmV0ID0gJyInICsgdmFsdWUgKyAnIic7CiAgICAgICAgICAgIH0KCiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcmV0OwogICAgfQogICAgLyoqDQogICAgICogVGjhu7FjIGhp4buHbiBnaeG6o2kgcGjDs25nIMSR4buRaSB0xrDhu6NuZw0KICAgICAqIChD4bqnbiBnaeG6o2kgcGjDs25nIG5o4buvbmcgxJHhu5FpIHTGsOG7o25nIGfDrCBz4bq9IHjhu60gbMO9IOG7nyDEkcOieSkNCiAgICAgKiBAYXV0aG9yIEROVGhhbmcgLSAwNC4wNy4yMDE5DQogICAgICogQHB1YmxpYw0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJkb0Rlc3Ryb3kiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRvRGVzdHJveSgpIHsKICAgICAgdmFyIG1lID0gdGhpczsgLy9SYWlzZSBldmVudCBiZWZvcmVEZXN0cm95CgogICAgICBtZS4kZW1pdCgnYmVmb3JlRGVzdHJveScpOwogICAgICBtZS5jbGVhckRhdGEoKTsKICAgIH0gLy8jZW5kcmVnaW9uIE1ldGhvZAoKICAgIC8qKg0KICAgICAqIFRo4buxYyBoaeG7h24gZmlsdGVyIGThu68gbGnhu4d1IHRoZW8gZnVuY3Rpb24gdHJ1eeG7gW4gdsOgbw0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuRmlsdGVyDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm9yY2VBbGwNCiAgICAgKiAgKiBNb2RpZmllZCBMVERBVCAyNS4wMy4yMDIwDQogICAgICogVGjDqm0gcGFyYW0gZm9yY2VBbGwgxJHhu4MgeMOhYyDEkeG7i25oIGzhuqV5IGThu68gbGnhu4d1IHThu6sgZGF0YSBoYXkgZGF0YVNvdXJjZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJmaWx0ZXJEYXRhU291cmNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaWx0ZXJEYXRhU291cmNlKGZuRmlsdGVyKSB7CiAgICAgIHZhciBmb3JjZUFsbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIHZhciBtZSA9IHRoaXMsCiAgICAgICAgICBzb3VyY2UgPSBmb3JjZUFsbCA/IG1lLmRhdGFTb3VyY2UgOiBtZS5kYXRhLAogICAgICAgICAgaXRlbXMgPSBzb3VyY2UuaXRlbXMsCiAgICAgICAgICBsZW4gPSBpdGVtcy5sZW5ndGgsCiAgICAgICAgICByZXN1bHQgPSBbXSwKICAgICAgICAgIGk7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICBpZiAoZm5GaWx0ZXIuY2FsbChzb3VyY2UsIGl0ZW1zW2ldKSkgewogICAgICAgICAgcmVzdWx0LnB1c2goaXRlbXNbaV0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKg0KICAgICAqIEzhuqV5IHJhIGRhbmggc8OhY2ggY8OhYyBi4bqjbiBnaGkgYuG7iyB4w7NhIHRyw6puIHN0b3JlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldFJlbW92ZWRSZWNvcmRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZW1vdmVkUmVjb3JkcygpIHsKICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgcmV0dXJuIG1lLl9yZW1vdmVkOwogICAgfQogICAgLyoqDQogICAgICogTOG6pXkgcmEgZGFuaCBzw6FjaCBjw6FjIGLhuqNuIGdoaSBjw7MgdGhheSDEkeG7lWkgdHLDqm4gc3RvcmUNCiAgICAgKiBNb2RpZmllZCBMVERBVCAyNS4wMy4yMDIwDQogICAgICogVGjDqm0gcGFyYW0gZm9yY2VBbGwgxJHhu4MgeMOhYyDEkeG7i25oIGzhuqV5IGThu68gbGnhu4d1IHThu6sgZGF0YSBoYXkgZGF0YVNvdXJjZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRVcGRhdGVkUmVjb3JkcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VXBkYXRlZFJlY29yZHMoKSB7CiAgICAgIHZhciBmb3JjZUFsbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7CgogICAgICB2YXIgbWUgPSB0aGlzLAogICAgICAgICAgZmlsdGVyVXBkYXRlZCA9IGZ1bmN0aW9uIGZpbHRlclVwZGF0ZWQoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLmdldENoYW5nZXMoKSAmJiBpdGVtLl9waGFudG9tICE9PSB0cnVlOwogICAgICB9OwoKICAgICAgcmV0dXJuIG1lLmZpbHRlckRhdGFTb3VyY2UoZmlsdGVyVXBkYXRlZCwgZm9yY2VBbGwpOwogICAgfQogICAgLyoqDQogICAgICogTOG6pXkgcmEgY8OhYyBi4bqjbiBnaGkgdGjDqm0gbeG7m2kNCiAgICAgKiAgKiBNb2RpZmllZCBMVERBVCAyNS4wMy4yMDIwDQogICAgICogVGjDqm0gcGFyYW0gZm9yY2VBbGwgxJHhu4MgeMOhYyDEkeG7i25oIGzhuqV5IGThu68gbGnhu4d1IHThu6sgZGF0YSBoYXkgZGF0YVNvdXJjZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXROZXdSZWNvcmRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROZXdSZWNvcmRzKCkgewogICAgICB2YXIgZm9yY2VBbGwgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwoKICAgICAgdmFyIG1lID0gdGhpcywKICAgICAgICAgIGZpbHRlck5ldyA9IGZ1bmN0aW9uIGZpbHRlck5ldyhpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0uX3BoYW50b20gPT09IHRydWU7CiAgICAgIH07CgogICAgICByZXR1cm4gbWUuZmlsdGVyRGF0YVNvdXJjZShmaWx0ZXJOZXcsIGZvcmNlQWxsKTsKICAgIH0KICAgIC8qKg0KICAgICAqIFRo4buxYyBoaeG7h24gdGjDqm0gbeG7m2kgMSBi4bqjbiBnaGkgaG/hurdjIGRhbmggc8OhY2ggYuG6o24gZ2hpDQogICAgICogQHBhcmFtIHtNb2RlbFtdfSBhcmcgTW9kZWwgY+G6p24gdGjDqm0NCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiYWRkTmV3IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZGROZXcoYXJnLCBpc1RlbXApIHsKICAgICAgdmFyIG1lID0gdGhpcywKICAgICAgICAgIG1vZGVsID0gbWUubW9kZWw7IC8vWOG7rSBsw70gY2h14bqpbiBow7NhIGThu68gbGnhu4d1IHRydXnhu4FuIHbDoG8gxJHhu4Mga2jhu59pIHThuqFvIE1vZGVsCgogICAgICBpZiAoYXJnICYmIGFyZy5jb25zdHJ1Y3RvciAmJiBhcmcuY29uc3RydWN0b3IubmFtZSA9PT0gJ09iamVjdCcpIHsKICAgICAgICBkZWxldGUgYXJnLmlzTW9kZWw7CiAgICAgICAgZGVsZXRlIGFyZy5pc0VudGl0eTsKICAgICAgfQoKICAgICAgaWYgKCFhcmcgJiYgbW9kZWwpIHsKICAgICAgICBhcmcgPSBtb2RlbFV0aWwuY3JlYXRlTW9kZWwoe30sIG1vZGVsKTsKICAgICAgfQoKICAgICAgdmFyIHJlc3VsdCA9IG1lLmluc2VydChtZS5nZXRDb3VudCgpLCBhcmcsIGlzVGVtcCk7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShyZXN1bHQpKSB7CiAgICAgICAgcmVzdWx0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIGl0ZW0uX192S2V5VmFsdWUgPSBjb21tb25Gbi5nZW5lcmF0ZVVVSUQoKTsKICAgICAgICAgIGl0ZW0uX3BoYW50b20gPSB0cnVlOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vS2hpIGfhu41pIHbDoG8gxJHDonkgdGjDrCBsdcO0biBmb3JjZSBsw6AgbmV3IHJlY29yZAogICAgICAgIHJlc3VsdC5fX3ZLZXlWYWx1ZSA9IGNvbW1vbkZuLmdlbmVyYXRlVVVJRCgpOwogICAgICAgIHJlc3VsdC5fcGhhbnRvbSA9IHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioNCiAgICAgKiBYw7NhIMSRaSBjw6FjIGLhuqNuIGdoaSB0ZW1wDQogICAgICogQGF1dGhvciBETlRoYW5nIC0gMjMuMDQuMjAyMA0KICAgICAqIEByZXR1cm5zIHtBcnJheX0gRGFuaCBzw6FjaCBjw6FjIHRlbXAgcmVjb3Jkcw0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyZW1vdmVUZW1wUmVjb3JkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVUZW1wUmVjb3JkKCkgewogICAgICB2YXIgbWUgPSB0aGlzLAogICAgICAgICAgY291bnQgPSBtZS5nZXRDb3VudCgpOwogICAgICB2YXIgcmV0ID0gW107CgogICAgICBpZiAobWUuZ2V0Q291bnQoKSA+IDApIHsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICAgIHZhciBpdGVtID0gbWUuZGF0YS5pdGVtc1tpXTsKCiAgICAgICAgICBpZiAoaXRlbS5faXNUZW1wKSB7CiAgICAgICAgICAgIHJldC5wdXNoKGl0ZW0pOwogICAgICAgICAgfQogICAgICAgIH0gLy9Yw7NhIHThuq1wIGPDoWMgdGVtcFJlY29yZCBraOG7j2kgZGF0YSBj4bunYSBzdG9yZQoKCiAgICAgICAgaWYgKHJldC5sZW5ndGggPiAwKSB7CiAgICAgICAgICBtZS5kYXRhLml0ZW1zLnJlbW92ZShyZXQpOwogICAgICAgICAgbWUuZGF0YVNvdXJjZS5pdGVtcy5yZW1vdmUocmV0KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByZXQ7CiAgICB9CiAgICAvKioNCiAgICAgKiBM4bqleSByYSBkYW5oIHPDoWNoIGPDoWMgSXRlbXMgxJFhbmcgY8OzIGPhu6dhIHN0b3JlDQogICAgICogVsOsIGzDoCB0aGlzLmRhdGEuaXRlbXMgbsOqbiBsw6AgZOG7ryBsaeG7h3Ugc2F1IGZpbHRlcg0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXREYXRhKCkgewogICAgICB2YXIgbWUgPSB0aGlzOwogICAgICByZXR1cm4gbWUuZGF0YS5pdGVtczsKICAgIH0KICAgIC8qKg0KICAgICAqIEzhuqV5IHJhIHRvw6BuIGLhu5kgZGF0YSAobMOgIGRhdGEgZ+G7kWMgY2jGsGEgZmlsdGVyIHbDoCBzb3J0KQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRGdWxsRGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RnVsbERhdGEoKSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgIHJldHVybiBtZS5kYXRhU291cmNlLml0ZW1zLmNsb25lKCk7CiAgICB9CiAgICAvKioNCiAgICAgKiBLaeG7g20gdHJhIG1vZGVsIGPhu6dhIHN0b3JlIGPDsyB04buTbiB04bqhaSBgZmllbGROYW1lYCBoYXkga2jDtG5nDQogICAgICogQHBhcmFtIHtTdHJpbmd9IGZpZWxkTmFtZQ0KICAgICAqIEByZXR1cm5zIHRydWU6IHThu5NuIHThuqFpLCBmYWxzZToga2jDtG5nIHThu5NuIHThuqFpDQogICAgICovCgogIH0sIHsKICAgIGtleTogImhhc0ZpZWxkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBoYXNGaWVsZChmaWVsZE5hbWUpIHsKICAgICAgdmFyIG1lID0gdGhpcywKICAgICAgICAgIGV4aXN0ID0gZmFsc2U7CgogICAgICBpZiAobWUubW9kZWwpIHsKICAgICAgICBleGlzdCA9IG1lLm1vZGVsLnByb3RvdHlwZS5oYXNGaWVsZChmaWVsZE5hbWUpOwogICAgICB9CgogICAgICByZXR1cm4gZXhpc3Q7CiAgICB9CiAgICAvKioNCiAgICAgKiBM4bqleSByYSBpZFByb3BlcnR5IGPhu6dhIE1vZGVsDQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldElkUHJvcGVydHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldElkUHJvcGVydHkoKSB7CiAgICAgIHZhciBtZSA9IHRoaXMsCiAgICAgICAgICByZXQgPSAnJzsKCiAgICAgIGlmIChtZS5tb2RlbCkgewogICAgICAgIGlmICghbWUuaWRQcm9wZXJ0eSkgewogICAgICAgICAgbWUuaWRQcm9wZXJ0eSA9IG1lLm1vZGVsLnByb3RvdHlwZS5nZXRJZFByb3BlcnR5KCk7CiAgICAgICAgfQoKICAgICAgICByZXQgPSBtZS5pZFByb3BlcnR5OwogICAgICB9CgogICAgICByZXR1cm4gcmV0OwogICAgfQogICAgLyoqDQogICAgICogTOG6pXkgcmEgZGFuaCBzw6FjaCBjw6FjIGZpZWxkcyBj4bunYSBtb2RlbA0KICAgICAqIChO4bq/dSBraMO0bmcgY8OzIG1vZGVsIHRow6wgcmV0dXJuIGBudWxsYCkNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0RmllbGRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGaWVsZHMoKSB7CiAgICAgIHZhciBtZSA9IHRoaXMsCiAgICAgICAgICBmaWVsZHMgPSBudWxsOwoKICAgICAgaWYgKG1lLm1vZGVsKSB7CiAgICAgICAgZmllbGRzID0gbWUubW9kZWwucHJvdG90eXBlLmdldEZpZWxkcygpOwogICAgICB9CgogICAgICByZXR1cm4gZmllbGRzOwogICAgfQogICAgLyoqDQogICAgICogTOG6pXkgcmEgY8OhYyBi4bqjbiBnaGkgY8OzIHRoYXkgxJHhu5VpIHBo4bulYyB24bulIGNobyBjb21taXQNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0TW9kaWZpZWRSZWNvcmRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRNb2RpZmllZFJlY29yZHMoKSB7CiAgICAgIHJldHVybiBbXS5jb25jYXQodGhpcy5nZXROZXdSZWNvcmRzKCksIHRoaXMuZ2V0VXBkYXRlZFJlY29yZHMoKSk7CiAgICB9CiAgICAvKioNCiAgICAgKiBM4bqleSByYSBjw6FjIFJlY29yZHMgdGhheSDEkeG7lWkgY+G6p24gcmVqZWN0DQogICAgICogICogTW9kaWZpZWQgTFREQVQgMjUuMDMuMjAyMA0KICAgICAqIFRow6ptIHBhcmFtIGZvcmNlQWxsIMSR4buDIHjDoWMgxJHhu4tuaCBs4bqleSBk4buvIGxp4buHdSB04burIGRhdGEgaGF5IGRhdGFTb3VyY2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0UmVqZWN0UmVjb3JkcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmVqZWN0UmVjb3JkcygpIHsKICAgICAgdmFyIGZvcmNlQWxsID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKCiAgICAgIHZhciBtZSA9IHRoaXMsCiAgICAgICAgICBmaWx0ZXJSZWplY3RzID0gZnVuY3Rpb24gZmlsdGVyUmVqZWN0cyhpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0uX3BoYW50b20gfHwgaXRlbS5fZGlydHk7CiAgICAgIH07CgogICAgICByZXR1cm4gbWUuZmlsdGVyRGF0YVNvdXJjZShmaWx0ZXJSZWplY3RzLCBmb3JjZUFsbCk7CiAgICB9CiAgICAvKioNCiAgICAgKiBUaOG7sWMgaGnhu4duIGNvbW1pdCB04bqldCBj4bqjIGPDoWMgcmVjb3JkIGPDsyB0aGF5IMSR4buVaQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJjb21taXRDaGFuZ2VzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21taXRDaGFuZ2VzKCkgewogICAgICB2YXIgbWUgPSB0aGlzLAogICAgICAgICAgcmVjcyA9IG1lLmdldE1vZGlmaWVkUmVjb3JkcygpLAogICAgICAgICAgbGVuID0gcmVjcy5sZW5ndGgsCiAgICAgICAgICBpID0gMCwKICAgICAgICAgIHJlbW92ZWQgPSBtZS5fcmVtb3ZlZDsKCiAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICByZWNzW2ldLmNvbW1pdCgpOwogICAgICB9IC8vWMOzYSBjw6FjIHJlY29yZCDEkcOjIGLhu4sgcmVtb3ZlCgoKICAgICAgaWYgKHJlbW92ZWQpIHsKICAgICAgICByZW1vdmVkLmxlbmd0aCA9IDA7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIFjhu60gbMO9IHJlamVjdENoYW5nZXMgdG/DoG4gYuG7mSBjw6FjIHRoYXkgxJHhu5VpIHRyw6puIHN0b3JlDQogICAgICogKFBo4bulYyB24bulIGNobyB2aeG7h2MgY2FuY2VsIHRoYXkgxJHhu5VpKQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyZWplY3RDaGFuZ2VzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZWplY3RDaGFuZ2VzKCkgewogICAgICB2YXIgbWUgPSB0aGlzLAogICAgICAgICAgcmVjcyA9IG1lLmdldFJlamVjdFJlY29yZHMoKSwKICAgICAgICAgIGxlbiA9IHJlY3MubGVuZ3RoLAogICAgICAgICAgcmVtb3ZlZCA9IG1lLl9yZW1vdmVkLAogICAgICAgICAgaSwKICAgICAgICAgIHJlYywKICAgICAgICAgIGFkZGVkOyAvL1Ro4buxYyBoaeG7h24gcmVtb3ZlIGPDoWMgcmVjb3JkIHRow6ptIHbDoCBz4butYQoKICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgcmVjID0gcmVjc1tpXTsKCiAgICAgICAgaWYgKHJlYy5fcGhhbnRvbSkgewogICAgICAgICAgYWRkZWQgPSBhZGRlZCB8fCBbXTsKICAgICAgICAgIGFkZGVkLnB1c2gocmVjKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVjLnJlamVjdCgpOwogICAgICAgIH0KICAgICAgfSAvL1jDs2EgY8OhYyBi4bqjbiBnaGkgdGjDqm0gbeG7m2kgdOG7qyBjbGllbnQgdHLDqm4gc3RvcmUKCgogICAgICBpZiAoYWRkZWQpIHsKICAgICAgICBtZS5yZW1vdmUoYWRkZWQpOwoKICAgICAgICBmb3IgKGkgPSAwLCBsZW4gPSBhZGRlZC5sZW5ndGg7IGkgPCBsZW47ICsraSkgewogICAgICAgICAgYWRkZWRbaV0ucmVqZWN0KCk7CiAgICAgICAgfQogICAgICB9IC8vUm9sbGJhY2sgY8OhYyBi4bqjbiBnaGkgxJHDoyB4w7NhIHRyw6puIHN0b3JlCgoKICAgICAgaWYgKHJlbW92ZWQpIHsKICAgICAgICBsZW4gPSByZW1vdmVkLmxlbmd0aDsKCiAgICAgICAgZm9yIChpID0gbGVuIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICAgIHJlYyA9IHJlbW92ZWRbaV07CiAgICAgICAgICByZWMucmVqZWN0KCk7IC8vWOG7rSBsw70gc29ydCBkYXRhIHNhdQoKICAgICAgICAgIG1lLmluc2VydCgwLCByZWMpOwogICAgICAgIH0gLy9Yw7NhIGPDoWMgYuG6o24gZ2hpIGLhu4sgeMOzYQoKCiAgICAgICAgcmVtb3ZlZC5sZW5ndGggPSAwOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiBLaeG7g20gdHJhIHN0b3JlIGPDsyB0aGF5IMSR4buVaSBnw6wgbGnDqm4gcXVhbiDEkeG6v24gZOG7ryBsaeG7h3Uga2jDtG5nPw0KICAgICAqIGB0cnVlYDogY8OzLCBgZmFsc2VgOiBraMO0bmcNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaGFzQ2hhbmdlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzQ2hhbmdlcygpIHsKICAgICAgdmFyIG1lID0gdGhpcywKICAgICAgICAgIGZvcmNlQWxsID0gZmFsc2UsCiAgICAgICAgICBpZ25vcmVUZW1wID0gdHJ1ZSwKICAgICAgICAgIHJlY3MgPSBtZS5nZXRNb2RpZmllZFJlY29yZHMoZm9yY2VBbGwsIGlnbm9yZVRlbXApLAogICAgICAgICAgcmVzdWx0ID0gZmFsc2U7IC8vIELhu48gcXVhIG5o4buvbmcgYuG6o24gZ2hpIGlzVGVtcCBtw6AgY2jGsGEgY8OzIHPhu7EgdGhheSDEkeG7lWkKCiAgICAgIHJlY3MgPSByZWNzLmZpbHRlcihmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiAhKHguX2lzVGVtcCAmJiAheC5nZXRDaGFuZ2VzKCkpOwogICAgICB9KTsKCiAgICAgIGlmIChyZWNzICYmIHJlY3MubGVuZ3RoID4gMCkgewogICAgICAgIHJlc3VsdCA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAobWUuX3JlbW92ZWQgJiYgbWUuX3JlbW92ZWQubGVuZ3RoID4gMCkgewogICAgICAgIHJlc3VsdCA9IHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioNCiAgICAgKiBUaGnhur9wIGzhuq1wIHVybCBjaG8gcHJveHkNCiAgICAgKiBAcGFyYW0ge3VybH0gdXJsDQogICAgICogQ3JlYXRlZEJ5IFBES0lFTiA4LzEvMjAyMA0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzZXRBcGlVcmwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEFwaVVybCh1cmwpIHsKICAgICAgdGhpcy5wcm94eS5hcGlVcmwgPSB1cmw7CiAgICAgIHRoaXMuJGVtaXQoJ3VybENoYW5nZWQnLCB1cmwpOwogICAgfQogICAgLyoqDQogICAgICogVMOtbmggdOG7lW5nIHPhu5EgdHJhbmcgdGhlbyBwYWdlU2l6ZSBoaeG7h24gdOG6oWkgY+G7p2Egc3RvcmUNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0VG90YWxQYWdlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VG90YWxQYWdlcygpIHsKICAgICAgcmV0dXJuIE1hdGguY2VpbCh0aGlzLnBhZ2VUb3RhbCAvIHRoaXMucGFnZVNpemUpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIE1TU3RvcmU7Cn0oVnVlKTsgLy8gZXhwb3J0IGRlZmF1bHQgTVNTdG9yZSgpOwoKCmV4cG9ydCB7IE1TU3RvcmUgYXMgZGVmYXVsdCB9Ow=="},null]}