{"remainingRequest":"D:\\VNT_vue\\node_modules\\babel-loader\\lib\\index.js!D:\\VNT_vue\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\VNT_vue\\src\\views\\base\\BaseListPopup.js","dependencies":[{"path":"D:\\VNT_vue\\src\\views\\base\\BaseListPopup.js","mtime":1656127264075},{"path":"D:\\VNT_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\VNT_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\VNT_vue\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L1ZOVF92dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICJEOi9WTlRfdnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgQmFzZUxpc3QgZnJvbSAiQC92aWV3cy9iYXNlL0Jhc2VMaXN0IjsKaW1wb3J0IHsgcGVybWlzc2lvbiB9IGZyb20gIkAvbWl4aW5zL2NvbW1vbi9wZXJtaXNzaW9uIjsKaW1wb3J0IHsgbWFwU3RhdGUsIG1hcEFjdGlvbnMsIG1hcEdldHRlcnMgfSBmcm9tICJ2dWV4IjsKaW1wb3J0IHsgTW9kdWxlTGF5b3V0VGVtcGxhdGUsIE1vZHVsZUNvbnRleHQsIE1vZHVsZU9yZ2FuaXphdGlvbiB9IGZyb20gIkAvc3RvcmVzL21vZHVsZS1jb25zdCI7IC8vIGltcG9ydCBleHBvcnRBcGkgZnJvbSAiQC9hcGlzL2V4cG9ydEFQSSI7CgppbXBvcnQgTVNKc29uIGZyb20gIkAvY29tbW9ucy9qc29uIjsKaW1wb3J0IHsgc2hvcnRrZXlTdGF0dXNiYXIgfSBmcm9tICJAL21peGlucy9jb21tb24vc2hvcnRrZXlTdGF0dXNiYXIiOwppbXBvcnQgcG9wdXBVdGlsIGZyb20gIkAvY29tbW9ucy9wb3B1cFV0aWwiOwppbXBvcnQgY29tbW9uRm4gZnJvbSAiQC9jb21tb25zL2NvbW1vbkZ1bmN0aW9uIjsKZXhwb3J0IGRlZmF1bHQgewogIGV4dGVuZHM6IEJhc2VMaXN0LAogIG5hbWU6ICJCYXNlTGlzdFBvcHVwIiwKICBtaXhpbnM6IFtwZXJtaXNzaW9uLCBzaG9ydGtleVN0YXR1c2Jhcl0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIC8qKg0KICAgICAgICogQWN0aW9uIGPhu6dhIHThu6tuZyBi4bqjbiBnaGkga2hpIGFjdGl2ZQ0KICAgICAgICovCiAgICAgIHJvd0FjdGlvbnM6IFtdLAoKICAgICAgLyoqDQogICAgICAgKiBUw6puIGtleSBt4bqrdQ0KICAgICAgICovCiAgICAgIGxheW91dFRhZzogbnVsbCwKCiAgICAgIC8qKg0KICAgICAgICogQ8OhYyBhY3Rpb24ga2hpIGNo4buNbiBuaGnhu4F1DQogICAgICAgKi8KICAgICAgYWN0aW9uTXVsdGk6IFtdLAoKICAgICAgLyoqDQogICAgICAgKiByZWZuYW1lIGNvbnRyb2wgaGnhu4NuIHRo4buLIGFjdGlvbiBraGkgY2jhu41uIG5oaeG7gXUgYuG6o24gZ2hpDQogICAgICAgKi8KICAgICAgYWN0aW9uTXV0aWxSZWY6ICJhY3Rpb25NdWx0aSIsCgogICAgICAvKioNCiAgICAgICAqIHJlZm5hbWUgY29udHJvbCBoaeG7g24gdGjhu4sgYWN0aW9uIGtoaSBjaOG7jW4gbmhp4buBdSBi4bqjbiBnaGkgKCBtw6BuIGjDrG5oIHRvIGjGoW4gMTIwMCkNCiAgICAgICAqLwogICAgICBhY3Rpb25NdXRpbFJlZkJpZ1NjcmVlbjogImFjdGlvbk11bHRpQmlnU2NyZWVuIiwKICAgICAgbGF5b3V0OiB7fSwKICAgICAgdGl0bGU6ICIiLAoKICAgICAgLyoqDQogICAgICAgKiBjw7Mgc2hvdyB04bqldCBj4bqjIGljb24gZmlsdGVyIGhlYWRlciBncmlkIGzDqm4gaw0KICAgICAgICovCiAgICAgIHNob3dBbGxJY29uRmlsdGVyOiBmYWxzZSwKCiAgICAgIC8qKg0KICAgICAgICogU2hvdyBmaWx0ZXIgYm94DQogICAgICAgKi8KICAgICAgaXNTaG93RmlsdGVyOiBmYWxzZSwKCiAgICAgIC8qKg0KICAgICAgICogU2hvdyBtb3JlIGFjdGlvbiBib3gNCiAgICAgICAqLwogICAgICBpc1Nob3dBY3Rpb25Hcm91cDogZmFsc2UKICAgIH07CiAgfSwKICBjb21wdXRlZDogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG1hcEdldHRlcnMoTW9kdWxlQ29udGV4dCwgWyJDb250ZXh0Il0pKSwgbWFwR2V0dGVycyh7CiAgICBvcmdzOiBNb2R1bGVPcmdhbml6YXRpb24gKyAiL3RyZWUiCiAgfSkpLCB7fSwgewogICAgLyoqDQogICAgICogxJDhu5FpIHTGsOG7o25nIHN0YXRlIGPhu6dhIHN0b3JlDQogICAgICovCiAgICBzdG9yZVN0YXRlOiBmdW5jdGlvbiBzdG9yZVN0YXRlKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGVbdGhpcy5tb2R1bGVdOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBLaMO0bmcgY8OzIGThu68gbGnhu4d1IHRyb25nIGLhuqNuZw0KICAgICAqIETDuW5nIGPhu50gbsOgeSDEkeG7gyBoaeG7g24gdGjhu4sgbeG6t2MgaMOsbmggdHLhu5FuZyB0csOqbiBkYW5oIHPDoWNoDQogICAgICovCiAgICBlbXB0eTogZnVuY3Rpb24gZW1wdHkoKSB7CiAgICAgIHJldHVybiB0aGlzLnN0b3JlU3RhdGUuZW1wdHk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEThu68gbGnhu4d1IGhp4buDbiB0aOG7iw0KICAgICAqLwogICAgaXRlbXM6IGZ1bmN0aW9uIGl0ZW1zKCkgewogICAgICByZXR1cm4gdGhpcy5zdG9yZVN0YXRlLml0ZW1zOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBU4buVbmcgc+G7kQ0KICAgICAqLwogICAgdG90YWw6IGZ1bmN0aW9uIHRvdGFsKCkgewogICAgICByZXR1cm4gdGhpcy5zdG9yZVN0YXRlLnRvdGFsOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBTdW1tYXJ5IGPhu6dhIGdyaWQNCiAgICAgKi8KICAgIHN1bW1hcnk6IGZ1bmN0aW9uIHN1bW1hcnkoKSB7CiAgICAgIHJldHVybiB0aGlzLnN0b3JlU3RhdGUuc3VtbWFyeTsKICAgIH0sCgogICAgLyoqDQogICAgICogbG9hZGluZw0KICAgICAqLwogICAgbG9hZGluZzogZnVuY3Rpb24gbG9hZGluZygpIHsKICAgICAgcmV0dXJuIHRoaXMuc3RvcmVTdGF0ZS5sb2FkaW5nOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBsb2FkaW5nIHN1bW1hcnkNCiAgICAgKi8KICAgIGxvYWRpbmdTdW1tYXJ5OiBmdW5jdGlvbiBsb2FkaW5nU3VtbWFyeSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3RvcmVTdGF0ZS5sb2FkaW5nU3VtbWFyeTsKICAgIH0sCgogICAgLyoqDQogICAgICogQ+G7mXQgdGhlbyBj4bqldSBow6xuaCBj4bunYSBt4bqrdQ0KICAgICAqLwogICAgbGF5b3V0Q29sdW1uczogZnVuY3Rpb24gbGF5b3V0Q29sdW1ucygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlW01vZHVsZUxheW91dFRlbXBsYXRlXS5hcHBseTsKICAgIH0sCgogICAgLyoqDQogICAgICogQ29udHJvbCBoaeG7g24gdGjhu4sgYWN0aW9uIGtoaSBjaOG7jW4gbmhp4buBdSBi4bqjbiBnaGkNCiAgICAgKi8KICAgIGFjdGlvbk11bHRpQ29tcG9uZW50OiBmdW5jdGlvbiBhY3Rpb25NdWx0aUNvbXBvbmVudCgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHJlZnNbdGhpcy5hY3Rpb25NdXRpbFJlZl07CiAgICB9LAoKICAgIC8qKg0KICAgICAqIENvbnRyb2wgaGnhu4NuIHRo4buLIGFjdGlvbiBraGkgY2jhu41uIG5oaeG7gXUgYuG6o24gZ2hpIChtw6BuIGjDrG5oIGzhu5tuKQ0KICAgICAqLwogICAgYWN0aW9uTXVsdGlCaWdTY3JlZW5Db21wb25lbnQ6IGZ1bmN0aW9uIGFjdGlvbk11bHRpQmlnU2NyZWVuQ29tcG9uZW50KCkgewogICAgICByZXR1cm4gdGhpcy4kcmVmc1t0aGlzLmFjdGlvbk11dGlsUmVmQmlnU2NyZWVuXTsKICAgIH0KICB9KSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkge30sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBtZSA9IHRoaXM7CiAgICB3aW5kb3cuX3h4ID0gdGhpczsgLy9pbml0IGxheW91dAoKICAgIG1lLmluaXRMYXlvdXQoKTsgLy9pbml0IGV2ZW50CgogICAgbWUuaW5pdEV2ZW50KCk7CiAgfSwKICBtZXRob2RzOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG1hcEFjdGlvbnMoewogICAgbG9hZEFwcGx5TGF5b3V0OiBNb2R1bGVMYXlvdXRUZW1wbGF0ZSArICIvbG9hZEFwcGx5IgogIH0pKSwge30sIHsKICAgIC8qKg0KICAgICAqIEzhuqV5IGPhuqV1IGjDrG5oIGPhu5l0IHRoZW8gbeG6q3Ugw6FwIGThu6VuZw0KICAgICAqLwogICAgZ2V0TGF5b3V0VGVtcGxhdGU6IGZ1bmN0aW9uIGdldExheW91dFRlbXBsYXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgbWUsIGNhY2hlTGF5b3V0VGVtcGxhdGU7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgbWUgPSBfdGhpczsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIG1lLmdldENhY2hlTGF5b3V0VGVtcGxhdGUoKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgY2FjaGVMYXlvdXRUZW1wbGF0ZSA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKCFjYWNoZUxheW91dFRlbXBsYXRlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBjYWNoZUxheW91dFRlbXBsYXRlKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgX3RoaXMubGF5b3V0Q29sdW1uc1tfdGhpcy5sYXlvdXRUYWddKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBY4butIGzDvSBj4bqldSBow6xuaCBt4bqrdSBj4bunYSBmb3JtDQogICAgICovCiAgICBpbml0TGF5b3V0OiBmdW5jdGlvbiBpbml0TGF5b3V0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciBtZSwgbGF5b3V0LCBjb2x1bW5zOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBtZSA9IF90aGlzMjsKCiAgICAgICAgICAgICAgICBpZiAoIW1lLmxheW91dFRhZykgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gbWUuZ2V0TGF5b3V0VGVtcGxhdGUoKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgbGF5b3V0ID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKCEoIWxheW91dCB8fCBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gImRldmVsb3BtZW50IikpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDg7CiAgICAgICAgICAgICAgICByZXR1cm4gbWUubG9hZEFwcGx5TGF5b3V0KG1lLmxheW91dFRhZyk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIGxheW91dCA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBtZS5sYXlvdXQgPSBtZS5jb252ZXJ0VG9MYXlvdXRUZW1wbGV0ZShsYXlvdXQpOwogICAgICAgICAgICAgICAgY29sdW1ucyA9IG1lLmdldExheW91dENvbHVtbihsYXlvdXQpOwogICAgICAgICAgICAgICAgbWUuZ3JpZC5pbml0Q29sdW1ucyhjb2x1bW5zKTsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIC8vbG9hZCBk4buvIGxp4buHdSBs4bqnbiDEkeG6p3UKICAgICAgICAgICAgICAgIG1lLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIG1lLnJlbG9hZCgpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBjb252ZXJ0VG9MYXlvdXRUZW1wbGV0ZTogZnVuY3Rpb24gY29udmVydFRvTGF5b3V0VGVtcGxldGUobGF5b3V0KSB7CiAgICAgIHZhciBsYXlvdXRUZW1wbGV0ZSA9IHt9OwoKICAgICAgaWYgKGxheW91dCkgewogICAgICAgIGxheW91dFRlbXBsZXRlLkxheW91dFRlbXBsYXRlSUQgPSBsYXlvdXQuTGF5b3V0VGVtcGxhdGVJRDsKICAgICAgICBsYXlvdXRUZW1wbGV0ZS5MYXlvdXRUYWcgPSBsYXlvdXQuTGF5b3V0VGFnOwogICAgICAgIGxheW91dFRlbXBsZXRlLlVzZXJJRCA9IGxheW91dC5Vc2VySUQgfHwgdGhpcy5Db250ZXh0LlVzZXJJRDsKICAgICAgICBsYXlvdXRUZW1wbGV0ZS5Jc1N5c3RlbSA9IGxheW91dC5Jc1N5c3RlbTsKICAgICAgICBsYXlvdXRUZW1wbGV0ZS5MYXlvdXRDb25maWcgPSBsYXlvdXQuQ29sdW1uczsKICAgICAgICBsYXlvdXRUZW1wbGV0ZS5MYXlvdXRUZW1wbGF0ZU5hbWUgPSBsYXlvdXQuTGF5b3V0VGVtcGxhdGVOYW1lOwogICAgICB9CgogICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgbGF5b3V0VGVtcGxldGUpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBM4bqleSB0aMO0bmcgdGluIGNvbHVtbiByZW5kZXIgdOG7qyB0aMO0bmcgdGluIGPhu6dhIG3huqt1DQogICAgICovCiAgICBnZXRMYXlvdXRDb2x1bW46IGZ1bmN0aW9uIGdldExheW91dENvbHVtbihsYXlvdXQpIHsKICAgICAgaWYgKGxheW91dCAhPSB1bmRlZmluZWQpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzOwogICAgICAgIHZhciBjb2x1bW5zID0gSlNPTi5wYXJzZShsYXlvdXQuQ29sdW1ucyk7IC8vbuG6v3UgbMOgIG3huqt1IG3hurdjIMSR4buLbmggdsOgIG5nw7RuIG5n4buvIGtow6FjIHRp4bq/bmcgdmnhu4d0IC0+IGPhuq1wIG5o4bqtdCBjYXB0aW9uL3RpdGxlIHRoZW8gbmfDtG4gbmfhu68KCiAgICAgICAgaWYgKGxheW91dC5Jc1N5c3RlbSkgewogICAgICAgICAgbWUubG9jYWxpemF0aW9uQ29sdW1uKGNvbHVtbnMpOwogICAgICAgIH0gLy9ubmxhbTogb3JkZXJieSBs4bqhaSB0aGVvIHNvcnRfb3JkZXIgdsOgIGxvY2suCgoKICAgICAgICBjb2x1bW5zID0gXyhjb2x1bW5zKS5jaGFpbigpLnNvcnRCeSgic29ydF9vcmRlciIpLnNvcnRCeShmdW5jdGlvbiAoY29sdW1uKSB7CiAgICAgICAgICByZXR1cm4gIWNvbHVtbi5sb2NrOwogICAgICAgIH0pLnZhbHVlKCk7CiAgICAgICAgcmV0dXJuIGNvbHVtbnM7CiAgICAgIH0KICAgIH0sCgogICAgLyoqDQogICAgICogR+G7jWkgcmVxdWVzdCBsb2FkIGThu68gbGnhu4d1DQogICAgICogR+G7jWkgdsOgbyBjcnVkLWJhc2UNCiAgICAgKi8KICAgIHJlcXVlc3RMb2FkRGF0YTogZnVuY3Rpb24gcmVxdWVzdExvYWREYXRhKHBheWxvYWQpIHsKICAgICAgdmFyIG1lID0gdGhpczsKCiAgICAgIGlmIChtZS5ncmlkICYmIG1lLmdyaWQuaXNHcmlkVHJlZSkgewogICAgICAgIG1lLiRzdG9yZS5kaXNwYXRjaCgiIi5jb25jYXQobWUubW9kdWxlLCAiL2xvYWRMaXN0VHJlZSIpLCBwYXlsb2FkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBtZS4kc3RvcmUuZGlzcGF0Y2goIiIuY29uY2F0KG1lLm1vZHVsZSwgIi9sb2FkIiksIHBheWxvYWQpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgLyoqDQogICAgICAgICAgICogZGVsYXkgxJHhu4MgxJHhu6NpIGdyaWQgc2VsZWN0IGTDsm5nIMSR4bqndQ0KICAgICAgICAgICAqIE5NVFVBTjIgMDQuMTIuMjAyMQ0KICAgICAgICAgICAqLwogICAgICAgICAgaWYgKG1lLmlzU2VhcmNoaW5nKSB7CiAgICAgICAgICAgIG1lLmlzU2VhcmNoaW5nID0gZmFsc2U7CiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGlmIChtZS5zZWFyY2hCb3ggJiYgbWUuc2VhcmNoQm94LiRyZWZzLmlucHV0KSB7CiAgICAgICAgICAgICAgICBtZS5zZWFyY2hCb3guJHJlZnMuaW5wdXQuZm9jdXMoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIDIwMCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCgogICAgLyoqDQogICAgICogR+G7jWkgcmVxdWVzdCBsb2FkIHN1bW1hcnkNCiAgICAgKi8KICAgIHJlcXVlc3RMb2FkRGF0YVN1bW1hcnk6IGZ1bmN0aW9uIHJlcXVlc3RMb2FkRGF0YVN1bW1hcnkocGF5bG9hZCkgewogICAgICB2YXIgbWUgPSB0aGlzOwoKICAgICAgaWYgKG1lLmdyaWQgJiYgIW1lLmdyaWQuaXNHcmlkVHJlZSkgewogICAgICAgIG1lLiRzdG9yZS5kaXNwYXRjaCgiIi5jb25jYXQobWUubW9kdWxlLCAiL2xvYWRTdW1tYXJ5IiksIHBheWxvYWQpOwogICAgICB9CiAgICB9LAoKICAgIC8qKg0KICAgICAqIGRiY2xpY2sgYuG6o24gZ2hpIHRyw6puIGdyaWQNCiAgICAgKi8KICAgIGdyaWRSb3dEYkNsaWNrOiBmdW5jdGlvbiBncmlkUm93RGJDbGljayhyZWNvcmQsIGUpIHsKICAgICAgdGhpcy5lZGl0KHJlY29yZCk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIHPhu7Ega2nhu4duIOG6pW4gdsOgbyBjw6FjIGFjdGlvbiB0csOqbiBmb3JtDQogICAgICovCiAgICBidXR0b25DbGljazogZnVuY3Rpb24gYnV0dG9uQ2xpY2soY29tbWFuZCwgZSkge30sCgogICAgLyoqDQogICAgICogVGjDqm0NCiAgICAgKi8KICAgIGFkZDogZnVuY3Rpb24gYWRkKCkgewogICAgICB2YXIgbWUgPSB0aGlzOwoKICAgICAgaWYgKCFtZS5jaGVja0FjdGlvblBlcm1pc3Npb25BbGVydChtZS4kdCgiaTE4blBlcm1pc3Npb24uU3ViU3lzdGVtQ29kZS5Db2RlLkFERCIpKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHBhcmFtID0gbWUuZ2V0RGV0YWlsUGFyYW1ldGVyKG1lLmZvcm1EZXRhaWxOYW1lLCB0aGlzLiRtcy5lbnVtLkZvcm1TdGF0ZS5BZGQpOwogICAgICBtZS5zaG93RGV0YWlsKG1lLmZvcm1EZXRhaWxOYW1lLCB0aGlzLiRtcy5lbnVtLkZvcm1TdGF0ZS5BZGQsIHBhcmFtKTsKICAgIH0sCgogICAgLyoqDQogICAgICogU+G7rSBk4bulbmcgY2hvIHPhu7Ega2nhu4duIGRibGljayB2w6BvIGTDsm5nIHRyw6puIGdyaWQgxJHhu4Mgc2hvdyBmb3JtIHTGsMahbmcg4bupbmcNCiAgICAgKiAqLwogICAgZWRpdDogZnVuY3Rpb24gZWRpdChyZWNvcmQpIHsKICAgICAgdmFyIGFjdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogIkVESVQiOwogICAgICB2YXIgbWUgPSB0aGlzOwoKICAgICAgaWYgKCFtZS5jaGVja0FjdGlvblBlcm1pc3Npb25BbGVydChhY3Rpb24pKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgcGFyYW0gPSBtZS5nZXREZXRhaWxQYXJhbWV0ZXIobWUuZm9ybURldGFpbE5hbWUsIHRoaXMuJG1zLmVudW0uRm9ybVN0YXRlLkVkaXQsIHJlY29yZCk7CiAgICAgIG1lLnNob3dEZXRhaWwobWUuZm9ybURldGFpbE5hbWUsIHRoaXMuJG1zLmVudW0uRm9ybVN0YXRlLkVkaXQsIHBhcmFtLCB7CiAgICAgICAgc3VibWl0OiBmdW5jdGlvbiBzdWJtaXQoc2F2ZVJlc3VsdCwgc2F2ZVBhcmFtKSB7CiAgICAgICAgICBpZiAoc2F2ZVJlc3VsdC5TdWNjZXNzKSB7CiAgICAgICAgICAgIG1lLmFmdGVyU2F2ZUVkaXQocmVjb3JkLCBzYXZlUmVzdWx0LCBzYXZlUGFyYW0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIHB2ZHV5IDI3LzAyLzIwMjE6IHRow6ptIGThu68gbGnhu4d1IGNobyBtb2RlIHZpZXcNCiAgICAgKiAqLwogICAgdmlldzogZnVuY3Rpb24gdmlldyhyZWNvcmQpIHsKICAgICAgdmFyIGFjdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogIldBVENIIjsKICAgICAgdmFyIG1lID0gdGhpczsKCiAgICAgIGlmICghbWUuY2hlY2tBY3Rpb25QZXJtaXNzaW9uQWxlcnQoYWN0aW9uKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHBhcmFtID0gbWUuZ2V0RGV0YWlsUGFyYW1ldGVyKG1lLmZvcm1EZXRhaWxOYW1lLCB0aGlzLiRtcy5lbnVtLkZvcm1TdGF0ZS5WaWV3LCByZWNvcmQpOwogICAgICBtZS5zaG93RGV0YWlsKG1lLmZvcm1EZXRhaWxOYW1lLCB0aGlzLiRtcy5lbnVtLkZvcm1TdGF0ZS5WaWV3LCBwYXJhbSwgewogICAgICAgIHN1Ym1pdDogZnVuY3Rpb24gc3VibWl0KHNhdmVSZXN1bHQsIHNhdmVQYXJhbSkgewogICAgICAgICAgaWYgKHNhdmVSZXN1bHQuU3VjY2VzcykgewogICAgICAgICAgICBtZS5hZnRlclNhdmVWaWV3KHJlY29yZCwgc2F2ZVJlc3VsdCwgc2F2ZVBhcmFtKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBOaMOibiBi4bqjbiBi4bqjbiBnaGkNCiAgICAgKiAqLwogICAgZHVwbGljYXRlOiBmdW5jdGlvbiBkdXBsaWNhdGUocmVjb3JkKSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CgogICAgICBpZiAoIW1lLmNoZWNrQWN0aW9uUGVybWlzc2lvbkFsZXJ0KG1lLiR0KCJpMThuUGVybWlzc2lvbi5TdWJTeXN0ZW1Db2RlLkNvZGUuQUREIikpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgcGFyYW0gPSBtZS5nZXREZXRhaWxQYXJhbWV0ZXIobWUuZm9ybURldGFpbE5hbWUsIHRoaXMuJG1zLmVudW0uRm9ybVN0YXRlLkR1cGxpY2F0ZSwgcmVjb3JkKTsKICAgICAgbWUuc2hvd0RldGFpbChtZS5mb3JtRGV0YWlsTmFtZSwgdGhpcy4kbXMuZW51bS5Gb3JtU3RhdGUuRHVwbGljYXRlLCBwYXJhbSk7CiAgICB9LAogICAgcmVmcmVzaENsaWNrOiBmdW5jdGlvbiByZWZyZXNoQ2xpY2soKSB7CiAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBkcmlsbGRvd24ga2hpIGNsaWNrIHbDoG8gZ3JpZA0KICAgICAqICovCiAgICBkcmlsbGRvd25DbGljazogZnVuY3Rpb24gZHJpbGxkb3duQ2xpY2sobWV0YURhdGEpIHsKICAgICAgdmFyIG1lID0gdGhpczsKCiAgICAgIGlmIChtZXRhRGF0YS5kYXRhUm93KSB7CiAgICAgICAgbWUuZWRpdChtZXRhRGF0YS5kYXRhUm93KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBtZS4kdG9hc3QuZXJyb3IobWUuJHQoImkxOG5CYXNlRm9ybS5NZXNzYWdlLkVycm9yIikpOwogICAgICB9CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEBhdXRob3IgVFZMT0kgMjAuMDUuMjAyMQ0KICAgICAqIGRyaWxsZG93biB2w6BvIGNoaSB0aeG6v3Qga2hpIOG6pW4gdsOgbyBjw6FjIGPhu5l0IGPDsyBk4bqhbmcgxJHhuqFpIGRp4buHbiBjaG8gc+G7kSBuaGnhu4F1KE5oaeG7gXUgZMOybmcgY2hpIHRp4bq/dCkNCiAgICAgKiAqLwogICAgdmlld01vcmVEZXRhaWxzOiBmdW5jdGlvbiB2aWV3TW9yZURldGFpbHMobWV0YURhdGEpIHsKICAgICAgdmFyIG1lID0gdGhpczsKCiAgICAgIGlmIChtZXRhRGF0YS5kYXRhUm93KSB7CiAgICAgICAgbWUudmlldyhtZXRhRGF0YS5kYXRhUm93KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBtZS4kdG9hc3QuZXJyb3IobWUuJHQoImkxOG5CYXNlRm9ybS5NZXNzYWdlLkVycm9yIikpOwogICAgICB9CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFjDs2ENCiAgICAgKi8KICAgIGRlbGV0ZTogZnVuY3Rpb24gX2RlbGV0ZShyZWNvcmQsIHN1YikgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHZhciBtZSwgY29uZmlnTWVzc2FnZSwgYW5zd2VyLCB0ZW1wLCBkcm9wZWRDb2x1bW5zLCBfbG9vcCwgaSwgYXVkaXRpbmdMb2csIHBhcmFtLCByZXN1bHQ7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBtZSA9IF90aGlzMzsKCiAgICAgICAgICAgICAgICBpZiAobWUuY2hlY2tBY3Rpb25QZXJtaXNzaW9uQWxlcnQoc3ViICE9PSBudWxsICYmIHN1YiAhPT0gdm9pZCAwID8gc3ViIDogbWUuJHQoImkxOG5QZXJtaXNzaW9uLlN1YlN5c3RlbUNvZGUuQ29kZS5ERUxFVEUiKSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIGlmIChtZS52YWxpZGF0ZUJlZm9yZURlbGV0ZShyZWNvcmQsIHN1YikpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiBtZS5nZXREZWxldGVDb25maXJtTWVzc2FnZShyZWNvcmQpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICBjb25maWdNZXNzYWdlID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgcmV0dXJuIG1lLiRtcy5tc2dCb3guc2hvd1F1ZXN0aW9uKGNvbmZpZ01lc3NhZ2UpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgYW5zd2VyID0gX2NvbnRleHQzLnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKCEoYW5zd2VyID09ICJZZXMiKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0ZW1wID0ge307IC8vQuG7jyBi4bubdCBjw6FjIHRow7RuZyB0aW4gZ+G7rWkgbMOqbiBzdi4KCiAgICAgICAgICAgICAgICBkcm9wZWRDb2x1bW5zID0gbWUuZ2V0SWdub3JlZENvbHVtbnMoKTsKCiAgICAgICAgICAgICAgICBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGkpIHsKICAgICAgICAgICAgICAgICAgdmFyIGlzRHJvcGVkQ29sdW1uID0gZHJvcGVkQ29sdW1ucy5maW5kKGZ1bmN0aW9uIChfKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF8gPT0gaTsKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBpZiAoIWlzRHJvcGVkQ29sdW1uKSB7CiAgICAgICAgICAgICAgICAgICAgdGVtcFtpXSA9IHJlY29yZFtpXTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBmb3IgKGkgaW4gcmVjb3JkKSB7CiAgICAgICAgICAgICAgICAgIF9sb29wKGkpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGF1ZGl0aW5nTG9nID0gewogICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogTVNKc29uLnNlcmlhbGl6ZShtZS5nZW5lcmF0ZURlc2NyaXB0aW9uQXVkaXRpbmdMb2cocmVjb3JkKSksCiAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZTogbWUuYnVpbGRSZWZlcmVuY2UocmVjb3JkKSwKICAgICAgICAgICAgICAgICAgYWN0aW9uOiBtZS5hY3Rpb25BdWRpdGluZ0xvZywKICAgICAgICAgICAgICAgICAgZW50aXR5OiBtZS5nZXRFbnRpdHlUeXBlKCkgfHwgbWUubW9kdWxlLAogICAgICAgICAgICAgICAgICB0aW1lOiBuZXcgRGF0ZSgpCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgcGFyYW0gPSB7CiAgICAgICAgICAgICAgICAgIEVudGl0eTogW3RlbXBdLAogICAgICAgICAgICAgICAgICBCeVBhc3NWYWxpZGF0ZTogbnVsbCwKICAgICAgICAgICAgICAgICAgQXVkaXRpbmdMb2c6IE1TSnNvbi5zZXJpYWxpemUoYXVkaXRpbmdMb2cpLAogICAgICAgICAgICAgICAgICBUeXBlOiBtZS4kbXMuZW51bS5EZWxldGVUeXBlLlNpbmdsZQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHBhcmFtID0gbWUuY3VzdG9tRGVsZXRlUGFyYW0ocmVjb3JkLCBwYXJhbSk7CiAgICAgICAgICAgICAgICBtZS4kbXMuY29tbW9uRm4ubWFzaygpOwogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyMjsKICAgICAgICAgICAgICAgIHJldHVybiBtZS5yZXF1ZXN0RGVsZXRlRGF0YShyZWNvcmQsIHBhcmFtKTsKCiAgICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgICAgbWUuJG1zLmNvbW1vbkZuLnVubWFzaygpOwogICAgICAgICAgICAgICAgbWUuYWZ0ZXJEZWxldGUocmVjb3JkLCByZXN1bHQpOyAvL0xvZyBmaXJlYmFzZQogICAgICAgICAgICAgICAgLy8gbWUubG9nRGF0YUZpcmVCYXNlKCk7CgogICAgICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSkoKTsKICAgIH0sCgogICAgLyoqDQogICAgICogTOG6pXkgdGjDtG5nIHRpbiBsb2cgZmlyZWJhc2UNCiAgICAgKiBOVFRIQU5IMQ0KICAgICAqLwogICAgLy8gbG9nRGF0YUZpcmVCYXNlKCkgewogICAgLy8gICBjb25zdCBtZSA9IHRoaXM7CiAgICAvLyAgIHRyeSB7CiAgICAvLyAgICAgbGV0IG1lbnVOYW1lQ3VycmVudCA9IG51bGw7CiAgICAvLyAgICAgbGV0IHBhcmVudCA9IG1lLiRwYXJlbnQ7CiAgICAvLyAgICAgaWYgKG1lLiRyb3V0ZXIgfHwgbWUuJCRyb3V0ZXIpIHsKICAgIC8vICAgICAgIG1lbnVOYW1lQ3VycmVudCA9IG1lLiRyb3V0ZSA/IG1lLiRyb3V0ZS5uYW1lIDogbWUuJCRyb3V0ZS5uYW1lOwogICAgLy8gICAgIH0KICAgIC8vICAgICBlbHNlIHsKICAgIC8vICAgICAgIGlmIChwYXJlbnQgJiYgKHBhcmVudC4kcm91dGVyIHx8IHBhcmVudC4kJHJvdXRlcikpIHsKICAgIC8vICAgICAgICAgbWVudU5hbWVDdXJyZW50ID0gcGFyZW50LiRyb3V0ZXIgPyBwYXJlbnQuJHJvdXRlLm5hbWUgOiBwYXJlbnQuJCRyb3V0ZS5uYW1lOwogICAgLy8gICAgICAgfQogICAgLy8gICAgIH0KICAgIC8vICAgICBpZiAobWVudU5hbWVDdXJyZW50KSB7CiAgICAvLyAgICAgICBjb21tb25Gbi5sb2dEYXRhRmlyZUJhc2VVcGRhdGUobWVudU5hbWVDdXJyZW50LCBtZS5jb250ZXh0KTsKICAgIC8vICAgICB9CiAgICAvLyAgIH0KICAgIC8vICAgY2F0Y2ggKGV4KSB7CiAgICAvLyAgICAgY29uc29sZS5sb2coZXgpOwogICAgLy8gICB9CiAgICAvLyB9LAoKICAgIC8qKg0KICAgICAqIEfhu41pIHJlcXVlc3QgeMOzYQ0KICAgICAqIEByZXR1cm5zDQogICAgICovCiAgICByZXF1ZXN0RGVsZXRlRGF0YTogZnVuY3Rpb24gcmVxdWVzdERlbGV0ZURhdGEocmVjb3JkLCBwYXJhbSkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHZhciBtZTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgbWUgPSBfdGhpczQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gbWUuJHN0b3JlLmRpc3BhdGNoKCIiLmNvbmNhdChfdGhpczQubW9kdWxlLCAiL2RlbGV0ZSIpLCBwYXJhbSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDQuc2VudCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCk7CiAgICAgIH0pKSgpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBvdmVycmlkZWFibGUgxJHhu4MgY2hlY2sgbeG7mXQgdsOgaSBjYXNlIHZhbGlkYXRlIMSRxrDhu6NjIG5nYXkgdHLDqm4gY2xpZW50DQogICAgICogQHJldHVybnMNCiAgICAgKiBURE5HSElBIDI3LzEwLzIwMjENCiAgICAgKi8KICAgIHZhbGlkYXRlQmVmb3JlRGVsZXRlOiBmdW5jdGlvbiB2YWxpZGF0ZUJlZm9yZURlbGV0ZShyZWNvcmRzKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBAb3ZlcnJpZGFibGUgVHLhuqMgduG7gSBuaOG7r25nIHRyxrDhu51uZyBraMO0bmcgbXXhu5FuIGfhu61pIGzDqm4gc2VydmUgxJHhu4MgeMOzYQ0KICAgICAqIEBhdXRob3IgVFZMb2kgMTkuMDYuMjAyMQ0KICAgICAqLwogICAgZ2V0SWdub3JlZENvbHVtbnM6IGZ1bmN0aW9uIGdldElnbm9yZWRDb2x1bW5zKCkgewogICAgICB2YXIgbWUgPSB0aGlzOyAvL2RlZmF1bHQgMSBz4buRIGPhu5l0IG3hurdjIMSR4buLbmgga2jDtG5nIGfhu61pIGzDqm4uCgogICAgICB2YXIgY29sdW1uc0lnbm9yZWQgPSBbInBhcmVudE5vZGUiLCAiaXNIaWRlIiwgImlzU2VsZWN0ZWQiLCAibGV2ZWwiLCAiX192S2V5VmFsdWUiLCAiX2lzU2VsZWN0ZWRNdWx0aXBsZSIsICJleHBhbmRlZCJdOwogICAgICB2YXIgY3VzdG9tSWdub3JlZENvbHVtbnMgPSBtZS5nZXRDdXN0b21JZ25vcmVkQ29sdW1uc0JlZm9yZURlbGV0ZSgpOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY3VzdG9tSWdub3JlZENvbHVtbnMpICYmIGN1c3RvbUlnbm9yZWRDb2x1bW5zLmxlbmd0aCA+IDApIHsKICAgICAgICBjdXN0b21JZ25vcmVkQ29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICBjb2x1bW5zSWdub3JlZC5wdXNoKGl0ZW0pOwogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gY29sdW1uc0lnbm9yZWQ7CiAgICB9LAogICAgLy9DdXN0b21Db2x1bW5zIGtvIGfhu61pIGzDqm4KICAgIGdldEN1c3RvbUlnbm9yZWRDb2x1bW5zQmVmb3JlRGVsZXRlOiBmdW5jdGlvbiBnZXRDdXN0b21JZ25vcmVkQ29sdW1uc0JlZm9yZURlbGV0ZSgpIHsKICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgcmV0dXJuIFtdOwogICAgfSwKCiAgICAvKioNCiAgICAgKiB0aGFtIGNoaeG6v3Ugbmjhuq10IGvDvSAobMawdSBk4bqhbmcganNvbiA6IHtrZXk6IGtleSwgY29kZTogY29kZSwgbmFtZTogbmFtZX0pDQogICAgICoga2V5OiBraMOzYSBjaMOtbmggY+G7p2EgYuG6o25nIG1vZHVsZSwgZMO5bmcgxJHhu4MgZHJpbGRvd24ga2hpIGNsaWNrIHbDoG8NCiAgICAgKiBjb2RlLCBuYW1lOiBtw6MsIHTDqm4gxJHhu4MgaGnhu4N1IHRo4buLIOG7nyBj4buZdCB0aGFtIGNoaeG6v3Uga2hpIHhlbSBsb2c6IHbDrSBk4bulOiBRdeG6oXQgxJFp4buHbiAoUUQwMDAwMSkNCiAgICAgKi8KICAgIGJ1aWxkUmVmZXJlbmNlOiBmdW5jdGlvbiBidWlsZFJlZmVyZW5jZShyZWNvcmRzKSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgIHZhciBmaWVsZCA9IHRoaXMuJHN0b3JlLnN0YXRlW21lLm1vZHVsZV0uX2NvbmZpZy5maWVsZDsKCiAgICAgIGlmIChmaWVsZCkgewogICAgICAgIGlmIChBcnJheS5pc0FycmF5KHJlY29yZHMpKSB7CiAgICAgICAgICB2YXIgcmVmZXJlbmNlID0gW107CiAgICAgICAgICByZWNvcmRzLmZvckVhY2goZnVuY3Rpb24gKHJlY29yZCkgewogICAgICAgICAgICByZWZlcmVuY2UucHVzaCh7CiAgICAgICAgICAgICAga2V5OiByZWNvcmRbZmllbGQua2V5XSwKICAgICAgICAgICAgICBjb2RlOiByZWNvcmRbZmllbGQuY29kZV0sCiAgICAgICAgICAgICAgbmFtZTogcmVjb3JkW2ZpZWxkLm5hbWVdCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gTVNKc29uLnNlcmlhbGl6ZShyZWZlcmVuY2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gTVNKc29uLnNlcmlhbGl6ZSh7CiAgICAgICAgICAgIGtleTogcmVjb3Jkc1tmaWVsZC5rZXldLAogICAgICAgICAgICBjb2RlOiByZWNvcmRzW2ZpZWxkLmNvZGVdLAogICAgICAgICAgICBuYW1lOiByZWNvcmRzW2ZpZWxkLm5hbWVdCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0sCgogICAgLyoqDQogICAgICogU2luaCBtw7QgdOG6oyBj4bunYSBuaOG6rXQga8O9DQogICAgICogQ3JlYXRlZEJ5OiBubmxhbSAyNC8wMy8yMDIxDQogICAgICovCiAgICBnZW5lcmF0ZURlc2NyaXB0aW9uQXVkaXRpbmdMb2c6IGZ1bmN0aW9uIGdlbmVyYXRlRGVzY3JpcHRpb25BdWRpdGluZ0xvZyhyZWNvcmRzKSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgIHZhciBsaXN0RGVzY3JpcHRpb24gPSB7CiAgICAgICAgbWFzdGVyOiBbXQogICAgICB9OwogICAgICB2YXIgZmllbGQgPSB0aGlzLiRzdG9yZS5zdGF0ZVttZS5tb2R1bGVdLl9jb25maWcuZmllbGQ7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShyZWNvcmRzKSkgewogICAgICAgIHJlY29yZHMuZm9yRWFjaChmdW5jdGlvbiAocmVjb3JkKSB7CiAgICAgICAgICB2YXIgb2JqRGVzY3JpcHRpb24gPSB7fTsKICAgICAgICAgIG9iakRlc2NyaXB0aW9uW2ZpZWxkLmNvZGVdID0gcmVjb3JkW2ZpZWxkLmNvZGVdOyAvL3tuZXdWYWx1ZTptZS5jdXJyZW50SXRlbVtmaWVsZC5jb2RlXSwgc3dpdGNoQ2FwdGlvbjogbWUuc3dpdGNoQ2FwdGlvbi5tYXN0ZXJbZmllbGQuY29kZV19OwoKICAgICAgICAgIG9iakRlc2NyaXB0aW9uW2ZpZWxkLm5hbWVdID0gcmVjb3JkW2ZpZWxkLm5hbWVdOyAvL3tuZXdWYWx1ZTptZS5jdXJyZW50SXRlbVtmaWVsZC5uYW1lXSwgc3dpdGNoQ2FwdGlvbjogbWUuc3dpdGNoQ2FwdGlvbi5tYXN0ZXJbZmllbGQubmFtZV19OwoKICAgICAgICAgIGlmIChmaWVsZC5xdWFudGl0eSkgewogICAgICAgICAgICBvYmpEZXNjcmlwdGlvbltmaWVsZC5xdWFudGl0eV0gPSByZWNvcmRbZmllbGQucXVhbnRpdHldOyAvL3tuZXdWYWx1ZTptZS5jdXJyZW50SXRlbVtmaWVsZC5xdWFudGl0eV0gfHwgMSwgc3dpdGNoQ2FwdGlvbjogbWUuc3dpdGNoQ2FwdGlvbi5tYXN0ZXJbZmllbGQucXVhbnRpdHldfTsKICAgICAgICAgIH0KCiAgICAgICAgICBsaXN0RGVzY3JpcHRpb24ubWFzdGVyLnB1c2gob2JqRGVzY3JpcHRpb24pOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBvYmpEZXNjcmlwdGlvbiA9IHt9OwogICAgICAgIG9iakRlc2NyaXB0aW9uW2ZpZWxkLmNvZGVdID0gcmVjb3Jkc1tmaWVsZC5jb2RlXTsgLy97bmV3VmFsdWU6bWUuY3VycmVudEl0ZW1bZmllbGQuY29kZV0sIHN3aXRjaENhcHRpb246IG1lLnN3aXRjaENhcHRpb24ubWFzdGVyW2ZpZWxkLmNvZGVdfTsKCiAgICAgICAgb2JqRGVzY3JpcHRpb25bZmllbGQubmFtZV0gPSByZWNvcmRzW2ZpZWxkLm5hbWVdOyAvL3tuZXdWYWx1ZTptZS5jdXJyZW50SXRlbVtmaWVsZC5uYW1lXSwgc3dpdGNoQ2FwdGlvbjogbWUuc3dpdGNoQ2FwdGlvbi5tYXN0ZXJbZmllbGQubmFtZV19OwoKICAgICAgICBpZiAoZmllbGQucXVhbnRpdHkpIHsKICAgICAgICAgIG9iakRlc2NyaXB0aW9uW2ZpZWxkLnF1YW50aXR5XSA9IHJlY29yZHNbZmllbGQucXVhbnRpdHldOyAvL3tuZXdWYWx1ZTptZS5jdXJyZW50SXRlbVtmaWVsZC5xdWFudGl0eV0gfHwgMSwgc3dpdGNoQ2FwdGlvbjogbWUuc3dpdGNoQ2FwdGlvbi5tYXN0ZXJbZmllbGQucXVhbnRpdHldfTsKICAgICAgICB9CgogICAgICAgIGxpc3REZXNjcmlwdGlvbi5tYXN0ZXIucHVzaChvYmpEZXNjcmlwdGlvbik7CiAgICAgIH0KCiAgICAgIHJldHVybiBsaXN0RGVzY3JpcHRpb247CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEzhuqV5IGPDonUgdGjDtG5nIGLDoW8ga2hpIHjDs2ENCiAgICAgKi8KICAgIGdldERlbGV0ZUNvbmZpcm1NZXNzYWdlOiBmdW5jdGlvbiBnZXREZWxldGVDb25maXJtTWVzc2FnZShyZWNvcmRzKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7CiAgICAgICAgdmFyIG1lLCBtb2R1bGVOYW1lLCB0YXJnZXROYW1lLCBtZXMsIGRlbGV0ZU11bHRpTXNnLCByZWNvcmQsIGRlbGV0ZU1zZzsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgbWUgPSBfdGhpczU7CiAgICAgICAgICAgICAgICBtb2R1bGVOYW1lID0gbWUuZ2V0TW9kdWxlTmFtZSgpIHx8ICIiOwogICAgICAgICAgICAgICAgdGFyZ2V0TmFtZSA9ICIiOwogICAgICAgICAgICAgICAgbWVzID0gIiI7CgogICAgICAgICAgICAgICAgaWYgKHJlY29yZHMubGVuZ3RoID4gMSkgewogICAgICAgICAgICAgICAgICBkZWxldGVNdWx0aU1zZyA9IG1lLmdldERlbGV0ZU11bHRpTXNnKCk7CiAgICAgICAgICAgICAgICAgIG1lcyA9IGRlbGV0ZU11bHRpTXNnLmZvcm1hdChyZWNvcmRzLmxlbmd0aCA+IDkgPyByZWNvcmRzLmxlbmd0aCA6ICIwIiArIHJlY29yZHMubGVuZ3RoLCBtb2R1bGVOYW1lKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHJlY29yZCA9IHJlY29yZHM7CgogICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShyZWNvcmRzKSkgewogICAgICAgICAgICAgICAgICAgIHJlY29yZCA9IHJlY29yZHNbMF07CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGlmIChyZWNvcmQpIHsKICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lID0gbWUuZ2V0RGVsZXRlU2luZ2xlTWVzQ29udGVudChyZWNvcmQpOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBkZWxldGVNc2cgPSBtZS5nZXREZWxldGVNc2cocmVjb3Jkcyk7CiAgICAgICAgICAgICAgICAgIG1lcyA9IGRlbGV0ZU1zZy5mb3JtYXQobWUuJG1zLmNvbW1vbkZuLmVuY29kZUhUTUwodGFyZ2V0TmFtZSkpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iLCB7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiBtZS4kdCgiaTE4bkJhc2VGb3JtLk1lc3NhZ2UuQ29uZmlybURlbGV0ZVRpdGxlIikuZm9ybWF0KG1vZHVsZU5hbWUpLAogICAgICAgICAgICAgICAgICBtZXNzYWdlOiBtZXMKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICB9KSkoKTsKICAgIH0sCgogICAgLyoqDQogICAgICogQ3VzdG9tIGPDonUgbuG7mWkgZHVuZyB4w7NhIG5oaeG7gXUNCiAgICAgKiBOVEJBTzogMjUuMTEuMjAyMQ0KICAgICAqIEByZXR1cm5zDQogICAgICovCiAgICBnZXREZWxldGVNdWx0aU1zZzogZnVuY3Rpb24gZ2V0RGVsZXRlTXVsdGlNc2coKSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgIHJldHVybiBtZS4kdCgiaTE4bkJhc2VGb3JtLk1lc3NhZ2UuQ29uZmlybURlbGV0ZU11dGlUaXRsZUNlZ292Iik7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEN1c3RvbSBjw6J1IG7hu5lpIGR1bmcgeMOzYSDEkcahbg0KICAgICAqIE5UQkFPOiAyNS4xMS4yMDIxDQogICAgICogQHJldHVybnMNCiAgICAgKi8KICAgIGdldERlbGV0ZU1zZzogZnVuY3Rpb24gZ2V0RGVsZXRlTXNnKHJlY29yZHMpIHsKICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgcmV0dXJuIG1lLiR0KCJpMThuQmFzZUZvcm0uTWVzc2FnZS5Db25maXJtRGVsZXRlU2hvcnQiKTsKICAgIH0sCgogICAgLyoqDQogICAgICogTOG6pXkgbuG7mWkgZHVuZyB4w7NhDQogICAgICovCiAgICBnZXREZWxldGVTaW5nbGVNZXNDb250ZW50OiBmdW5jdGlvbiBnZXREZWxldGVTaW5nbGVNZXNDb250ZW50KHJlY29yZCkgewogICAgICB2YXIgbWUgPSB0aGlzOwogICAgICByZXR1cm4gcmVjb3JkW21lLiRzdG9yZS5zdGF0ZVttZS5tb2R1bGVdLl9jb25maWcuZmllbGQubmFtZV0gfHwgcmVjb3JkW21lLiRzdG9yZS5zdGF0ZVttZS5tb2R1bGVdLl9jb25maWcuZmllbGQuY29kZV07CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEzhuqV5IHTDqm4gxJHhu5FpIHTGsOG7o25nIGPhu6dhIGZvcm0NCiAgICAgKi8KICAgIGdldE1vZHVsZU5hbWU6IGZ1bmN0aW9uIGdldE1vZHVsZU5hbWUoKSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgIHJldHVybiBtZS4kdCgiaTE4bkNvbW1vbi5tb2R1bGUuIiArIG1lLm1vZHVsZS50b0xvd2VyQ2FzZSgpKTsKICAgIH0sCgogICAgLyoqDQogICAgICogWOG7rSBsw70gc2F1IGtoaSB4w7NhDQogICAgICovCiAgICBhZnRlckRlbGV0ZTogZnVuY3Rpb24gYWZ0ZXJEZWxldGUocmVjb3JkLCByZXN1bHQpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgICAgICB2YXIgbWUsIGRlbGV0ZVJlY29yZCwgX21lJGdldEZpZWxkcywgQ09ERSwgbW9kdWxlTmFtZSwgZmllbGQsIGxpc3RBcmlzZW5kLCBjb25maWdNZXNzYWdlLCBhbnN3ZXIsIGlzQXJpc2VNdWx0aSwgbmFtZSwgb2JqLCBpbmFjdGl2ZUFyaXNlLCBkZWxldGVOb0FyaXNlLCByZWNvcmRzSW5hY3RpdmUsIHJlY29yZHNEZWxldGUsIGtleUZpZWxkOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgbWUgPSBfdGhpczY7CgogICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuU3VjY2VzcykgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIGNsb25lIGzhuqFpIGdpw6EgdHLhu4sgeMOzYSBkw7luZyBjaG8gdmnhu4djIGN1c3RvbQogICAgICAgICAgICAgICAgLy8gTlRCQU86IDA3LjExLjIwMjEKICAgICAgICAgICAgICAgIGRlbGV0ZVJlY29yZCA9IF8uY2xvbmUocmVjb3JkKTsKICAgICAgICAgICAgICAgIG1lLiR0b2FzdC5zdWNjZXNzKG1lLiR0KCJpMThuQmFzZUZvcm0uTWVzc2FnZS5EZWxldGVTdWNjZXNzIikpOwogICAgICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgICAgICogbuG6v3UgeG/DoSBi4bqjbiBnaGkgxJHGsOG7o2MgdMOtY2ggdGjDrCDEkWFuZyBraMO0bmcgdOG7sSBj4bqtcCBuaOG6rXQg4bufIHNlbGVjdGVkDQogICAgICAgICAgICAgICAgICogbsOqbiBwaOG6o2kgdGjhu7FjIGhp4buHbiB4b8OhIGto4buPaSBzZWxlY3RlZCAoY2jhu4kgdOG7sSDEkeG7mW5nIGtoaSB4b8OhIHRyw6puIGTDsm5nIGPhu6dhIGdyaWRFZGl0b3IpDQogICAgICAgICAgICAgICAgICogYuG6rXQgY2hhbmdlIHbDoG8gY8OhYyBi4bqjbiBnaGkgY8OybiDEkcaw4bujYyB0w61jaA0KICAgICAgICAgICAgICAgICAqIE5NVFVBTjIgMjguMTEuMjAyMQ0KICAgICAgICAgICAgICAgICAqLwoKICAgICAgICAgICAgICAgIG1lLnNlbGVjdGVkLnJlbW92ZShyZWNvcmQpOwogICAgICAgICAgICAgICAgbWUuc2VsZWN0aW9uQ2hhbmdlKG1lLnNlbGVjdGVkKTsKICAgICAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICAgICAqIEjDoG0gY3VzdG9tIHjhu60gbMO9IHRow6ptDQogICAgICAgICAgICAgICAgICogTlRCQU8gMDIuMTEuMjAyMQ0KICAgICAgICAgICAgICAgICAqLwoKICAgICAgICAgICAgICAgIG1lLmN1c3RvbUFmdGVyRGVsZXRlKGRlbGV0ZVJlY29yZCwgcmVzdWx0KTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNjE7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgICAgICogU+G7rWEgbOG7l2kga2hpIHjDs2Egbmhp4buBdSBi4bqjbiBnaGkNCiAgICAgICAgICAgICAgICAgKiBNb2RpZml5Qnk6IE5UQW5oICgwOS8wMy8yMDIxKQ0KICAgICAgICAgICAgICAgICAqIE1vZGlmaXlCeTogTlRUSEFOSDEgKDIwLzExLzIwMjEpDQogICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICBDT0RFID0gbWUuJG1zLmVudW0uU2VydmljZVJlc3BvbnNlQ29kZTsKICAgICAgICAgICAgICAgIG1vZHVsZU5hbWUgPSBtZS5nZXRNb2R1bGVOYW1lKCksIGZpZWxkID0gKF9tZSRnZXRGaWVsZHMgPSBtZS5nZXRGaWVsZHMoKSkgIT09IG51bGwgJiYgX21lJGdldEZpZWxkcyAhPT0gdm9pZCAwID8gX21lJGdldEZpZWxkcyA6IF90aGlzNi4kc3RvcmUuc3RhdGVbbWUubW9kdWxlXS5fY29uZmlnLmZpZWxkLCBsaXN0QXJpc2VuZCA9IFtdOyAvL0Jp4bq/biDEkcOhbmggZOG6pXUgbmhp4buBdSBi4bqjbiBnaGkgcGjDoXQgc2luaAogICAgICAgICAgICAgICAgLy8gTmhp4buBdSBi4bqjbiDEkcOjIGPDsyBwaMOhdCBzaW5oCgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5EYXRhICYmIHJlc3VsdC5EYXRhLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgICAgICAgaXNBcmlzZU11bHRpID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICAgIGlmIChmaWVsZCkgewogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5EYXRhLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgICAgIC8vIGzhuqV5IHVuaXF1ZSBob+G6t2MgbmFtZQogICAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBmaWVsZC51bmlxdWUgfHwgZmllbGQubmFtZTsKICAgICAgICAgICAgICAgICAgICAgIGxpc3RBcmlzZW5kLnB1c2goZWxlbWVudC5FbnRpdHlbbmFtZV0pOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IC8vIDEgYuG6o24gZ2hpIGPDsyBwaMOhdCBzaW5oOgogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgIGlzQXJpc2VNdWx0aSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICBuYW1lID0gZmllbGQudW5pcXVlIHx8IGZpZWxkLm5hbWU7CiAgICAgICAgICAgICAgICAgIG9iaiA9IHJlc3VsdC5EYXRhWzBdOwogICAgICAgICAgICAgICAgICBsaXN0QXJpc2VuZC5wdXNoKG9iai5FbnRpdHlbbmFtZV0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni50MCA9IHJlc3VsdC5Db2RlOwogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSBfY29udGV4dDYudDAgPT09IENPREUuRGVsZXRlTXVsdGlBcmlzZW5lZCA/IDE1IDogX2NvbnRleHQ2LnQwID09PSBDT0RFLkFyaXNlbmVkID8gMzcgOiBfY29udGV4dDYudDAgPT09IENPREUuUGFydEludmFsaWREYXRhID8gNDcgOiA1NTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgaWYgKCFmaWVsZC5pc0luYWN0aXZlQW5kRGVsZXRlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMzU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vQ2jhu4kgdGjDtG5nIGLDoW8gbmfhu6tuZyBz4butIGThu6VuZyB2w6AgeMOzYSB24bubaSBjw6FjIG3DoG4gZGFuaCBt4bulYwogICAgICAgICAgICAgICAgY29uZmlnTWVzc2FnZSA9IG1lLmdldEFyaXNlQ29uZmlybU1lc2FnZShtb2R1bGVOYW1lLCBsaXN0QXJpc2VuZCwgQ09ERS5EZWxldGVNdWx0aUFyaXNlbmVkKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTk7CiAgICAgICAgICAgICAgICByZXR1cm4gbWUuJG1zLm1zZ0JveC5zaG93UXVlc3Rpb24oY29uZmlnTWVzc2FnZSk7CgogICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICBhbnN3ZXIgPSBfY29udGV4dDYuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoIShhbnN3ZXIgPT0gIlllcyIpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMzM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIGvhur90IHF14bqjIHjDs2EKICAgICAgICAgICAgICAgIC8vTmfhu6tuZyBz4butIGThu6VuZyBi4bqjbiBnaGkgcGjDoXQgc2luaAogICAgICAgICAgICAgICAgcmVjb3Jkc0luYWN0aXZlID0gW107IC8vbeG6o25nIGLhuqNuIGdoaSBj4bqnbiBuZ+G7q25nIHPhu60gZOG7pW5nCgogICAgICAgICAgICAgICAgcmVzdWx0LkRhdGEuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgICAgICAgICByZWNvcmRzSW5hY3RpdmUucHVzaChlbGVtZW50LkVudGl0eSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjU7CiAgICAgICAgICAgICAgICByZXR1cm4gbWUuc2V0SW5hY3RpdmVBcmlzZShyZWNvcmRzSW5hY3RpdmUpOwoKICAgICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgICAgaW5hY3RpdmVBcmlzZSA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgICAgLy9Yw7NhIGLhuqNuIGdoaSBraMO0bmcgcGjDoXQgc2luaAogICAgICAgICAgICAgICAgcmVjb3Jkc0RlbGV0ZSA9IFtdOyAvL23huqNuZyBi4bqjbiBnaGkgY+G6p24geMOzYQoKICAgICAgICAgICAgICAgIGlmICghKHJlY29yZC5sZW5ndGggPiByZWNvcmRzSW5hY3RpdmUubGVuZ3RoKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDMyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvL07hur91IGPDsyBi4bqjbiBnaGkga2jDtG5nIHBow6F0IHNpbmggdGjDrCBtcyB4w7NhCiAgICAgICAgICAgICAgICByZWNvcmQuZmlsdGVyKGZ1bmN0aW9uIChpdGVtUmVjb3JkKSB7CiAgICAgICAgICAgICAgICAgIHZhciByZWNvcmREdXBsaWNhdGUgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgcmVjb3Jkc0luYWN0aXZlLmZpbHRlcihmdW5jdGlvbiAoaXRlbVJlY29yZHNJbmFjdGl2ZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChpdGVtUmVjb3Jkc0luYWN0aXZlW2ZpZWxkLmtleV0gPT0gaXRlbVJlY29yZFtmaWVsZC5rZXldKSB7CiAgICAgICAgICAgICAgICAgICAgICByZWNvcmREdXBsaWNhdGUgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBpZiAoIXJlY29yZER1cGxpY2F0ZSkgewogICAgICAgICAgICAgICAgICAgIHJlY29yZHNEZWxldGUucHVzaChpdGVtUmVjb3JkKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDMxOwogICAgICAgICAgICAgICAgcmV0dXJuIG1lLmRlbGV0ZU11dGlSb3dzTm9Db25maXJtKHJlY29yZHNEZWxldGUpOwoKICAgICAgICAgICAgICBjYXNlIDMxOgogICAgICAgICAgICAgICAgZGVsZXRlTm9BcmlzZSA9IF9jb250ZXh0Ni5zZW50OwoKICAgICAgICAgICAgICBjYXNlIDMyOgogICAgICAgICAgICAgICAgLy9TaG93IHRvYXN0IHRow7RuZyBiw6FvCiAgICAgICAgICAgICAgICBpZiAocmVjb3Jkc0RlbGV0ZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgIC8vTmfhu6tuZyBz4butIGThu6VuZyB2w6AgeMOzYQogICAgICAgICAgICAgICAgICBpZiAoaW5hY3RpdmVBcmlzZS5TdWNjZXNzICYmIGRlbGV0ZU5vQXJpc2UuU3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgIG1lLiR0b2FzdC5zdWNjZXNzKG1lLiR0KCJpMThuQmFzZUZvcm0uU2F2ZVN1Y2Nlc3NNZXNzYWdlIikpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIG1lLiR0b2FzdC5lcnJvcihtZS4kdCgiaTE4bkJhc2VGb3JtLlNhdmVFcnJvck1lc3NhZ2UiKSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIC8vQ2jhu4kgbmfhu6tuZyBz4butIGThu6VuZwogICAgICAgICAgICAgICAgICBpZiAoaW5hY3RpdmVBcmlzZS5TdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgbWUuJHRvYXN0LnN1Y2Nlc3MobWUuJHQoImkxOG5CYXNlRm9ybS5TYXZlU3VjY2Vzc01lc3NhZ2UiKSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgbWUuJHRvYXN0LmVycm9yKG1lLiR0KCJpMThuQmFzZUZvcm0uU2F2ZUVycm9yTWVzc2FnZSIpKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDMzOgogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAzNjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDM1OgogICAgICAgICAgICAgICAgbWUuJG1zLm1zZ0JveC5zaG93V2FybmluZyhtZS4kdCgiaTE4bkJhc2VGb3JtLlZhbGlkYXRlLkNhbk5vdERlbGV0ZUFyaXNlIikpOwoKICAgICAgICAgICAgICBjYXNlIDM2OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoImJyZWFrIiwgNTgpOwoKICAgICAgICAgICAgICBjYXNlIDM3OgogICAgICAgICAgICAgICAgaWYgKCFmaWVsZC5pc0luYWN0aXZlQW5kRGVsZXRlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vQ2jhu4kgdGjDtG5nIGLDoW8gbmfhu6tuZyBz4butIGThu6VuZyB2w6AgeMOzYSB24bubaSBjw6FjIG3DoG4gZGFuaCBt4bulYwogICAgICAgICAgICAgICAgY29uZmlnTWVzc2FnZSA9IG1lLmdldEFyaXNlQ29uZmlybU1lc2FnZShtb2R1bGVOYW1lLCBsaXN0QXJpc2VuZCwgQ09ERS5BcmlzZW5lZCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDQxOwogICAgICAgICAgICAgICAgcmV0dXJuIG1lLiRtcy5tc2dCb3guc2hvd1F1ZXN0aW9uKGNvbmZpZ01lc3NhZ2UpOwoKICAgICAgICAgICAgICBjYXNlIDQxOgogICAgICAgICAgICAgICAgYW5zd2VyID0gX2NvbnRleHQ2LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKGFuc3dlciA9PSAiWWVzIikgewogICAgICAgICAgICAgICAgICAvL05n4burbmcgc+G7rSBk4bulbmcgYuG6o24gZ2hpIHBow6F0IHNpbmgKICAgICAgICAgICAgICAgICAgbWUuc2V0QWN0aXZlTXV0aVJvd3MocmVzdWx0LkRhdGFbMF0uRW50aXR5LCAiaW5hY3RpdmUiKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDQ2OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNDU6CiAgICAgICAgICAgICAgICBtZS4kbXMubXNnQm94LnNob3dXYXJuaW5nKG1lLiR0KCJpMThuQmFzZUZvcm0uVmFsaWRhdGUuQ2FuTm90RGVsZXRlQXJpc2UiKSk7CgogICAgICAgICAgICAgIGNhc2UgNDY6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgiYnJlYWsiLCA1OCk7CgogICAgICAgICAgICAgIGNhc2UgNDc6CiAgICAgICAgICAgICAgICBpZiAoIWlzQXJpc2VNdWx0aSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDUyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBtZS4kbXMubXNnQm94LnNob3dXYXJuaW5nKG1lLiR0KCJpMThuQmFzZUZvcm0uVmFsaWRhdGUuRXJyb3JEZWxldGVNdWx0aSIpKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJicmVhayIsIDU4KTsKCiAgICAgICAgICAgICAgY2FzZSA1MjoKICAgICAgICAgICAgICAgIC8vbWUuJHRvYXN0LmVycm9yKG1lLiR0KCJpMThuQmFzZUZvcm0uVmFsaWRhdGUuTmV3TWVzc2FnZURlbGV0ZSIpLmZvcm1hdChtb2R1bGVOYW1lLCBjb2RlcykpOwogICAgICAgICAgICAgICAgbWUuJG1zLm1zZ0JveC5zaG93V2FybmluZyhtZS4kdCgiaTE4bkJhc2VGb3JtLlZhbGlkYXRlLkVycm9yRGVsZXRlTXVsdGkiKSk7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5EYXRhKSB7CiAgICAgICAgICAgICAgICAgIGtleUZpZWxkID0gbWUuJHN0b3JlLnN0YXRlW21lLm1vZHVsZV0uX2NvbmZpZy5maWVsZC5rZXk7CiAgICAgICAgICAgICAgICAgIHJlY29yZC5mb3JFYWNoKGZ1bmN0aW9uIChpKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LkRhdGEuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKGlba2V5RmllbGRdICE9IGl0ZW0uRW50aXR5W2tleUZpZWxkXSAmJiBpW2tleUZpZWxkXSkgewogICAgICAgICAgICAgICAgICAgICAgICBtZS5ncmlkLmRhdGF4LnJlbW92ZShpKTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IC8vIHJlY29yZCA9IFtdOwogICAgICAgICAgICAgICAgLy9tZS5zZWxlY3Rpb25DaGFuZ2UocmVjb3JkKTsKICAgICAgICAgICAgICAgIC8vIG1lLnNlbGVjdGVkID0gW107CiAgICAgICAgICAgICAgICAvL21lLnJlbG9hZCgpOwoKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgiYnJlYWsiLCA1OCk7CgogICAgICAgICAgICAgIGNhc2UgNTU6CiAgICAgICAgICAgICAgICBpZiAoIWlzQXJpc2VNdWx0aSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDU4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBtZS4kbXMubXNnQm94LnNob3dXYXJuaW5nKG1lLiR0KCJpMThuQmFzZUZvcm0uVmFsaWRhdGUuRXJyb3JEZWxldGVNdWx0aSIpKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJicmVhayIsIDU4KTsKCiAgICAgICAgICAgICAgY2FzZSA1ODoKICAgICAgICAgICAgICAgIHJlY29yZCA9IFtdOwogICAgICAgICAgICAgICAgbWUuc2VsZWN0ZWQgPSBbXTsKICAgICAgICAgICAgICAgIG1lLnJlbG9hZCgpOwoKICAgICAgICAgICAgICBjYXNlIDYxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU2KTsKICAgICAgfSkpKCk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEPDonUgdGjDtG5nIGLDoW8ga2hpIGPDsyBwaMOhdCBzaW5oIGThu68gbGnhu4d1DQogICAgICogTlRUSEFOSDENCiAgICAgKi8KICAgIGdldEFyaXNlQ29uZmlybU1lc2FnZTogZnVuY3Rpb24gZ2V0QXJpc2VDb25maXJtTWVzYWdlKG1vZHVsZU5hbWUsIGxpc3RBcmlzZW5kLCBjb2RlKSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgIHZhciBDT0RFID0gbWUuJG1zLmVudW0uU2VydmljZVJlc3BvbnNlQ29kZTsKICAgICAgdmFyIHRpdGxlTmFtZSA9IG1lLiR0KCJpMThuQmFzZUZvcm0uTWVzc2FnZS5Db25maXJtRGVsZXRlVGl0bGUiKS5mb3JtYXQobW9kdWxlTmFtZSksCiAgICAgICAgICBtZXMsCiAgICAgICAgICBtZXNMaXN0QXJpc2U7IC8vQnVpbGQgY8OidSB0aMO0bmcgYsOhbwoKICAgICAgbWVzTGlzdEFyaXNlID0gbGlzdEFyaXNlbmQubGVuZ3RoID4gMiA/ICI8Yj4iLmNvbmNhdChsaXN0QXJpc2VuZFswXSwgIjwvYj4sIDxiPiIpLmNvbmNhdChsaXN0QXJpc2VuZFsxXSwgIjwvYj4gdlx4RTAgPGI+IikuY29uY2F0KGxpc3RBcmlzZW5kLmxlbmd0aCAtIDIsICI8L2I+ICIpLmNvbmNhdChtb2R1bGVOYW1lLCAiIGtoXHhFMWMiKSA6ICI8Yj4iLmNvbmNhdChsaXN0QXJpc2VuZC5qb2luKCI8L2I+LCA8Yj4iKSwgIjwvYj4iKTsKICAgICAgbWVzID0gbWUuZ2V0QXJpc2VNZXNzYWdlKGNvZGUsIGxpc3RBcmlzZW5kLCBtZXNMaXN0QXJpc2UsIG1vZHVsZU5hbWUpOyAvL0NvbmZpZyBjw6FjIGJ1dHRvbgoKICAgICAgdmFyIGJ0bkNvbmZpZyA9IFt7CiAgICAgICAga2V5OiAiTm8iLAogICAgICAgIHRhcmdldDogIlJpZ2h0IiwKICAgICAgICB0ZXh0OiAiSOG7p3kiLAogICAgICAgIHR5cGVCdXR0b246ICJzZWNvbmRhcnkiCiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJZZXMiLAogICAgICAgIHRhcmdldDogIlJpZ2h0IiwKICAgICAgICB0ZXh0OiAixJDhu5NuZyDDvSIsCiAgICAgICAgZm9jdXM6IHRydWUsCiAgICAgICAgdHlwZUJ1dHRvbjogImJsdWUiCiAgICAgIH1dOwogICAgICByZXR1cm4gewogICAgICAgIHRpdGxlOiB0aXRsZU5hbWUsCiAgICAgICAgbWVzc2FnZTogbWVzLAogICAgICAgIGJ0bkNvbmZpZzogYnRuQ29uZmlnCiAgICAgIH07CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEzhuqV5IGPDonUgdGjDtG5nIGLDoW8ga2hpIHBow6F0IHNpbmgNCiAgICAgKiBWaeG6v3QgcmnDqm5nIHJhIMSR4buDIG92ZXJyaWRlIGzhuqFpIHbDrCBt4buZdCBz4buRIG3DoG4gY8OzIGPDonUgdGjDtG5nIGLDoW8gbMOgIE5n4burbmcgdGhlbyBkw7VpIHRoYXkgdsOsIE5n4burbmcgc+G7rSBk4bulbmcNCiAgICAgKiBAcGFyYW0geyp9IGNvZGUNCiAgICAgKiBOVERJRU0gMTUuMTIuMjAyMQ0KICAgICAqLwogICAgZ2V0QXJpc2VNZXNzYWdlOiBmdW5jdGlvbiBnZXRBcmlzZU1lc3NhZ2UoY29kZSwgbGlzdEFyaXNlbmQsIG1lc0xpc3RBcmlzZSwgbW9kdWxlTmFtZSkgewogICAgICB2YXIgbWUgPSB0aGlzOwogICAgICB2YXIgbWVzID0gIiI7CiAgICAgIHZhciBDT0RFID0gbWUuJG1zLmVudW0uU2VydmljZVJlc3BvbnNlQ29kZTsKCiAgICAgIHN3aXRjaCAoY29kZSkgewogICAgICAgIGNhc2UgQ09ERS5EZWxldGVNdWx0aUFyaXNlbmVkOgogICAgICAgICAgbWVzID0gbWUuJHQoImkxOG5CYXNlRm9ybS5WYWxpZGF0ZS5EZWxldGVNdWx0aUhhc011bHRpQXJpc2VuZWQiKS5mb3JtYXQobW9kdWxlTmFtZSwgbWVzTGlzdEFyaXNlKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIC8vIHjDs2EgMSBi4bqjbiBnaGkgdsOgIGLhuqNuIGdoaSDEkcOzIGLhu4sgY8OzIHBow6F0IHNpbmg6CgogICAgICAgIGNhc2UgQ09ERS5BcmlzZW5lZDoKICAgICAgICAgIG1lcyA9IG1lLiR0KCJpMThuQmFzZUZvcm0uVmFsaWRhdGUuRGVsZXRlQXJpc2UiKS5mb3JtYXQobW9kdWxlTmFtZSwgbGlzdEFyaXNlbmRbMF0pOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIHJldHVybiBtZXM7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIE5n4burbmcgc+G7rSBk4bulbmcgYuG6o24gZ2hpIHBow6F0IHNpbmggZOG7ryBsaeG7h3UNCiAgICAgKiBOVFRIQU5IMQ0KICAgICAqLwogICAgc2V0SW5hY3RpdmVBcmlzZTogZnVuY3Rpb24gc2V0SW5hY3RpdmVBcmlzZShyZWNvcmRzKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgdmFyIG1lLCBpbmFjdGl2ZSwgZmllbGQsIGxpc3RJRCwgcGFyYW07CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIG1lID0gX3RoaXM3OwogICAgICAgICAgICAgICAgaW5hY3RpdmUgPSAxOwoKICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShyZWNvcmRzKSkgewogICAgICAgICAgICAgICAgICByZWNvcmRzID0gW3JlY29yZHNdOwogICAgICAgICAgICAgICAgfSAvL3Nob3cgbWFzawogICAgICAgICAgICAgICAgLy8gbWUubG9hZGluZyA9IHRydWU7CgoKICAgICAgICAgICAgICAgIGZpZWxkID0gbWUuJHN0b3JlLnN0YXRlW21lLm1vZHVsZV0uX2NvbmZpZy5maWVsZDsKICAgICAgICAgICAgICAgIGxpc3RJRCA9IHJlY29yZHMubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtW2ZpZWxkLmtleV07CiAgICAgICAgICAgICAgICB9KS5qb2luKCIsIik7CiAgICAgICAgICAgICAgICBwYXJhbSA9IHsKICAgICAgICAgICAgICAgICAgVGFibGVOYW1lOiBmaWVsZC50YWJsZSwKICAgICAgICAgICAgICAgICAgS2V5RmllbGQ6IGZpZWxkLmtleSwKICAgICAgICAgICAgICAgICAgVmFsdWU6IGluYWN0aXZlLAogICAgICAgICAgICAgICAgICBMaXN0SUQ6IGxpc3RJRCwKICAgICAgICAgICAgICAgICAgT3JnYW5pemF0aW9uSUQ6IG1lLmdldE9yZ2FuaXphdGlvbkZpbHRlcigpCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuIG1lLiRzdG9yZS5kaXNwYXRjaCgiIi5jb25jYXQoX3RoaXM3Lm1vZHVsZSwgIi91cGRhdGVTdGF0dXMiKSwgcGFyYW0pOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQ3LnNlbnQpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTcpOwogICAgICB9KSkoKTsKICAgIH0sCgogICAgLyoqDQogICAgICogWMOzYSBuaGnhu4F1IGLhuqNuIGdoaSBraMO0bmcgY+G6p24gcG91cCB0aMO0bmcgYsOhbw0KICAgICAqIE5UVEhBTkgxDQogICAgICovCiAgICBkZWxldGVNdXRpUm93c05vQ29uZmlybTogZnVuY3Rpb24gZGVsZXRlTXV0aVJvd3NOb0NvbmZpcm0ocmVjb3JkcykgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KCkgewogICAgICAgIHZhciBtZSwgdGVtcHMsIGF1ZGl0aW5nTG9nLCBwYXJhbTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgbWUgPSBfdGhpczg7CiAgICAgICAgICAgICAgICB0ZW1wcyA9IFtdOwogICAgICAgICAgICAgICAgcmVjb3Jkcy5mb3JFYWNoKGZ1bmN0aW9uIChyZWNvcmQpIHsKICAgICAgICAgICAgICAgICAgdmFyIHRlbXAgPSB7fTsgLy9C4buPIGLhu5t0IGPDoWMgdGjDtG5nIHRpbiBn4butaSBsw6puIHN2LgoKICAgICAgICAgICAgICAgICAgdmFyIGRyb3BlZENvbHVtbnMgPSBtZS5nZXRJZ25vcmVkQ29sdW1ucygpOwoKICAgICAgICAgICAgICAgICAgdmFyIF9sb29wMiA9IGZ1bmN0aW9uIF9sb29wMihpKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlzRHJvcGVkQ29sdW1uID0gZHJvcGVkQ29sdW1ucy5maW5kKGZ1bmN0aW9uIChfKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXyA9PSBpOwogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRHJvcGVkQ29sdW1uKSB7CiAgICAgICAgICAgICAgICAgICAgICB0ZW1wW2ldID0gcmVjb3JkW2ldOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVjb3JkKSB7CiAgICAgICAgICAgICAgICAgICAgX2xvb3AyKGkpOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB0ZW1wcy5wdXNoKHRlbXApOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBhdWRpdGluZ0xvZyA9IHsKICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IE1TSnNvbi5zZXJpYWxpemUobWUuZ2VuZXJhdGVEZXNjcmlwdGlvbkF1ZGl0aW5nTG9nKHJlY29yZHMpKSwKICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlOiBtZS5idWlsZFJlZmVyZW5jZShyZWNvcmRzKSwKICAgICAgICAgICAgICAgICAgYWN0aW9uOiBtZS5hY3Rpb25BdWRpdGluZ0xvZywKICAgICAgICAgICAgICAgICAgZW50aXR5OiBtZS5tb2R1bGUsCiAgICAgICAgICAgICAgICAgIHRpbWU6IG5ldyBEYXRlKCkKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBwYXJhbSA9IHsKICAgICAgICAgICAgICAgICAgRW50aXR5OiB0ZW1wcywKICAgICAgICAgICAgICAgICAgQnlQYXNzVmFsaWRhdGU6IG51bGwsCiAgICAgICAgICAgICAgICAgIEF1ZGl0aW5nTG9nOiBNU0pzb24uc2VyaWFsaXplKGF1ZGl0aW5nTG9nKSwKICAgICAgICAgICAgICAgICAgVHlwZTogbWUuJG1zLmVudW0uRGVsZXRlVHlwZS5NdWx0aQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiBtZS4kc3RvcmUuZGlzcGF0Y2goIiIuY29uY2F0KF90aGlzOC5tb2R1bGUsICIvZGVsZXRlIiksIHBhcmFtKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0OC5zZW50KTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU4KTsKICAgICAgfSkpKCk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEjDoG0gY3VzdG9tIGTDuW5nIGNobyB44butIGzDvSB0aMOqbSBzYXUga2hpIHjDs2ENCiAgICAgKiBOVEJBTyAwMi4xMS4yMDIxDQogICAgICovCiAgICBjdXN0b21BZnRlckRlbGV0ZTogZnVuY3Rpb24gY3VzdG9tQWZ0ZXJEZWxldGUoZGVsZXRlUmVjb3JkLCByZXN1bHQpIHt9LAogICAgZ2V0RmllbGRzOiBmdW5jdGlvbiBnZXRGaWVsZHMoKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBM4bqleSB0aGFtIHPhu5Ega2hpIG3hu58gZm9ybSBjaGkgdGnhur90DQogICAgICogKi8KICAgIGdldERldGFpbFBhcmFtZXRlcjogZnVuY3Rpb24gZ2V0RGV0YWlsUGFyYW1ldGVyKGZvcm1OYW1lLCBtb2RlLCBkZWZhdWx0RGF0YSkgewogICAgICB2YXIgbWUgPSB0aGlzOwogICAgICB2YXIgcGFyYW0gPSB7CiAgICAgICAgZGF0YTogZGVmYXVsdERhdGEgfHwgbnVsbAogICAgICB9OwoKICAgICAgc3dpdGNoIChtb2RlKSB7CiAgICAgICAgY2FzZSBtZS4kbXMuZW51bS5Gb3JtU3RhdGUuRHVwbGljYXRlOgogICAgICAgIGNhc2UgbWUuJG1zLmVudW0uRm9ybVN0YXRlLkVkaXQ6CiAgICAgICAgY2FzZSBtZS4kbXMuZW51bS5Gb3JtU3RhdGUuVmlldzoKICAgICAgICAgIHZhciBrZXlGaWVsZCA9IG1lLiRzdG9yZS5zdGF0ZVttZS5tb2R1bGVdLl9jb25maWcuZmllbGQua2V5OwoKICAgICAgICAgIGlmIChrZXlGaWVsZCkgewogICAgICAgICAgICBwYXJhbS5pZCA9IGRlZmF1bHREYXRhW2tleUZpZWxkXTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgcGFyYW0ubW9kZSA9IG1vZGU7CiAgICAgIG1lLmN1c3RvbURldGFpbFBhcmFtKHBhcmFtKTsKICAgICAgcmV0dXJuIHBhcmFtOwogICAgfSwKICAgIGN1c3RvbURldGFpbFBhcmFtOiBmdW5jdGlvbiBjdXN0b21EZXRhaWxQYXJhbShwYXJhbSkge30sCgogICAgLyoqDQogICAgICogaG92ZXIgYuG6o24gZ2hpIC0+IGhp4buDbiB0aOG7iyBtZW51DQogICAgICovCiAgICBncmlkUm93SG92ZXI6IGZ1bmN0aW9uIGdyaWRSb3dIb3ZlcigpIHt9LAoKICAgIC8qKg0KICAgICAqIGNsaWNrIGLhuqNuIGdoaSAtPiBoaeG7g24gdGjhu4sgbWVudQ0KICAgICAqLwogICAgZ3JpZFJvd092ZXI6IGZ1bmN0aW9uIGdyaWRSb3dPdmVyKHJlY29yZCwgZSkgewogICAgICB2YXIgbWUgPSB0aGlzOwogICAgICBtZS5yb3dBY3Rpb25zID0gbWUuZ2V0UmVjb3JkQWN0aW9ucyhyZWNvcmQpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBs4bqleSBkYW5oIHPDoWNoIGFjdGlvbiBj4bunYSBi4bqjbiBnaGkNCiAgICAgKi8KICAgIGdldFJlY29yZEFjdGlvbnM6IGZ1bmN0aW9uIGdldFJlY29yZEFjdGlvbnMocmVjb3JkKSB7CiAgICAgIHJldHVybiBbewogICAgICAgIGNvbW1hbmQ6ICJFZGl0IiwKICAgICAgICBpY29uOiAiZWRpdCIsCiAgICAgICAgdGV4dDogdGhpcy4kdCgiaTE4bkNvbW1vbi5jb21tYW5kLmVkaXQiKQogICAgICB9LCB7CiAgICAgICAgY29tbWFuZDogIkRlbGV0ZSIsCiAgICAgICAgaWNvbjogImRlbGV0ZSIsCiAgICAgICAgdGV4dDogdGhpcy4kdCgiaTE4bkNvbW1vbi5jb21tYW5kLmRlbGV0ZSIpCiAgICAgIH1dOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBjbGljayBhY3Rpb24gcm93DQogICAgICovCiAgICBncmlkUm93QWN0aW9uQ2xpY2s6IGZ1bmN0aW9uIGdyaWRSb3dBY3Rpb25DbGljayhjb21tYW5kLCByZWNvcmQsIGV2ZW50KSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CgogICAgICBzd2l0Y2ggKGNvbW1hbmQpIHsKICAgICAgICBjYXNlICJFZGl0IjoKICAgICAgICAgIG1lLmVkaXQocmVjb3JkKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJEZWxldGUiOgogICAgICAgICAgbWUuZGVsZXRlKHJlY29yZCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiRHVwbGljYXRlIjoKICAgICAgICAgIG1lLmR1cGxpY2F0ZShyZWNvcmQpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlZpZXciOgogICAgICAgICAgbWUudmlldyhyZWNvcmQpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImFjdGl2ZSI6CiAgICAgICAgY2FzZSAiaW5hY3RpdmUiOgogICAgICAgICAgbWUuc2V0QWN0aXZlTXV0aVJvd3MocmVjb3JkLCBjb21tYW5kKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgbWUuJG1zLm1zZ0JveC5zaG93SW5mbyhtZS4kdCgiaTE4bkNvbW1vbi5GZWF0dXJlc0lzRGV2ZWxvcGluZyIpKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFRoYXkgxJHhu5VpIGLhuqNuIGdoaSBjaOG7jW4NCiAgICAgKi8KICAgIHNlbGVjdGlvbkNoYW5nZTogZnVuY3Rpb24gc2VsZWN0aW9uQ2hhbmdlKHJlY29yZHMpIHsKICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgdmFyIGFjdGlvbnMgPSBbXTsKCiAgICAgIGlmIChyZWNvcmRzLmxlbmd0aCA+PSAxKSB7CiAgICAgICAgYWN0aW9ucyA9IG1lLmdldEFjdGlvbk11bHRpKHJlY29yZHMsIG1lLnNlbGVjdEFsbFBhZ2UpOwogICAgICB9CgogICAgICBtZS5hY3Rpb25NdWx0aSA9IGFjdGlvbnM7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEzhuqV5IGRhbmggc8OhY2ggYWN0aW9uIHjhu60gbMO9IGtoaSBuaGnhu4F1IGLhuqNuIGdoaSDEkcaw4bujYyBjaOG7jW4NCiAgICAgKiBURE5HSElBIDEwLzEwLzIwMjENCiAgICAgKiBt4bq3YyDEkeG7i25oIGNo4buJIGPhuqduIHjDs2Egbmhp4buBdSB0aMO0aSwgbcOgbiBuw6BvIHRow6ptIHTDrW5oIG7Eg25nIHRow6wgcGjhuqNpIG92ZXJyaWRlIGzhuqFpDQogICAgICovCiAgICBnZXRBY3Rpb25NdWx0aTogZnVuY3Rpb24gZ2V0QWN0aW9uTXVsdGkocmVjb3Jkcywgc2VsZWN0QWxsUGFnZSkgewogICAgICByZXR1cm4gW3sKICAgICAgICBjb21tYW5kOiAiYWN0aXZlIiwKICAgICAgICB0ZXh0OiAiVGhlbyBkw7VpIiwKICAgICAgICBjbHM6ICJzZWNvbmRhcnktb3V0bGluZSIKICAgICAgfSwgewogICAgICAgIGNvbW1hbmQ6ICJpbmFjdGl2ZSIsCiAgICAgICAgdGV4dDogIk5n4burbmcgdGhlbyBkw7VpIiwKICAgICAgICBjbHM6ICJwcmltYXJ5LW91dGxpbmUiCiAgICAgIH0sIHsKICAgICAgICBjb21tYW5kOiAiZGVsZXRlIiwKICAgICAgICB0ZXh0OiAiWMOzYSIsCiAgICAgICAgY2xzOiAic2Vjb25kYXJ5LW91dGxpbmUtcmVkIgogICAgICB9XTsKICAgIH0sCgogICAgLyoqDQogICAgICogQ2xpY2sgdsOgbyBhY3Rpb24gY2jhu41uIG5oaeG7gXUgYuG6o24gZ2hpDQogICAgICovCiAgICBtdWx0aVNlbGVjdEFjdGlvbkNsaWNrOiBmdW5jdGlvbiBtdWx0aVNlbGVjdEFjdGlvbkNsaWNrKGNvbW1hbmQsIHJlY29yZHMsIHNlbGVjdEFsbFBhZ2UsIGV2ZW50KSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CgogICAgICBzd2l0Y2ggKGNvbW1hbmQpIHsKICAgICAgICBjYXNlICJkZWxldGUiOgogICAgICAgICAgbWUuZGVsZXRlTXV0aVJvd3MocmVjb3Jkcyk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiYWN0aXZlIjoKICAgICAgICBjYXNlICJpbmFjdGl2ZSI6CiAgICAgICAgICBtZS5zZXRBY3RpdmVNdXRpUm93cyhyZWNvcmRzLCBjb21tYW5kKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9LAoKICAgIC8qDQogICAgICogIEjDoG0geMOzYSBuaGnhu4F1IGLhuqNuIGdoaS4NCiAgICAgKiBAbW9kaWZpZWQgYnkgVFZMb2kgMjEuMDYuMjAyMS4gbMaw4bujYyBi4buPIDEgc+G7kSB0aMO0bmcgdGluIHRyxrDhu5tjIGtoaSBn4butaSBi4bqjbiBnaGkgbMOqbiBzZXJ2ZQ0KICAgICAqLwogICAgZGVsZXRlTXV0aVJvd3M6IGZ1bmN0aW9uIGRlbGV0ZU11dGlSb3dzKHJlY29yZHMpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOSgpIHsKICAgICAgICB2YXIgbWUsIGNvbmZpZ01lc3NhZ2UsIGFuc3dlciwgdGVtcHMsIGF1ZGl0aW5nTG9nLCBwYXJhbSwgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQ5KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBtZSA9IF90aGlzOTsKCiAgICAgICAgICAgICAgICBpZiAobWUuY2hlY2tBY3Rpb25QZXJtaXNzaW9uQWxlcnQobWUuJHQoImkxOG5QZXJtaXNzaW9uLlN1YlN5c3RlbUNvZGUuQ29kZS5ERUxFVEUiKSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIGlmIChtZS52YWxpZGF0ZUJlZm9yZURlbGV0ZShyZWNvcmRzKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIG1lLmdldERlbGV0ZUNvbmZpcm1NZXNzYWdlKHJlY29yZHMpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICBjb25maWdNZXNzYWdlID0gX2NvbnRleHQ5LnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgcmV0dXJuIG1lLiRtcy5tc2dCb3guc2hvd1F1ZXN0aW9uKGNvbmZpZ01lc3NhZ2UpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgYW5zd2VyID0gX2NvbnRleHQ5LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKCEoYW5zd2VyID09ICJZZXMiKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDIzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0ZW1wcyA9IFtdOwogICAgICAgICAgICAgICAgcmVjb3Jkcy5mb3JFYWNoKGZ1bmN0aW9uIChyZWNvcmQpIHsKICAgICAgICAgICAgICAgICAgdmFyIHRlbXAgPSB7fTsgLy9C4buPIGLhu5t0IGPDoWMgdGjDtG5nIHRpbiBn4butaSBsw6puIHN2LgoKICAgICAgICAgICAgICAgICAgdmFyIGRyb3BlZENvbHVtbnMgPSBtZS5nZXRJZ25vcmVkQ29sdW1ucygpOwoKICAgICAgICAgICAgICAgICAgdmFyIF9sb29wMyA9IGZ1bmN0aW9uIF9sb29wMyhpKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlzRHJvcGVkQ29sdW1uID0gZHJvcGVkQ29sdW1ucy5maW5kKGZ1bmN0aW9uIChfKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXyA9PSBpOwogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRHJvcGVkQ29sdW1uKSB7CiAgICAgICAgICAgICAgICAgICAgICB0ZW1wW2ldID0gcmVjb3JkW2ldOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVjb3JkKSB7CiAgICAgICAgICAgICAgICAgICAgX2xvb3AzKGkpOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB0ZW1wcy5wdXNoKHRlbXApOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBhdWRpdGluZ0xvZyA9IHsKICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IE1TSnNvbi5zZXJpYWxpemUobWUuZ2VuZXJhdGVEZXNjcmlwdGlvbkF1ZGl0aW5nTG9nKHJlY29yZHMpKSwKICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlOiBtZS5idWlsZFJlZmVyZW5jZShyZWNvcmRzKSwKICAgICAgICAgICAgICAgICAgYWN0aW9uOiBtZS5hY3Rpb25BdWRpdGluZ0xvZywKICAgICAgICAgICAgICAgICAgZW50aXR5OiBtZS5tb2R1bGUsCiAgICAgICAgICAgICAgICAgIHRpbWU6IG5ldyBEYXRlKCkKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBwYXJhbSA9IHsKICAgICAgICAgICAgICAgICAgRW50aXR5OiB0ZW1wcywKICAgICAgICAgICAgICAgICAgQnlQYXNzVmFsaWRhdGU6IG51bGwsCiAgICAgICAgICAgICAgICAgIEF1ZGl0aW5nTG9nOiBNU0pzb24uc2VyaWFsaXplKGF1ZGl0aW5nTG9nKSwKICAgICAgICAgICAgICAgICAgVHlwZTogbWUuJG1zLmVudW0uRGVsZXRlVHlwZS5NdWx0aQogICAgICAgICAgICAgICAgfTsgLy8gQ3VzdG9tIGzhuqFpIHBhcmFtIHjDs2EKCiAgICAgICAgICAgICAgICBwYXJhbSA9IG1lLmN1c3RvbURlbGV0ZVBhcmFtKHJlY29yZHMsIHBhcmFtKTsKICAgICAgICAgICAgICAgIG1lLiRtcy5jb21tb25Gbi5tYXNrKCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDIwOwogICAgICAgICAgICAgICAgcmV0dXJuIG1lLnJlcXVlc3REZWxldGVEYXRhKHJlY29yZHMsIHBhcmFtKTsKCiAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0OS5zZW50OwogICAgICAgICAgICAgICAgbWUuJG1zLmNvbW1vbkZuLnVubWFzaygpOwogICAgICAgICAgICAgICAgbWUuYWZ0ZXJEZWxldGUocmVjb3JkcywgcmVzdWx0KTsgLy9sb2cgZmlyZWJhc2UKICAgICAgICAgICAgICAgIC8vIG1lLmxvZ0RhdGFGaXJlQmFzZSgpCgogICAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTkpOwogICAgICB9KSkoKTsKICAgIH0sCgogICAgLyoqDQogICAgICogSMOgbSBjdXN0b20gZGVsZXRlIHBhcmFtDQogICAgICogTlRCQU86IDA3LjEyLjIwMjENCiAgICAgKiBAcGFyYW0geyp9IHBhcmFtDQogICAgICogQHJldHVybnMNCiAgICAgKi8KICAgIGN1c3RvbURlbGV0ZVBhcmFtOiBmdW5jdGlvbiBjdXN0b21EZWxldGVQYXJhbShyZWNvcmQsIHBhcmFtKSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgIHJldHVybiBwYXJhbTsKICAgIH0sCgogICAgLyoqDQogICAgICogQ2xpY2sgdsOgbyBhY3Rpb24gY2jhu41uIG5oaeG7gXUgYuG6o24gZ2hpOiBDaOG7jW4gdOG6pXQgY+G6ow0KICAgICAqLwogICAgbXVsdGlTZWxlY3RBbGxDbGljazogZnVuY3Rpb24gbXVsdGlTZWxlY3RBbGxDbGljaygpIHsKICAgICAgdGhpcy5zZWxlY3RBbGxQYWdlID0gIXRoaXMuc2VsZWN0QWxsUGFnZTsKCiAgICAgIGlmICghdGhpcy5zZWxlY3RBbGxQYWdlKSB7CiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IFtdOwogICAgICAgIHRoaXMuZ3JpZC5jaGVja2FsbCA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZ3JpZC5jaGVja2FsbCA9IHRydWU7CiAgICAgICAgdGhpcy5ncmlkLiRlbWl0KCJpbnB1dCIsIHRoaXMuZ3JpZC5kYXRheCk7CiAgICAgIH0KICAgIH0sCgogICAgLyoqDQogICAgICogQuG7jyB0w61jaCBjaOG7jW4gY8OhYyBi4bqjbiBnaGkNCiAgICAgKi8KICAgIG11bHRpU2VsZWN0VW5jaGVjazogZnVuY3Rpb24gbXVsdGlTZWxlY3RVbmNoZWNrKCkgewogICAgICB2YXIgbWUgPSB0aGlzOwogICAgICBtZS5zZWxlY3RlZCA9IFtdOyAvLyBOTVRVQU4yIDI4LjExLjIwMjE6IGLhu48gdMOtY2ggY2jhu41uIHRyw6puIGdyaWRFZGl0b3IKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KG1lLmdyaWQubGlzdFJvd1NlbGVjdGVkKSkgewogICAgICAgIG1lLmdyaWQubGlzdFJvd1NlbGVjdGVkID0gW107CiAgICAgIH0KICAgIH0sCgogICAgLyoqDQogICAgICogS2hhaSBiw6FvIHPhu7Ega2nhu4duIGPhu6dhIGZvcm0NCiAgICAgKi8KICAgIGluaXRFdmVudDogZnVuY3Rpb24gaW5pdEV2ZW50KCkgewogICAgICB2YXIgbWUgPSB0aGlzLAogICAgICAgICAgZ3JpZCA9IG1lLmdyaWQsCiAgICAgICAgICBhY3Rpb25NdWx0aSA9IG1lLmFjdGlvbk11bHRpQ29tcG9uZW50LAogICAgICAgICAgYWN0aW9uTXVsdGlCaWdTY3Jlbm4gPSBtZS5hY3Rpb25NdWx0aUJpZ1NjcmVlbkNvbXBvbmVudDsKCiAgICAgIGlmIChncmlkKSB7CiAgICAgICAgZ3JpZC4kb24oImxvYWREYXRhIiwgbWUubG9hZERhdGEpOwogICAgICAgIGdyaWQuJG9uKCJkYmxjbGljayIsIG1lLmdyaWRSb3dEYkNsaWNrKTsKICAgICAgICBncmlkLiRvbigicm93bW91c2VvdmVyIiwgbWUuZ3JpZFJvd092ZXIpOwogICAgICAgIGdyaWQuJG9uKCJyb3dhY3Rpb25jbGljayIsIG1lLmdyaWRSb3dBY3Rpb25DbGljayk7CiAgICAgICAgZ3JpZC4kb24oImlucHV0IiwgbWUuc2VsZWN0aW9uQ2hhbmdlKTsKICAgICAgICBncmlkLiRvbigiY2hhbmdlcGFnZXNpemUiLCBtZS5ncmlkQ2hhbmdlUGFnZVNpemUpOwoKICAgICAgICBpZiAoIWdyaWQuaXNHcmlkVHJlZSkgewogICAgICAgICAgZ3JpZC4kb24oImZpbHRlciIsIG1lLnJlbG9hZCk7CiAgICAgICAgfQoKICAgICAgICBncmlkLiRvbigicmVzaXplQ29sIiwgbWUuZ3JpZFJlc2l6ZUNvbCk7CiAgICAgIH0KCiAgICAgIGlmIChhY3Rpb25NdWx0aSkgewogICAgICAgIGFjdGlvbk11bHRpLiRvbigiYWN0aW9uY2xpY2siLCBtZS5tdWx0aVNlbGVjdEFjdGlvbkNsaWNrKTsKICAgICAgICBhY3Rpb25NdWx0aS4kb24oInNlbGVjdGFsbCIsIG1lLm11bHRpU2VsZWN0QWxsQ2xpY2spOwogICAgICAgIGFjdGlvbk11bHRpLiRvbigidW5jaGVjayIsIG1lLm11bHRpU2VsZWN0VW5jaGVjayk7CiAgICAgIH0KCiAgICAgIGlmIChhY3Rpb25NdWx0aUJpZ1NjcmVubikgewogICAgICAgIGFjdGlvbk11bHRpQmlnU2NyZW5uLiRvbigiYWN0aW9uY2xpY2siLCBtZS5tdWx0aVNlbGVjdEFjdGlvbkNsaWNrKTsKICAgICAgICBhY3Rpb25NdWx0aUJpZ1NjcmVubi4kb24oInNlbGVjdGFsbCIsIG1lLm11bHRpU2VsZWN0QWxsQ2xpY2spOwogICAgICAgIGFjdGlvbk11bHRpQmlnU2NyZW5uLiRvbigidW5jaGVjayIsIG1lLm11bHRpU2VsZWN0VW5jaGVjayk7CiAgICAgIH0KICAgIH0sCgogICAgLyoqDQogICAgICogcmVtb3ZlIGV2ZW50IGFkZCDEkeG7mW5nDQogICAgICovCiAgICByZW1vdmVFdmVudDogZnVuY3Rpb24gcmVtb3ZlRXZlbnQoKSB7CiAgICAgIHZhciBtZSA9IHRoaXMsCiAgICAgICAgICBncmlkID0gbWUuZ3JpZCwKICAgICAgICAgIGFjdGlvbk11bHRpID0gbWUuYWN0aW9uTXVsdGlDb21wb25lbnQsCiAgICAgICAgICBhY3Rpb25NdWx0aUJpZ1NjcmVubiA9IG1lLmFjdGlvbk11bHRpQmlnU2NyZWVuQ29tcG9uZW50OwoKICAgICAgaWYgKGdyaWQpIHsKICAgICAgICBncmlkLiRvZmYoImxvYWREYXRhIiwgbWUubG9hZERhdGEpOwogICAgICAgIGdyaWQuJG9mZigiZGJsY2xpY2siLCBtZS5ncmlkUm93RGJDbGljayk7CiAgICAgICAgZ3JpZC4kb2ZmKCJyb3dtb3VzZW92ZXIiLCBtZS5ncmlkUm93Q2xpY2spOwogICAgICAgIGdyaWQuJG9mZigicm93YWN0aW9uY2xpY2siLCBtZS5ncmlkUm93QWN0aW9uQ2xpY2spOwogICAgICAgIGdyaWQuJG9mZigiaW5wdXQiLCBtZS5zZWxlY3Rpb25DaGFuZ2UpOwogICAgICAgIGdyaWQuJG9mZigiY2hhbmdlcGFnZXNpemUiLCBtZS5ncmlkQ2hhbmdlUGFnZVNpemUpOwoKICAgICAgICBpZiAoIWdyaWQuaXNHcmlkVHJlZSkgewogICAgICAgICAgZ3JpZC4kb2ZmKCJmaWx0ZXIiLCBtZS5yZWxvYWQpOwogICAgICAgIH0KCiAgICAgICAgZ3JpZC4kb2ZmKCJyZXNpemVDb2wiLCBtZS5ncmlkUmVzaXplQ29sKTsKICAgICAgfQoKICAgICAgaWYgKGFjdGlvbk11bHRpKSB7CiAgICAgICAgYWN0aW9uTXVsdGkuJG9mZigiYWN0aW9uY2xpY2siLCBtZS5tdWx0aVNlbGVjdEFjdGlvbkNsaWNrKTsKICAgICAgICBhY3Rpb25NdWx0aS4kb2ZmKCJzZWxlY3RhbGwiLCBtZS5tdWx0aVNlbGVjdEFsbENsaWNrKTsKICAgICAgICBhY3Rpb25NdWx0aS4kb2ZmKCJ1bmNoZWNrIiwgbWUubXVsdGlTZWxlY3RVbmNoZWNrKTsKICAgICAgfQoKICAgICAgaWYgKGFjdGlvbk11bHRpQmlnU2NyZW5uKSB7CiAgICAgICAgYWN0aW9uTXVsdGlCaWdTY3Jlbm4uJG9mZigiYWN0aW9uY2xpY2siLCBtZS5tdWx0aVNlbGVjdEFjdGlvbkNsaWNrKTsKICAgICAgICBhY3Rpb25NdWx0aUJpZ1NjcmVubi4kb2ZmKCJzZWxlY3RhbGwiLCBtZS5tdWx0aVNlbGVjdEFsbENsaWNrKTsKICAgICAgICBhY3Rpb25NdWx0aUJpZ1NjcmVubi4kb2ZmKCJ1bmNoZWNrIiwgbWUubXVsdGlTZWxlY3RVbmNoZWNrKTsKICAgICAgfQogICAgfSwKCiAgICAvKioNCiAgICAgKiBYdeG6pXQga2jhuql1IGV4Y2VsDQogICAgICovCiAgICBleHBvcnRFeGNlbDogZnVuY3Rpb24gZXhwb3J0RXhjZWwoKSB7CiAgICAgIHZhciBfdGhpczEwID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMCgpIHsKICAgICAgICB2YXIgbWUsIHBhcmFtOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgbWUgPSBfdGhpczEwOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczEwLmNoZWNrQWN0aW9uUGVybWlzc2lvbkFsZXJ0KG1lLiR0KCJpMThuUGVybWlzc2lvbi5TdWJTeXN0ZW1Db2RlLkNvZGUuRVhQT1JUIikpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDU7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMC5nZXRFeHBvcnRFeGNlbFBhcmFtKCk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIHBhcmFtID0gX2NvbnRleHQxMC5zZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gODsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczEwLmN1c3RvbVBhcmFtQmVmb3JlRXhwb3J0KHBhcmFtKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTApOwogICAgICB9KSkoKTsKICAgIH0sCgogICAgLyoqDQogICAgICogTOG6pXkgdGhhbSBz4buRIHh14bqldCBraOG6qXUNCiAgICAgKi8KICAgIGdldEV4cG9ydEV4Y2VsUGFyYW06IGZ1bmN0aW9uIGdldEV4cG9ydEV4Y2VsUGFyYW0oKSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMSgpIHsKICAgICAgICB2YXIgcGFyYW0sIGNvbnRyb2xsZXI7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBwYXJhbSA9IF90aGlzMTEuZ2V0R3JpZEV4cG9ydFBhcmFtZXRlcihfdGhpczExLmdyaWQpOwogICAgICAgICAgICAgICAgcGFyYW0uRmlsZVR5cGUgPSAieGxzeCI7CiAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTEuJHN0b3JlLmRpc3BhdGNoKCIiLmNvbmNhdChfdGhpczExLm1vZHVsZSwgIi9nZXRDb250cm9sbGVyIikpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICBjb250cm9sbGVyID0gX2NvbnRleHQxMS5zZW50OwogICAgICAgICAgICAgICAgcGFyYW0uR2V0RGF0YVVybCA9IFtjb250cm9sbGVyLCAibGlzdCJdLmpvaW4oIi8iKTsKICAgICAgICAgICAgICAgIHBhcmFtLkdldERhdGFNZXRob2QgPSAiUE9TVCI7CiAgICAgICAgICAgICAgICBwYXJhbS5SZXBvcnRUaXRsZSA9IF90aGlzMTEuZ2V0VGl0bGVFeHBvcnQoKTsKICAgICAgICAgICAgICAgIHBhcmFtLkZpbGVOYW1lID0gX3RoaXMxMS5nZXRGaWxlTmFtZSgpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuYWJydXB0KCJyZXR1cm4iLCBwYXJhbSk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMSk7CiAgICAgIH0pKSgpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBs4bqleSB0acOqdSDEkeG7gSBmaWxlIGV4Y2VsDQogICAgICogQHJldHVybnMgdGnDqnUgxJHhu4EgZGFuaCBzw6FjaA0KICAgICAqLwogICAgZ2V0VGl0bGVFeHBvcnQ6IGZ1bmN0aW9uIGdldFRpdGxlRXhwb3J0KCkgewogICAgICB2YXIgdGl0bGUgPSAiIjsKICAgICAgdmFyIGVsID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcigiLmxpc3QtdGl0bGUiKTsKCiAgICAgIGlmIChlbCAmJiB0eXBlb2YgZWwuaW5uZXJIVE1MID09PSAic3RyaW5nIikgewogICAgICAgIHRpdGxlID0gZWwuaW5uZXJIVE1MLnRyaW0oKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aXRsZSA9IHRoaXMudGl0bGUgPyB0aGlzLnRpdGxlLnRyaW0oKSA6ICIiOwogICAgICB9CgogICAgICByZXR1cm4gdGl0bGU7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEzhuqV5IHTDqm4gZmlsZSBraGkgeHXhuqV0IGto4bqpdQ0KICAgICAqIEByZXR1cm5zIHTDqm4gZmlsZSA6IG7hur91IMSR4buDIHRy4buRbmcgdGjDrCBt4bq3YyDEkeG7i25oIGzhuqV5IHRpw6p1IMSR4buBDQogICAgICovCiAgICBnZXRGaWxlTmFtZTogZnVuY3Rpb24gZ2V0RmlsZU5hbWUoKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBIw6BtIG3hu58gcG9wdXAgc+G7rWEgbeG6q3UNCiAgICAgKi8KICAgIG9wZW5Qcm90b3R5cGU6IGZ1bmN0aW9uIG9wZW5Qcm90b3R5cGUoKSB7CiAgICAgIHRoaXMuc2hvd0RldGFpbCgiTXNDb25maWdMaXN0TGF5b3V0IiwgdGhpcy4kbXMuZW51bS5Gb3JtU3RhdGUuQWRkLCB7CiAgICAgICAgbGF5b3V0OiB0aGlzLmxheW91dCwKICAgICAgICBwYXJlbnQ6IHRoaXMKICAgICAgfSk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEBhdXRob3IgdnZraWV0IC0gMTguMDMuMjAyMQ0KICAgICAqIEjDoG0gY3VzdG9tIGzhuqFpIHBhcmFtIHRyxrDhu5tjIGtoaSB4deG6pXQgZXhjZWwNCiAgICAgKi8KICAgIGN1c3RvbVBhcmFtQmVmb3JlRXhwb3J0OiBmdW5jdGlvbiBjdXN0b21QYXJhbUJlZm9yZUV4cG9ydChwYXJhbSkgewogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTIoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMiQoX2NvbnRleHQxMikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEyLnByZXYgPSBfY29udGV4dDEyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMik7CiAgICAgIH0pKSgpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBAYXV0aG9yIHZ2a2lldCAtIDE0LjA0LjIwMjENCiAgICAgKiBIw6BtIHjhu60gbMO9IGV4dERhdGENCiAgICAgKi8KICAgIGRlY29kZUV4dERhdGE6IGZ1bmN0aW9uIGRlY29kZUV4dERhdGEoZGF0YSkgewogICAgICB2YXIgbWUgPSB0aGlzOyAvLyBY4butIGzDvSBk4buvIGxp4buHdSBt4bufIHLhu5luZwoKICAgICAgdmFyIG9yaWdpbkZpZWxkcyA9IFtdOwoKICAgICAgaWYgKGRhdGEuaGFzT3duUHJvcGVydHkoIkV4dERhdGEiKSkgewogICAgICAgIC8vIERhbmggc8OhY2ggY8OhYyB0csaw4budbmcgZOG7ryBsaeG7h3UgZ+G7kWMgY+G7p2EgZOG7ryBsaeG7h3UKICAgICAgICBmb3IgKHZhciBpIGluIGRhdGEpIHsKICAgICAgICAgIG9yaWdpbkZpZWxkcy5wdXNoKGkpOwogICAgICAgIH0gLy8gTWFwIGThu68gbGnhu4d1IG3hu58gcuG7mW5nCgoKICAgICAgICBpZiAoZGF0YS5FeHREYXRhICYmIHR5cGVvZiBkYXRhLkV4dERhdGEgPT09ICJzdHJpbmciKSB7CiAgICAgICAgICB2YXIgZXh0RGF0YSA9IEpTT04ucGFyc2UoZGF0YS5FeHREYXRhKTsKCiAgICAgICAgICBpZiAoZXh0RGF0YSkgewogICAgICAgICAgICBtZS4kbXMuY29tbW9uRm4ucHJvY2Vzc1NlcnZlclJlc3BvbnNlRGF0YShleHREYXRhKTsKCiAgICAgICAgICAgIGZvciAodmFyIG0gaW4gZXh0RGF0YSkgewogICAgICAgICAgICAgIC8vIENo4buJIG1hcCBjw6FjIHRyxrDhu51uZyBraMO0bmcgY8OzIHRyb25nIGThu68gbGnhu4d1IGfhu5FjCiAgICAgICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YVttXSkgewogICAgICAgICAgICAgICAgZGF0YVttXSA9IGV4dERhdGFbbV07CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFjhu60gbMO9IGThu68gbGnhu4d1IHNhdSBraGkgc+G7rWENCiAgICAgKiBAcGFyYW0geyp9IHJlY29yZCBi4bqjbiBnaGkgZ+G7kWMNCiAgICAgKiBAcGFyYW0geyp9IHNhdmVSZXN1bHQgYuG6o24gZ2hpIHRyw6puIHNlcnZlciB0cuG6oyB24buBDQogICAgICogQG92ZXJyaWRlDQogICAgICovCiAgICBhZnRlclNhdmVFZGl0OiBmdW5jdGlvbiBhZnRlclNhdmVFZGl0KHJlY29yZCwgc2F2ZVJlc3VsdCkge30sCgogICAgLyoqDQogICAgICogWOG7rSBsw70gZOG7ryBsaeG7h3Ugc2F1IGtoaSBz4butYSB04bqhaSBtb2RlIHZpZXcNCiAgICAgKiBAcGFyYW0geyp9IHJlY29yZCBi4bqjbiBnaGkgZ+G7kWMNCiAgICAgKiBAcGFyYW0geyp9IHNhdmVSZXN1bHQgYuG6o24gZ2hpIHRyw6puIHNlcnZlciB0cuG6oyB24buBDQogICAgICogQG92ZXJyaWRlDQogICAgICovCiAgICBhZnRlclNhdmVWaWV3OiBmdW5jdGlvbiBhZnRlclNhdmVWaWV3KHJlY29yZCwgc2F2ZVJlc3VsdCkge30sCgogICAgLyoqDQogICAgICogSMOgbSBzaG93IEFsbCBpY29uZmlsdGVyDQogICAgICogQHBhcmFtIHsqfSByZWNvcmQgYuG6o24gZ2hpIGfhu5FjDQogICAgICogQHBhcmFtIHsqfSBzYXZlUmVzdWx0IGLhuqNuIGdoaSB0csOqbiBzZXJ2ZXIgdHLhuqMgduG7gQ0KICAgICAqIEBvdmVycmlkZQ0KICAgICAqLwogICAgZnVuU2hvd0FsbEljb25GaWx0ZXI6IGZ1bmN0aW9uIGZ1blNob3dBbGxJY29uRmlsdGVyKCkgewogICAgICAvL3RoaXMuJG5leHRUaWNrKCgpPT57CiAgICAgIHRoaXMuc2hvd0FsbEljb25GaWx0ZXIgPSAhdGhpcy5zaG93QWxsSWNvbkZpbHRlcjsKICAgICAgdGhpcy4kcmVmc1t0aGlzLnZpZXdSZWZdLmZ1blNob3dBbGxJY29uRmlsdGVyKHRoaXMuc2hvd0FsbEljb25GaWx0ZXIpOyAvL30pCiAgICB9LAoKICAgIC8qKg0KICAgICAqIGN1c3RvbSDEkWnhu4F1IGtp4buHbiBs4buNYy9zZWFyY2ggbcOgbiBow6xuaCBncmlkIHRyZWUNCiAgICAgKiBAcGFyYW0geyp9IHJlY29yZCBi4bqjbiBnaGkgY2hlY2sNCiAgICAgKiBAcGFyYW0gcHJvcGVydGllcyBkYW5oIHPDoWNoIGZpZWxkIGPhuqduIGNoZWNrIMSRaw0KICAgICAqIEBwYXJhbSBzZWFyY2hUZXh0IMSRb+G6oW4gdGV4dCBuaOG6rXAg4bufIMO0IHTDrG0ga2nhur9tDQogICAgICogTeG6t2MgxJHhu4tuaCB0cuG6oyB24buBIHRydWUNCiAgICAgKi8KICAgIGNoZWNrRmlsdGVyR3JpZFRyZWVDdXN0b206IGZ1bmN0aW9uIGNoZWNrRmlsdGVyR3JpZFRyZWVDdXN0b20ocmVjb3JkLCBwcm9wZXJ0aWVzLCBzZWFyY2hUZXh0KSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBIw6BtIHNob3cgY8OhYyBwb3B1cCB0aGVvIHTDqm4gbOG6pXkgxJHGsOG7nW5nIGThuqtuIHThu6sgaMOgbSBnZXRQb3B1cG9tcG9uZW50DQogICAgICogQHBhcmFtIG5hbWUgdMOqbiBj4bunYSBjb21wb25lbnQNCiAgICAgKiBDcmVhdGVkIGJ5IExUREFUKDE3LjA2LjIwMjApDQogICAgICovCiAgICBzaG93RGV0YWlsOiBmdW5jdGlvbiBzaG93RGV0YWlsKG5hbWUsIG1vZGUsIGRhdGEsIG9wdGlvbikgewogICAgICB2YXIgbWUgPSB0aGlzOwogICAgICBwb3B1cFV0aWwuc2hvdyhtZSwgbmFtZSwgZGF0YSwgbWUuZ2V0UG9wdXBPcHRpb24obmFtZSwgb3B0aW9uKSk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEF1dGhvcjogxJBWVGhpDQogICAgICogQ3JlYXRlIGRhdGU6IDExLzAzLzIwMjENCiAgICAgKiBDaG8gcGjDqXAgZGV0YWlsIGfhu41pIHThu5tpIHN1Ym1pdERldGFpbENhbGxiYWNrIGPhu6dhIGRhbmggc8OhY2ggc2F1IGtoaSBj4bqldCB4b25nDQogICAgICovCiAgICBnZXRQb3B1cE9wdGlvbjogZnVuY3Rpb24gZ2V0UG9wdXBPcHRpb24obmFtZSwgb3B0aW9uKSB7CiAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgIHJldHVybiB7CiAgICAgICAgc3VibWl0OiBtZS5zdWJtaXREZXRhaWxDYWxsYmFjaywKICAgICAgICBzaW5nbGU6IHRydWUKICAgICAgfTsKICAgIH0sCgogICAgLyoqDQogICAgICogQXV0aG9yOiDEkFZUaGkNCiAgICAgKiBDcmVhdGUgZGF0ZTogMTEvMDMvMjAyMQ0KICAgICAqIENobyBwaMOpcCBkZXRhaWwgZ+G7jWkgdOG7m2kgc3VibWl0RGV0YWlsQ2FsbGJhY2sgY+G7p2EgZGFuaCBzw6FjaCBzYXUga2hpIGPhuqV0IHhvbmcNCiAgICAgKi8KICAgIHN1Ym1pdERldGFpbENhbGxiYWNrOiBmdW5jdGlvbiBzdWJtaXREZXRhaWxDYWxsYmFjayhyZXN1bHQsIHBhcmFtLCBhY3Rpb24pIHsKICAgICAgdmFyIG1lID0gdGhpczsKICAgIH0sCgogICAgLyoqDQogICAgICogQG92ZXJyaWRlDQogICAgICovCiAgICBnZXRDb25kaXRpb25QYXJhbWV0ZXI6IGZ1bmN0aW9uIGdldENvbmRpdGlvblBhcmFtZXRlcigpIHsKICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgdmFyIHJlc3VsdCA9IG1lLnN1cGVyKCJnZXRDb25kaXRpb25QYXJhbWV0ZXIiKTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCgogICAgLyoqDQogICAgICogSMOgbSB0aOG7sWMgaGnhu4duIGN1c3RvbSBlbnRpdHkgxJHhu5FpIHbhu5tpIG5naGnhu4dwIHbhu6UgxJHhurdjIHRow7kNCiAgICAgKiBAYXV0aG9yIHZ2a2lldCAtIDI3LjA3LjIwMjENCiAgICAgKi8KICAgIGdldEVudGl0eVR5cGU6IGZ1bmN0aW9uIGdldEVudGl0eVR5cGUoKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBzaG93IGZpbHRlciBwb3B1cA0KICAgICAqLwogICAgc2hvd0FjdGlvbkJveDogZnVuY3Rpb24gc2hvd0FjdGlvbkJveCgpIHsKICAgICAgaWYgKHRoaXMuaXNTaG93QWN0aW9uR3JvdXAgPT0gdHJ1ZSkgewogICAgICAgIHRoaXMuaXNTaG93QWN0aW9uR3JvdXAgPSBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlzU2hvd0FjdGlvbkdyb3VwID0gdHJ1ZTsKICAgICAgfQogICAgfSwKCiAgICAvKioNCiAgICAgKiBoaWRlIGZpbHRlciBwb3B1cA0KICAgICAqLwogICAgaGlkZGVuQWN0aW9uQm94OiBmdW5jdGlvbiBoaWRkZW5BY3Rpb25Cb3goZXZlbnQpIHsKICAgICAgdGhpcy5pc1Nob3dBY3Rpb25Hcm91cCA9IGZhbHNlOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBD4bqtcCBuaOG6rXQgdHLhuqFuZyB0aMOhaSBjw6FjIGLhuqNuIGdoaSDEkcaw4bujYyBjaOG7jW4NCiAgICAgKiBURE5HSElBIDEyLzExLzIwMjENCiAgICAgKiBAcGFyYW0geyp9IHJlY29yZHMNCiAgICAgKiBAcGFyYW0geyp9IGNvbW1hbmQNCiAgICAgKi8KICAgIHNldEFjdGl2ZU11dGlSb3dzOiBmdW5jdGlvbiBzZXRBY3RpdmVNdXRpUm93cyhyZWNvcmRzLCBjb21tYW5kKSB7CiAgICAgIHZhciBfdGhpczEyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMygpIHsKICAgICAgICB2YXIgbWUsIGluYWN0aXZlLCBmaWVsZCwgbGlzdElELCBwYXJhbSwgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTMkKF9jb250ZXh0MTMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMy5wcmV2ID0gX2NvbnRleHQxMy5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgbWUgPSBfdGhpczEyOwogICAgICAgICAgICAgICAgaW5hY3RpdmUgPSBjb21tYW5kID09ICJhY3RpdmUiID8gMCA6IDE7CgogICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHJlY29yZHMpKSB7CiAgICAgICAgICAgICAgICAgIHJlY29yZHMgPSBbcmVjb3Jkc107CiAgICAgICAgICAgICAgICB9IC8vc2hvdyBtYXNrCiAgICAgICAgICAgICAgICAvLyBtZS5sb2FkaW5nID0gdHJ1ZTsKCgogICAgICAgICAgICAgICAgZmllbGQgPSBtZS4kc3RvcmUuc3RhdGVbbWUubW9kdWxlXS5fY29uZmlnLmZpZWxkOwogICAgICAgICAgICAgICAgbGlzdElEID0gcmVjb3Jkcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW1bZmllbGQua2V5XTsKICAgICAgICAgICAgICAgIH0pLmpvaW4oIiwiKTsKICAgICAgICAgICAgICAgIHBhcmFtID0gewogICAgICAgICAgICAgICAgICBUYWJsZU5hbWU6IGZpZWxkLnRhYmxlLAogICAgICAgICAgICAgICAgICBLZXlGaWVsZDogZmllbGQua2V5LAogICAgICAgICAgICAgICAgICBWYWx1ZTogaW5hY3RpdmUsCiAgICAgICAgICAgICAgICAgIExpc3RJRDogbGlzdElELAogICAgICAgICAgICAgICAgICBPcmdhbml6YXRpb25JRDogbWUuZ2V0T3JnYW5pemF0aW9uRmlsdGVyKCkKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuIG1lLiRzdG9yZS5kaXNwYXRjaCgiIi5jb25jYXQoX3RoaXMxMi5tb2R1bGUsICIvdXBkYXRlU3RhdHVzIiksIHBhcmFtKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQxMy5zZW50OwogICAgICAgICAgICAgICAgbWUuYWZ0ZXJVcGRhdGVTdGF0dXMocmVjb3JkcywgcmVzdWx0KTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEzKTsKICAgICAgfSkpKCk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIGPhuq1wIG5o4bqtdCBzYXUga2hpIHVwZGF0ZSBzdGF0dXMNCiAgICAgKiBAcGFyYW0geyp9IHJlY29yZA0KICAgICAqIEBwYXJhbSB7Kn0gcmVzdWx0DQogICAgICovCiAgICBhZnRlclVwZGF0ZVN0YXR1czogZnVuY3Rpb24gYWZ0ZXJVcGRhdGVTdGF0dXMocmVjb3JkLCByZXN1bHQpIHsKICAgICAgdmFyIG1lID0gdGhpczsKCiAgICAgIGlmIChyZXN1bHQgJiYgcmVzdWx0LlN1Y2Nlc3MpIHsKICAgICAgICBtZS4kdG9hc3Quc3VjY2VzcyhtZS4kdCgiaTE4bkJhc2VGb3JtLlNhdmVTdWNjZXNzTWVzc2FnZSIpKTsKICAgICAgICBtZS5zZWxlY3RlZCA9IFtdOwogICAgICAgIG1lLnJlbG9hZCgpOwogICAgICAgIG1lLmN1c3RvbUFmdGVyVXBkYXRlKHJlY29yZCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWUuJHRvYXN0LmVycm9yKG1lLiR0KCJpMThuQmFzZUZvcm0uTWVzc2FnZS5FcnJvciIpKTsKICAgICAgfQogICAgfSwKCiAgICAvKioNCiAgICAgKiBM4bqleSBvcmdhbml6YXRpb25JRCDEkeG7gyB1cGRhdGUgc3RhdHVzLC4uLg0KICAgICAqIFRETkdISUEgMTYvMTEvMjAyMQ0KICAgICAqIEByZXR1cm5zDQogICAgICovCiAgICBnZXRPcmdhbml6YXRpb25GaWx0ZXI6IGZ1bmN0aW9uIGdldE9yZ2FuaXphdGlvbkZpbHRlcigpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEjDoG0gY3VzdG9tIHjhu60gbMO9IHNhdSBraGkgY+G6rXAgbmjhuq10IHRy4bqhbmcgdGjDoWkNCiAgICAgKiBOTVRVQU4zIDE1LzMvMjAyMg0KICAgICAqIEBwYXJhbSB7Kn0gcmVjb3JkIGLhuqNuIGdoaSBj4bqtcCBuaOG6rXQgdHLhuqFuZyB0aMOhaQ0KICAgICAqLwogICAgY3VzdG9tQWZ0ZXJVcGRhdGU6IGZ1bmN0aW9uIGN1c3RvbUFmdGVyVXBkYXRlKHJlY29yZCkge30KICB9KSwKICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiBiZWZvcmVEZXN0cm95KCkgewogICAgdGhpcy5yZW1vdmVFdmVudCgpOwogIH0KfTs="},null]}