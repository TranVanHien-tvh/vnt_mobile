{"remainingRequest":"D:\\VNT_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\VNT_vue\\src\\views\\dictionary\\employee\\Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\VNT_vue\\src\\views\\dictionary\\employee\\Detail.vue","mtime":1653205086735},{"path":"D:\\VNT_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\VNT_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\VNT_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\VNT_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgcG9wdXBVdGlsIGZyb20gIkAvY29tbW9ucy9wb3B1cFV0aWwiOw0KaW1wb3J0IG1zR3JpZFZpZXdlciBmcm9tICJAL2NvbXBvbmVudHMvbXNncmlkdmlld2VyL21zR3JpZFZpZXdlci52dWUiOw0KaW1wb3J0IG1zQWN0aXZlIGZyb20gIkAvY29tcG9uZW50cy9tc2FjdGl2ZS9tc0FjdGl2ZSI7DQppbXBvcnQgQmFzZURldGFpbFBvcHVwIGZyb20gIkAvdmlld3MvYmFzZS9CYXNlRGV0YWlsUG9wdXAiOw0KaW1wb3J0IHsNCiAgTW9kdWxlTG9jYXRpb24sDQogIE1vZHVsZUVtcGxveWVlLA0KICBNb2R1bGVKb2JQb3NpdGlvbiwNCn0gZnJvbSAiQC9zdG9yZXMvbW9kdWxlLWNvbnN0IjsNCmltcG9ydCB7IGxvY2F0aW9uRGF0YSB9IGZyb20gIkAvbWl4aW5zL2NvbWJvYm94L2xvY2F0aW9uLmpzIjsNCmltcG9ydCBFdmVudEJ1c0dsb2JhbCwgeyBHbG9iYWxFdmVudE5hbWUgfSBmcm9tICJAL2NvbW1vbnMvZXZlbnRCdXNHbG9iYWwiOw0KaW1wb3J0IGNvbW1vbkZuIGZyb20gIkAvY29tbW9ucy9jb21tb25GdW5jdGlvbiI7DQppbXBvcnQgeyBkZXBhcnRtZW50TGlzdCB9IGZyb20gIkAvbWl4aW5zL2NvbWJvYm94L2RlcGFydG1lbnRMaXN0IjsNCmltcG9ydCB7IHBpY2tMaXN0IH0gZnJvbSAiQC9taXhpbnMvY29tYm9ib3gvcGlja0xpc3QiOw0KaW1wb3J0IHsgam9iUG9zaXRpb25Tb3VyY2UgfSBmcm9tICJAL21peGlucy9jb21ib2JveC9qb2JQb3NpdGlvbiI7DQppbXBvcnQgbXNEb3duTG9hZFZ1ZSBmcm9tICJAL2NvbXBvbmVudHMvbXNkb3dubG9hZC9tc0Rvd25Mb2FkLnZ1ZSI7DQppbXBvcnQgQXR0YWNobWVudERldGFpbEFQSSBmcm9tICJAL2FwaXMvc3lzdGVtL2F0dGFjaG1lbnREZXRhaWxBUEkuanMiOw0KaW1wb3J0IGZpbGVBcGkgZnJvbSAiQC9hcGlzL3N5c3RlbS9maWxlQVBJIjsNCmltcG9ydCBQaWNrTGlzdEFQSSBmcm9tICJAL2FwaXMvZGljdGlvbmFyeS9waWNrTGlzdEFQSSI7DQppbXBvcnQgTXNTaW5nbGVBdHRhY2htZW50IGZyb20gIkAvY29tcG9uZW50cy9tc2F0dGFjaG1lbnQvbXNTaW5nbGVBdHRhY2htZW50LnZ1ZSI7DQppbXBvcnQgSW1hZ2VBUEkgZnJvbSAiQC9hcGlzL3N5c3RlbS9pbWFnZUFQSSI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIkRldGFpbGVtcGxveWVlIiwNCiAgY29tcG9uZW50czogew0KICAgIG1zR3JpZFZpZXdlciwNCiAgICBNc1NpbmdsZUF0dGFjaG1lbnQsDQogIH0sDQogIGV4dGVuZHM6IEJhc2VEZXRhaWxQb3B1cCwNCg0KICBtaXhpbnM6IFtsb2NhdGlvbkRhdGEsIGRlcGFydG1lbnRMaXN0LCBqb2JQb3NpdGlvblNvdXJjZSwgcGlja0xpc3RdLA0KDQogIGRhdGEoKSB7DQogICAgY29uc3QgbWUgPSB0aGlzOw0KDQogICAgbWUuc2V0RGF0YUNvbWJvKCk7DQogICAgbWUuc2V0RGF0YUdyaWQoKTsNCiAgICBtZS5UaW1lVHlwZUluUGVyaW9kID0gbWUuJG1zLmNvbW1vbkZuLmdldEVudW1Tb3VyY2UoIlRpbWVUeXBlSW5QZXJpb2QiKTsNCiAgICBtZS5UaW1lVHlwZUluUGVyaW9kLnNwbGljZSgxLCAxKTsNCiAgICBtZS5UaW1lVHlwZUluUGVyaW9kID0gbWUuVGltZVR5cGVJblBlcmlvZC5tYXAoKGl0ZW0pID0+IHsNCiAgICAgIGlmIChpdGVtLmVudW1WYWx1ZSA9PT0gMikgew0KICAgICAgICBpdGVtLmVudW1WYWx1ZSA9IDE7DQogICAgICB9DQogICAgICByZXR1cm4gaXRlbTsNCiAgICB9KTsNCg0KICAgIHJldHVybiB7DQogICAgICBtb2R1bGU6IE1vZHVsZUVtcGxveWVlLA0KICAgICAgYWN0aXZlOiBmYWxzZSwNCiAgICAgIGlzRnVsbFNjcmVlbjogZmFsc2UsDQogICAgICBsaXN0SXRlbVRhYjogW10sDQogICAgICBhY3RpdmVTdWJzeXN0ZW06ICJnZW5lcmFsSW5mbyIsDQogICAgICBhY3RpdmVQYXJlbnRTdWJzeXN0ZW06ICJnZW5lcmFsSW5mbyIsDQogICAgICBjYWNoZUNoaWxkcmVuVGFiOiBbXSwNCiAgICAgIHByb3ZpbmNlRGF0YTogW10sDQogICAgICBkaXN0cmljdERhdGFIb21lOiBbXSwNCiAgICAgIGRpc3RyaWN0RGF0YVBlcm1hbmVudDogW10sDQogICAgICBkaXN0cmljdERhdGFDdXJyZW50OiBbXSwNCiAgICAgIHdhcmREYXRhSG9tZTogW10sDQogICAgICB3YXJkRGF0YVBlcm1hbmVudDogW10sDQogICAgICB3YXJkRGF0YUN1cnJlbnQ6IFtdLA0KICAgICAgam9iUG9zaXRpb246IFtdLA0KICAgICAgam9iVGl0bGU6IFtdLA0KICAgICAgZW1wdHlBcnI6IFtdLA0KICAgICAgcmV3YXJkQ2F0ZWdvcnlEZXRhaWxEYXRhOiBbXSwNCiAgICAgIGVtdWxhdGlvblRpdGxlRGV0YWlsRGF0YTogW10sDQogICAgICBhdmF0YXJVcmw6IG51bGwsDQogICAgICBhdmF0YXJGaWxlOiBudWxsLA0KICAgICAgcm93QWN0aW9uczogWw0KICAgICAgICB7DQogICAgICAgICAgY29tbWFuZDogIkVkaXQiLA0KICAgICAgICAgIGljb246ICJlZGl0IiwNCiAgICAgICAgICB0ZXh0OiB0aGlzLiR0KCJpMThuQ29tbW9uLmNvbW1hbmQuZWRpdCIpLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgY29tbWFuZDogIkRlbGV0ZSIsDQogICAgICAgICAgaWNvbjogImRlbGV0ZSIsDQogICAgICAgICAgdGV4dDogdGhpcy4kdCgiaTE4bkNvbW1vbi5jb21tYW5kLmRlbGV0ZSIpLA0KICAgICAgICB9LA0KICAgICAgXSwNCiAgICAgIEF0dGFjaG1lbnRSb3dBY3Rpb25zOiBbDQogICAgICAgIHsNCiAgICAgICAgICBjb21tYW5kOiAiRG93bmxvYWQiLA0KICAgICAgICAgIGljb246ICJkb3dubG9hZCIsDQogICAgICAgICAgdGV4dDogdGhpcy4kdCgiaTE4bkNvbW1vbi5jb21tYW5kLmRvd25sb2FkIiksDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBjb21tYW5kOiAiRGVsZXRlIiwNCiAgICAgICAgICBpY29uOiAiZGVsZXRlIiwNCiAgICAgICAgICB0ZXh0OiB0aGlzLiR0KCJpMThuQ29tbW9uLmNvbW1hbmQuZGVsZXRlIiksDQogICAgICAgIH0sDQogICAgICBdLA0KICAgICAgbGlzdFNvdXJjZVdvcmtpbmdEZXRhaWw6IFtdLA0KICAgICAgbGlzdFNvdXJjZU1pc3Npb25Sb2xlOiBbXSwNCiAgICAgIGxpc3RTb3VyY2VFbXVsYXRpb25UaXRsZURldGFpbDogW10sDQogICAgICBsaXN0U291cmNlUmV3YXJkQ2F0ZWdvcnlEZXRhaWw6IFtdLA0KICAgICAgbGlzdFNvdXJjZURpc2NpcGxpbmVEZXRhaWw6IFtdLA0KICAgICAgbGlzdFNvdXJjZUFjaGlldmVtZW50SWRlYTogW10sDQogICAgICBsaXN0U291cmNlQXR0YWNobWVudERldGFpbDogW10sDQogICAgICBpc091dFNpZGVyOiBmYWxzZSwNCiAgICAgIGxpc3REZWxldGVBdHRhY2htZW50OiBbXSwNCiAgICAgIGNoYW5nZUZvcm1hdDogbnVsbCwNCiAgICAgIHR5cGVEYXRlOiAwLA0KICAgICAgbGlzdFNvdXJjZUV2YWx1YXRpb25EZXRhaWw6IFtdLA0KICAgICAgaGlkZUluZm9yOiBmYWxzZSwNCiAgICAgIGhpZGVFbXVsYXRpb25SZXdhcmQ6IGZhbHNlLA0KICAgICAgaGlkZUV2YWx1YXRpb246IGZhbHNlLA0KICAgICAgaGlkZUF0dGFjaG1lbnQ6IGZhbHNlLA0KICAgICAgaGlkZUFjaGlldmVtZW50SWRlYTogZmFsc2UsDQogICAgICBoZWxwSWQ6ICJrbm93bGVkZ2UtYmFzZS9xdWFuLWx5LWhzY24iLA0KICAgICAgZmlsZVNpemVTdW1hcnk6IDAsDQogICAgfTsNCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICBsaXN0U291cmNlQXR0YWNobWVudERldGFpbChuZXdWYWx1ZSkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KDQogICAgICBpZiAobmV3VmFsdWUpIHsNCiAgICAgICAgbWUuY2FjdWxhdGVGaWxlU2l6ZSgpOw0KICAgICAgfQ0KICAgIH0sDQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgY29uc3QgbWUgPSB0aGlzOw0KDQogICAgbWUuZ2V0UHJvdmluY2VEYXRhKCk7DQogIH0sDQoNCiAgbW91bnRlZCgpIHsNCiAgICBjb25zdCBtZSA9IHRoaXM7DQoNCiAgICBtZS4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgbGV0IGl0ZW0gPSBtZS5nZXRDdXJyZW50SXRlbSgpOw0KICAgICAgaWYgKG1lLmVkaXRNb2RlID09IG1lLiRtcy5lbnVtLkZvcm1TdGF0ZS5FZGl0KSB7DQogICAgICAgIG1lLnRpdGxlID0NCiAgICAgICAgICAiU+G7rWEgaOG7kyBzxqEgdGjDoG5oIHTDrWNoICIgKw0KICAgICAgICAgIChpdGVtLkZ1bGxOYW1lID8gImPhu6dhICIgKyBpdGVtLkZ1bGxOYW1lIDogIiIpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgbWUudGl0bGUgPSAiVGjDqm0gbeG7m2kgaOG7kyBzxqEgdGjDoG5oIHTDrWNoIjsNCiAgICAgIH0NCg0KICAgICAgbWUuZ2V0RGlzdHJpY3RCeVByb3ZpbmNlSUQoaXRlbS5Ib21lUHJvdmluY2UsIDEpOw0KICAgICAgbWUuZ2V0RGlzdHJpY3RCeVByb3ZpbmNlSUQoaXRlbS5QZXJtYW5lbnRQcm92aW5jZSwgMik7DQogICAgICBtZS5nZXREaXN0cmljdEJ5UHJvdmluY2VJRChpdGVtLkN1cnJlbnRQcm92aW5jZSwgMyk7DQogICAgICBtZS5nZXRXYXJkQnlEaXN0cmljdElEKGl0ZW0uSG9tZURpc3RyaWN0LCAxKTsNCiAgICAgIG1lLmdldFdhcmRCeURpc3RyaWN0SUQoaXRlbS5QZXJtYW5lbnREaXN0cmljdCwgMik7DQogICAgICBtZS5nZXRXYXJkQnlEaXN0cmljdElEKGl0ZW0uQ3VycmVudERpc3RyaWN0LCAzKTsNCiAgICB9KTsNCg0KICAgIC8vc2V0IGzhuqFpIHbhu4sgdHLDrSBj4bunYSBjw6FjIHRhYiDEkeG7gyBzY3JvbGwgeOG7i24NCiAgICBtZS4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgY29uc3QgY29udGFpbmVySW5mbyA9IHRoaXMuJHJlZnNbDQogICAgICAgICJlbXBsb3llZS1kZXRhaWwiDQogICAgICBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KDQogICAgICBsZXQgdG90YWxIZWlnaHQgPSAwOw0KICAgICAgbWUubGlzdEl0ZW1UYWIuZm9yRWFjaCgoaXRlbSkgPT4gew0KICAgICAgICAvL0zhuqV5IHbhu4sgdHLDrSBkaXYgY+G6p24gc2Nyb2xsDQogICAgICAgIGxldCB0YXJnZXQgPSBpdGVtLlNjcm9sbFRhcmdldDsNCg0KICAgICAgICBpZiAodGFyZ2V0KSB7DQogICAgICAgICAgbGV0IHBhbmVsID0gbWUuJHJlZnNbdGFyZ2V0XTsNCiAgICAgICAgICBpZiAocGFuZWwpIHsNCiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHBhbmVsKSAmJiBwYW5lbC5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgIHBhbmVsID0gcGFuZWxbMF07DQogICAgICAgICAgICB9DQogICAgICAgICAgICBsZXQgaW5mbyA9IHBhbmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICAgICAgaXRlbS5TY3JvbGxUb3AgPSBpbmZvLnRvcCAtIGNvbnRhaW5lckluZm8udG9wOw0KICAgICAgICAgICAgdG90YWxIZWlnaHQgKz0gaW5mby5oZWlnaHQ7DQogICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGl0ZW0uQ2hpbGRyZW4gJiYgaXRlbS5DaGlsZHJlbi5sZW5ndGggPiAwKSB7DQogICAgICAgICAgaXRlbS5DaGlsZHJlbi5mb3JFYWNoKChjaGlsZCkgPT4gew0KICAgICAgICAgICAgLy9M4bqleSB24buLIHRyw60gZGl2IGPhuqduIHNjcm9sbA0KICAgICAgICAgICAgbGV0IHRhcmdldCA9IGNoaWxkLlNjcm9sbFRhcmdldDsNCg0KICAgICAgICAgICAgaWYgKHRhcmdldCkgew0KICAgICAgICAgICAgICBsZXQgcGFuZWwgPSBtZS4kcmVmc1t0YXJnZXRdOw0KICAgICAgICAgICAgICBpZiAocGFuZWwpIHsNCiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwYW5lbCkgJiYgcGFuZWwubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgcGFuZWwgPSBwYW5lbFswXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgbGV0IGluZm8gPSBwYW5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgICAgICAgICBjaGlsZC5TY3JvbGxUb3AgPSBpbmZvLnRvcCAtIGNvbnRhaW5lckluZm8udG9wOw0KICAgICAgICAgICAgICAgIHRvdGFsSGVpZ2h0ICs9IGluZm8uaGVpZ2h0Ow0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIC8vQ2FjaGUgbOG6oWkgbGlzdCBjw6FjIGNoaWxkcmVuDQogICAgICAgICAgICAgIG1lLmNhY2hlQ2hpbGRyZW5UYWIucHVzaChjaGlsZCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgbWUuY2FjaGVDaGlsZHJlblRhYi5wdXNoKGl0ZW0pOw0KICAgICAgICB9DQogICAgICAgIC8vVEROR0hJQSA2LzQvMjAyMTogc2F1IGtoaSBzZXQgduG7iyB0csOtIGNobyBjw6FjIG1lbnUgbeG7m2kgdGh1IGfhu41uIG1lbnUgbOG6oWkNCiAgICAgICAgbWUuaGlkZUluZm9yID0gZmFsc2U7DQogICAgICAgIG1lLmhpZGVFbXVsYXRpb25SZXdhcmQgPSB0cnVlOw0KICAgICAgICBtZS5oaWRlRXZhbHVhdGlvbiA9IHRydWU7DQogICAgICAgIG1lLmhpZGVBdHRhY2htZW50ID0gdHJ1ZTsNCiAgICAgICAgbWUuaGlkZUFjaGlldmVtZW50SWRlYSA9IHRydWU7DQogICAgICB9KTsNCiAgICB9KTsNCiAgfSwNCg0KICBtZXRob2RzOiB7DQogICAgZ2V0RW50aXR5VHlwZSgpIHsNCiAgICAgIHJldHVybiAiZGV0YWlsZW1wbG95ZWUiOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBIw6BtIHRo4buxYyBoaeG7h24gdHLGsOG7m2Mga2hpIHNob3dwb3B1cA0KICAgICAqIETDuW5nIMSR4buDIGZvcm0gdOG7sSBvdmVyaWRlIGzhuqFpIHRoZW8gbmdoaeG7h3AgduG7pSB0xrDGoW5nIOG7qW5nDQogICAgICogQ3JlYXRlZCBieSBMVERBVCAyMi4wNi4yMDIwDQogICAgICovDQogICAgYmVmb3JlU2hvd1BvcHVwKHBhcmFtKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQoNCiAgICAgIG1lLmlzT3V0U2lkZXIgPSBtZS5vcHRpb25zLmlzT3V0U2lkZXI7DQogICAgICBtZS5pc0Z1bGxTY3JlZW4gPQ0KICAgICAgICBtZS5vcHRpb25zLmlzRnVsbFNjcmVlbiA9PSB0cnVlID8gdHJ1ZSA6IG1lLmlzRnVsbFNjcmVlbjsNCiAgICAgIG1lLnNldE1lbnVUYWIoKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogQ3VzdG9tIGzhuqFpIGN1cnJlbnRJdGVtIHRyxrDhu5tjIGtoaSBkw7luZyDEkeG7gyBiaW5kIGThu68gbGnhu4d1IHbDoCDDqXAga2nhu4N1IEpTT04gdGjDoG5oIE9iamVjdA0KICAgICAqIFRETkdISSAyMi85LzIwMjENCiAgICAgKi8NCiAgICBiZWZvcmVCaW5kRGF0YSgpIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCg0KICAgICAgbWUuY3VycmVudEl0ZW0uRGF0ZU9mQmlydGggPQ0KICAgICAgICBtZS5jdXJyZW50SXRlbS5EYXRlT2ZCaXJ0aCA9PT0gIiIgPyBudWxsIDogbWUuY3VycmVudEl0ZW0uRGF0ZU9mQmlydGg7DQogICAgICBtZS5saXN0U291cmNlV29ya2luZ0RldGFpbCA9IHRoaXMuJG1zLmNvbW1vbkZuLnNvcnRBcnJheSgNCiAgICAgICAgdGhpcy4kbXMuZW51bS5Tb3J0U3RhdHVzLmRlc2MsDQogICAgICAgIEpTT04ucGFyc2UobWUuY3VycmVudEl0ZW0uV29ya2luZ0RldGFpbCksDQogICAgICAgICJUb0RhdGUiDQogICAgICApOw0KICAgICAgbWUubGlzdFNvdXJjZU1pc3Npb25Sb2xlID0gSlNPTi5wYXJzZShtZS5jdXJyZW50SXRlbS5NaXNzaW9uUm9sZSk7DQogICAgICBtZS5saXN0U291cmNlQWNoaWV2ZW1lbnRJZGVhID0gSlNPTi5wYXJzZShtZS5jdXJyZW50SXRlbS5BY2hpZXZlbWVudElkZWEpOw0KICAgICAgbWUubGlzdFNvdXJjZUV2YWx1YXRpb25EZXRhaWwgPSBKU09OLnBhcnNlKA0KICAgICAgICBtZS5jdXJyZW50SXRlbS5FdmFsdWF0aW9uRGV0YWlsDQogICAgICApOw0KICAgICAgbWUubGlzdFNvdXJjZUVtdWxhdGlvblRpdGxlRGV0YWlsID0gSlNPTi5wYXJzZSgNCiAgICAgICAgbWUuY3VycmVudEl0ZW0uRW11bGF0aW9uVGl0bGVEZXRhaWwNCiAgICAgICk7DQogICAgICBtZS5saXN0U291cmNlUmV3YXJkQ2F0ZWdvcnlEZXRhaWwgPSBKU09OLnBhcnNlKA0KICAgICAgICBtZS5jdXJyZW50SXRlbS5SZXdhcmRDYXRlZ29yeURldGFpbA0KICAgICAgKTsNCg0KICAgICAgLy9LaGkgbOG6pXkgdHLDqm4gZGIgduG7gSA9PiBnw6FuIHRy4bqhbmcgdGjDoWkgY+G7p2EgYuG6o24gZ2hpIGF0dGFjaG1lbnQgbMOgIHVwZGF0ZSBOVERJRU0gMjMuMTEuMjAyMQ0KICAgICAgbWUuY3VycmVudEl0ZW0uQXR0YWNobWVudERldGFpbC5mb3JFYWNoKChpdGVtKSA9PiB7DQogICAgICAgIGl0ZW0uRW50aXR5U3RhdGUgPSBtZS4kbXMuZW51bS5Nb2RlbFN0YXRlLlVwZGF0ZTsNCiAgICAgIH0pOw0KICAgICAgbWUubGlzdFNvdXJjZUF0dGFjaG1lbnREZXRhaWwgPSBtZS5jdXJyZW50SXRlbS5BdHRhY2htZW50RGV0YWlsOw0KDQogICAgICBtZS5saXN0U291cmNlRGlzY2lwbGluZURldGFpbCA9IEpTT04ucGFyc2UoDQogICAgICAgIG1lLmN1cnJlbnRJdGVtLkRpc2NpcGxpbmVEZXRhaWwNCiAgICAgICk7DQoNCiAgICAgIG1lLmN1cnJlbnRJdGVtLklzT3V0U2lkZXIgPSBtZS5pc091dFNpZGVyOw0KDQogICAgICBpZiAoIW1lLmN1cnJlbnRJdGVtLk9yZ2FuaXphdGlvbk5hbWUgJiYgIW1lLmlzT3V0U2lkZXIpIHsNCiAgICAgICAgbWUuY3VycmVudEl0ZW0uT3JnYW5pemF0aW9uTmFtZSA9DQogICAgICAgICAgbWUuY29udGV4dC5Pcmdhbml6YXRpb24uT3JnYW5pemF0aW9uTmFtZTsNCiAgICAgIH0NCg0KICAgICAgaWYgKG1lLmVkaXRNb2RlID09PSBtZS4kbXMuZW51bS5Gb3JtU3RhdGUuQWRkKSB7DQogICAgICAgIG1lLiRyZWZzLmNib0pvYlBvc2l0aW9uLnJlc2V0KCk7DQogICAgICAgIG1lLiRyZWZzLmNib0pvYlRpdGxlLnJlc2V0KCk7DQoNCiAgICAgICAgLy8gTk1UVUFOMyAyLzEyLzIwMjE6IHRow6ptIGNoZWNrIHThu5NuIHThuqFpIHbDrCByZWYgbsOgeSBraMO0bmcgY8OzIGtoaSB0aMOqbSBjw6EgbmjDom4gbmdvw6BpIMSRxqFuIHbhu4sNCiAgICAgICAgaWYgKG1lLiRyZWZzLmNib0RlcGFydG1lbnQpIHsNCiAgICAgICAgICBtZS4kcmVmcy5jYm9EZXBhcnRtZW50LnJlc2V0KCk7DQogICAgICAgIH0NCiAgICAgICAgbWUuY3VycmVudEl0ZW0uR2VuZGVyID0gMTsNCg0KICAgICAgICAvL2RlZmF1bHQgbMO6YyB0aMOqbSBt4bubaSBtw6AgY2jGsGEgY8OzIGVtcGxveWVlQ29kZSB0aMOsIGNobyAgPSBTSENCMDAwMQ0KICAgICAgICBtZS5jdXJyZW50SXRlbS5FbXBsb3llZUNvZGUgPSBtZS5jdXJyZW50SXRlbS5FbXBsb3llZUNvZGUNCiAgICAgICAgICA/IG1lLmN1cnJlbnRJdGVtLkVtcGxveWVlQ29kZQ0KICAgICAgICAgIDogIlNIQ0IwMDAxIjsNCiAgICAgIH0NCiAgICAgIG1lLmN1cnJlbnRJdGVtLkF0dGFjaG1lbnRDaGFuZ2VzID0gW107DQoNCiAgICAgIGlmIChtZS5jdXJyZW50SXRlbS5EYXRlT2ZCaXJ0aCAhPT0gbnVsbCkgew0KICAgICAgICBtZS5jdXJyZW50SXRlbS5UaW1lVHlwZSA9PT0gbnVsbA0KICAgICAgICAgID8gbWUuY3VycmVudEl0ZW0uRGF0ZU9mQmlydGgubGVuZ3RoID4gMCAmJg0KICAgICAgICAgICAgbWUuY3VycmVudEl0ZW0uRGF0ZU9mQmlydGgubGVuZ3RoID09PSA0DQogICAgICAgICAgICA/IChtZS5jdXJyZW50SXRlbS5UaW1lVHlwZSA9IDEpDQogICAgICAgICAgICA6IChtZS5jdXJyZW50SXRlbS5UaW1lVHlwZSA9IDApDQogICAgICAgICAgOiBtZS5jdXJyZW50SXRlbS5UaW1lVHlwZTsNCiAgICAgICAgaWYgKG1lLmN1cnJlbnRJdGVtLlRpbWVUeXBlID09PSAwKSB7DQogICAgICAgICAgbWUuY3VycmVudEl0ZW0uRGF0ZU9mQmlydGggPSBtZS4kbXMuY29tbW9uRm4uY29udmVydFN0cmluZ1RvRGF0ZSgNCiAgICAgICAgICAgIG1lLmN1cnJlbnRJdGVtLkRhdGVPZkJpcnRoLA0KICAgICAgICAgICAgIi8iLA0KICAgICAgICAgICAgMQ0KICAgICAgICAgICk7DQogICAgICAgIH0NCiAgICAgIH0gZWxzZSB7DQogICAgICAgIG1lLmN1cnJlbnRJdGVtLlRpbWVUeXBlID0NCiAgICAgICAgICBtZS5jdXJyZW50SXRlbS5UaW1lVHlwZSA9PT0gbnVsbCA/IDAgOiBtZS5jdXJyZW50SXRlbS5UaW1lVHlwZTsNCiAgICAgIH0NCiAgICAgIC8vTOG6pXkgYXZhdGFyIE5URElFTSAxNy8wMy8yMDIyDQogICAgICBtZS5zZXRBdmF0YXIoKTsNCiAgICB9LA0KDQogICAgYXN5bmMgZ2V0QXV0b0lEKCkgew0KICAgICAgbGV0IHJlc3VsdCA9ICIiLA0KICAgICAgICBtZSA9IHRoaXM7DQogICAgICB0cnkgew0KICAgICAgICByZXN1bHQgPSBhd2FpdCBtZS4kc3RvcmUuZGlzcGF0Y2goYCR7bWUubW9kdWxlfS9nZXRBdXRvSURgKTsNCiAgICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICBjb25zb2xlLmVycm9yKGVycik7DQogICAgICB9DQogICAgICByZXR1cm4gcmVzdWx0Ow0KICAgIH0sDQogICAgLyoqDQogICAgICogVGjhu7FjIGhp4buHbiBnw6FuIGRhdGEgdsOgIGNvbHVtbnMgY2hvIGPDoWMgYuG6o25nDQogICAgICogVEROR0hJQSAyMS85LzIwMjENCiAgICAgKi8NCiAgICBzZXREYXRhR3JpZCgpIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCg0KICAgICAgLy9C4bqjbmcgcXXDoSB0csOsbmggY8O0bmcgdMOhYw0KICAgICAgbWUuY29sdW1uV29ya2luZ0RldGFpbCA9IFsNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJUaOG7nWkgZ2lhbiIsDQogICAgICAgICAgZGF0YUZpZWxkOiAiV29ya2luZ1RpbWUiLA0KICAgICAgICAgIHdpZHRoOiAxNjAsDQogICAgICAgICAgYXV0b1Jlc2l6ZTogZmFsc2UsDQogICAgICAgICAgYWxpZ246ICJjZW50ZXIiLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgY2FwdGlvbjogIsSQxqFuIHbhu4siLA0KICAgICAgICAgIGRhdGFGaWVsZDogIk9yZ2FuaXphdGlvbk5hbWUiLA0KICAgICAgICAgIHdpZHRoOiAyMDAsDQogICAgICAgICAgYXV0b1Jlc2l6ZTogdHJ1ZSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJQaMOybmcgYmFuIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJEZXBhcnRtZW50TmFtZSIsDQogICAgICAgICAgd2lkdGg6IDE1MCwNCiAgICAgICAgICBhdXRvUmVzaXplOiB0cnVlLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgY2FwdGlvbjogIkNo4bupYyB24bulIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJKb2JQb3NpdGlvbk5hbWUiLA0KICAgICAgICAgIHdpZHRoOiAxMTAsDQogICAgICAgICAgYXV0b1Jlc2l6ZTogdHJ1ZSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJDaOG7qWMgZGFuaCIsDQogICAgICAgICAgZGF0YUZpZWxkOiAiSm9iVGl0bGVOYW1lIiwNCiAgICAgICAgICB3aWR0aDogMTEwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IHRydWUsDQogICAgICAgIH0sDQogICAgICBdOw0KDQogICAgICAvL0LhuqNuZyBxdXnhu4FuIGjhuqFuDQogICAgICBtZS5jb2x1bW5NaXNzaW9uUm9sZSA9IFsNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJOxINtIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJZZWFyIiwNCiAgICAgICAgICB3aWR0aDogMTAwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IGZhbHNlLA0KICAgICAgICAgIGFsaWduOiAicmlnaHQiLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgY2FwdGlvbjogIlF1eeG7gW4gaOG6oW4sIG5oaeG7h20gduG7pSDEkcaw4bujYyBnaWFvIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJSb2xlTmFtZSIsDQogICAgICAgICAgd2lkdGg6IDIwMCwNCiAgICAgICAgICBhdXRvUmVzaXplOiB0cnVlLA0KICAgICAgICB9LA0KICAgICAgXTsNCg0KICAgICAgLy9C4bqjbmcgdGjDoG5oIHTDrWNoDQogICAgICBtZS5jb2x1bW5BY2hpZXZlbWVudElkZWEgPSBbDQogICAgICAgIHsNCiAgICAgICAgICBjYXB0aW9uOiAiTuG7mWkgZHVuZyBzw6FuZyBraeG6v24iLA0KICAgICAgICAgIGRhdGFGaWVsZDogIkludmVudE5hbWUiLA0KICAgICAgICAgIHdpZHRoOiA0MDAsDQogICAgICAgICAgYXV0b1Jlc2l6ZTogdHJ1ZSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJOxINtIMSR4bqhdCIsDQogICAgICAgICAgZGF0YUZpZWxkOiAiWWVhciIsDQogICAgICAgICAgd2lkdGg6IDEwMCwNCiAgICAgICAgICBhdXRvUmVzaXplOiBmYWxzZSwNCiAgICAgICAgICBhbGlnbjogInJpZ2h0IiwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJD4bqlcCBjw7RuZyBuaOG6rW4iLA0KICAgICAgICAgIGRhdGFGaWVsZDogIkxldmVsIiwNCiAgICAgICAgICBlbnVtOiAiSW52ZW50QXBwcm92ZUxldmVsIiwNCiAgICAgICAgICBmb3JtYXRUeXBlOiBtZS4kbXMuZW51bS5Gb3JtYXRUeXBlLkVudW0sDQogICAgICAgICAgd2lkdGg6IDIwMCwNCiAgICAgICAgICBhdXRvUmVzaXplOiB0cnVlLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgY2FwdGlvbjogIlThu4dwIMSRw61uaCBrw6htIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJBdHRhY2htZW50TmFtZSIsDQogICAgICAgICAgd2lkdGg6IDMwMCwNCiAgICAgICAgICBhdXRvUmVzaXplOiB0cnVlLA0KICAgICAgICAgIHRlbXBsYXRlOiBtc0Rvd25Mb2FkVnVlLA0KICAgICAgICAgIGNsc0N1c3RvbTogImJsdWUtdGV4dCIsDQogICAgICAgIH0sDQogICAgICBdOw0KDQogICAgICAvL2LhuqNuZyBkYW5oIGhp4buHdSB0aGkgxJF1YQ0KICAgICAgbWUuZW11bGF0aW9uVGl0bGVDb2x1bW5zID0gWw0KICAgICAgICB7DQogICAgICAgICAgY2FwdGlvbjogIk7Eg20gxJHhuqF0IGRhbmggaGnhu4d1IiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJZZWFyIiwNCiAgICAgICAgICB3aWR0aDogMTgwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IGZhbHNlLA0KICAgICAgICAgIGFsaWduOiAicmlnaHQiLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgY2FwdGlvbjogIkRhbmggaGnhu4d1IHRoaSDEkXVhIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJFbXVsYXRpb25UaXRsZU5hbWUiLA0KICAgICAgICAgIHdpZHRoOiAyMDAsDQogICAgICAgICAgYXV0b1Jlc2l6ZTogdHJ1ZSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJT4buRIHF1eeG6v3QgxJHhu4tuaCIsDQogICAgICAgICAgZGF0YUZpZWxkOiAiTnVtYmVyIiwNCiAgICAgICAgICB3aWR0aDogMTUwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IHRydWUsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBjYXB0aW9uOiAiTmfDoHkgcXV54bq/dCDEkeG7i25oIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJEYXRlIiwNCiAgICAgICAgICBmb3JtYXRUeXBlOiB0aGlzLiRtcy5lbnVtLkZvcm1hdFR5cGUuRGF0ZSwNCiAgICAgICAgICB3aWR0aDogMTUwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IGZhbHNlLA0KICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJDxqEgcXVhbiByYSBxdXnhur90IMSR4buLbmgiLA0KICAgICAgICAgIGRhdGFGaWVsZDogIk9yZ2FuaXphdGlvbkJlbG9uZyIsDQogICAgICAgICAgd2lkdGg6IDIwMCwNCiAgICAgICAgICBhdXRvUmVzaXplOiB0cnVlLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgY2FwdGlvbjogIlThu4dwIMSRw61uaCBrw6htIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJBdHRhY2htZW50TmFtZSIsDQogICAgICAgICAgd2lkdGg6IDMwMCwNCiAgICAgICAgICBhdXRvUmVzaXplOiB0cnVlLA0KICAgICAgICAgIHRlbXBsYXRlOiBtc0Rvd25Mb2FkVnVlLA0KICAgICAgICAgIGNsc0N1c3RvbTogImJsdWUtdGV4dCIsDQogICAgICAgIH0sDQogICAgICBdOw0KDQogICAgICAvL0LhuqNuZyBow6xuaCB0aOG7qWMga2hlbiB0aMaw4bufbmcNCiAgICAgIG1lLnJld2FyZENhdGVnb3J5Q29sdW1ucyA9IFsNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJOxINtIMSRxrDhu6NjIGtoZW4gdGjGsOG7n25nIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJZZWFyIiwNCiAgICAgICAgICB3aWR0aDogMTgwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IGZhbHNlLA0KICAgICAgICAgIGFsaWduOiAicmlnaHQiLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgY2FwdGlvbjogIkjDrG5oIHRo4bupYyBraGVuIHRoxrDhu59uZyIsDQogICAgICAgICAgZGF0YUZpZWxkOiAiUmV3YXJkQ2F0ZWdvcnlOYW1lIiwNCiAgICAgICAgICB3aWR0aDogMjAwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IHRydWUsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBjYXB0aW9uOiAiU+G7kSBxdXnhur90IMSR4buLbmgiLA0KICAgICAgICAgIGRhdGFGaWVsZDogIk51bWJlciIsDQogICAgICAgICAgd2lkdGg6IDE1MCwNCiAgICAgICAgICBhdXRvUmVzaXplOiB0cnVlLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgY2FwdGlvbjogIk5nw6B5IHF1eeG6v3QgxJHhu4tuaCIsDQogICAgICAgICAgZGF0YUZpZWxkOiAiRGF0ZSIsDQogICAgICAgICAgZm9ybWF0VHlwZTogdGhpcy4kbXMuZW51bS5Gb3JtYXRUeXBlLkRhdGUsDQogICAgICAgICAgd2lkdGg6IDE1MCwNCiAgICAgICAgICBhdXRvUmVzaXplOiBmYWxzZSwNCiAgICAgICAgICBhbGlnbjogImNlbnRlciIsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBjYXB0aW9uOiAiQ8ahIHF1YW4gcmEgcXV54bq/dCDEkeG7i25oIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJPcmdhbml6YXRpb25CZWxvbmciLA0KICAgICAgICAgIHdpZHRoOiAyMDAsDQogICAgICAgICAgYXV0b1Jlc2l6ZTogdHJ1ZSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJU4buHcCDEkcOtbmgga8OobSIsDQogICAgICAgICAgZGF0YUZpZWxkOiAiQXR0YWNobWVudE5hbWUiLA0KICAgICAgICAgIHdpZHRoOiAzMDAsDQogICAgICAgICAgYXV0b1Jlc2l6ZTogdHJ1ZSwNCiAgICAgICAgICB0ZW1wbGF0ZTogbXNEb3duTG9hZFZ1ZSwNCiAgICAgICAgICBjbHNDdXN0b206ICJibHVlLXRleHQiLA0KICAgICAgICB9LA0KICAgICAgXTsNCg0KICAgICAgLy9L4bu3IGx14bqtdA0KICAgICAgbWUuY29sdW1uc0Rpc2NpcGxpbmVEZXRhaWwgPSBbDQogICAgICAgIHsNCiAgICAgICAgICBjYXB0aW9uOiAiTuG7mWkgZHVuZyBr4bu3IGx14bqtdCIsDQogICAgICAgICAgZGF0YUZpZWxkOiAiRGlzY2lwbGluZUNvbnRlbnQiLA0KICAgICAgICAgIHdpZHRoOiAxMjAsDQogICAgICAgICAgYXV0b1Jlc2l6ZTogdHJ1ZSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJIw6xuaCB0aOG7qWMga+G7tyBsdeG6rXQiLA0KICAgICAgICAgIGRhdGFGaWVsZDogIkRpc2NpcGxpbmVUeXBlIiwNCiAgICAgICAgICB3aWR0aDogMTIwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IHRydWUsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBjYXB0aW9uOiAiTmfDoHkgaGnhu4d1IGzhu7FjIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJGcm9tRGF0ZSIsDQogICAgICAgICAgZm9ybWF0VHlwZTogdGhpcy4kbXMuZW51bS5Gb3JtYXRUeXBlLkRhdGUsDQogICAgICAgICAgd2lkdGg6IDEyMCwNCiAgICAgICAgICBhdXRvUmVzaXplOiBmYWxzZSwNCiAgICAgICAgICBhbGlnbjogImNlbnRlciIsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBjYXB0aW9uOiAiTmfDoHkgaOG6v3QgaGnhu4d1IGzhu7FjIiwNCiAgICAgICAgICBmb3JtYXRUeXBlOiB0aGlzLiRtcy5lbnVtLkZvcm1hdFR5cGUuRGF0ZSwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJUb0RhdGUiLA0KICAgICAgICAgIHdpZHRoOiAxNDAsDQogICAgICAgICAgYXV0b1Jlc2l6ZTogZmFsc2UsDQogICAgICAgICAgYWxpZ246ICJjZW50ZXIiLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgY2FwdGlvbjogIlPhu5EgcXV54bq/dCDEkeG7i25oIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJOdW1iZXIiLA0KICAgICAgICAgIHdpZHRoOiAxMjAsDQogICAgICAgICAgYXV0b1Jlc2l6ZTogZmFsc2UsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBjYXB0aW9uOiAiQ8ahIHF1YW4gcmEgcXV54bq/dCDEkeG7i25oIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJPcmdhbml6YXRpb25CZWxvbmciLA0KICAgICAgICAgIHdpZHRoOiAxMjAsDQogICAgICAgICAgYXV0b1Jlc2l6ZTogdHJ1ZSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJU4buHcCDEkcOtbmgga8OobSIsDQogICAgICAgICAgZGF0YUZpZWxkOiAiQXR0YWNobWVudE5hbWUiLA0KICAgICAgICAgIHdpZHRoOiAzMDAsDQogICAgICAgICAgYXV0b1Jlc2l6ZTogdHJ1ZSwNCiAgICAgICAgICB0ZW1wbGF0ZTogbXNEb3duTG9hZFZ1ZSwNCiAgICAgICAgICBjbHNDdXN0b206ICJibHVlLXRleHQiLA0KICAgICAgICB9LA0KICAgICAgXTsNCg0KICAgICAgLy9C4bqjbmcgxJHDoW5oIGdpw6EsIHjhur9wIGxv4bqhaQ0KICAgICAgbWUuY29sdW1uRXZhbHVhdGlvbkRldGFpbCA9IFsNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJT4buRIHF1eeG6v3QgxJHhu4tuaCIsDQogICAgICAgICAgZGF0YUZpZWxkOiAiTnVtYmVyIiwNCiAgICAgICAgICB3aWR0aDogMTUwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IHRydWUsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBjYXB0aW9uOiAiTmfDoHkgcXV54bq/dCDEkeG7i25oIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJEYXRlIiwNCiAgICAgICAgICBmb3JtYXRUeXBlOiB0aGlzLiRtcy5lbnVtLkZvcm1hdFR5cGUuRGF0ZSwNCiAgICAgICAgICB3aWR0aDogMTUwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IGZhbHNlLA0KICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJOxINtIMSRw6FuaCBnacOhIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJZZWFyIiwNCiAgICAgICAgICB3aWR0aDogMTIwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IGZhbHNlLA0KICAgICAgICAgIGFsaWduOiAicmlnaHQiLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgY2FwdGlvbjogIkvhur90IHF14bqjIMSRw6FuaCBnacOhIiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJFdmFsdWF0aW9uSUQiLA0KICAgICAgICAgIGVudW06ICJFdmFsdWF0aW9uUmVzdWx0IiwNCiAgICAgICAgICBmb3JtYXRUeXBlOiBtZS4kbXMuZW51bS5Gb3JtYXRUeXBlLkVudW0sDQogICAgICAgICAgd2lkdGg6IDIwMCwNCiAgICAgICAgICBhdXRvUmVzaXplOiB0cnVlLA0KICAgICAgICB9LA0KICAgICAgICAvLyB7DQogICAgICAgIC8vICAgY2FwdGlvbjogIlThu4dwIMSRw61uaCBrw6htIiwNCiAgICAgICAgLy8gICBkYXRhRmllbGQ6ICJBdHRhY2htZW50TmFtZSIsDQogICAgICAgIC8vICAgd2lkdGg6IDMwMCwNCiAgICAgICAgLy8gICBhdXRvUmVzaXplOiB0cnVlLA0KICAgICAgICAvLyAgIHRlbXBsYXRlOiBtc0Rvd25Mb2FkVnVlLA0KICAgICAgICAvLyAgIGNsc0N1c3RvbTogImJsdWUtdGV4dCIsDQogICAgICAgIC8vIH0sDQogICAgICBdOw0KDQogICAgICAvL3TDoGkgbGnhu4d1IMSRw61uaCBrw6htDQogICAgICBtZS5hdHRhY2htZW50Q29sdW1ucyA9IFsNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJUw6puIHTDoGkgbGnhu4d1IiwNCiAgICAgICAgICBkYXRhRmllbGQ6ICJOYW1lIiwNCiAgICAgICAgICB3aWR0aDogMzAwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IHRydWUsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBjYXB0aW9uOiAiVOG7h3AgxJHDrW5oIGvDqG0iLA0KICAgICAgICAgIGRhdGFGaWVsZDogIkF0dGFjaG1lbnROYW1lIiwNCiAgICAgICAgICB3aWR0aDogMzAwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IHRydWUsDQogICAgICAgICAgdGVtcGxhdGU6IG1zRG93bkxvYWRWdWUsDQogICAgICAgICAgY2xzQ3VzdG9tOiAiYmx1ZS10ZXh0IiwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNhcHRpb246ICJOZ8aw4budaSDEkcOtbmgga8OobSIsDQogICAgICAgICAgZGF0YUZpZWxkOiAiQXV0aG9yIiwNCiAgICAgICAgICB3aWR0aDogMTUwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IHRydWUsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBjYXB0aW9uOiAiTmfDoHkgxJHDrW5oIGvDqG0iLA0KICAgICAgICAgIGRhdGFGaWVsZDogIkNyZWF0ZWREYXRlIiwNCiAgICAgICAgICBmb3JtYXRUeXBlOiB0aGlzLiRtcy5lbnVtLkZvcm1hdFR5cGUuRGF0ZSwNCiAgICAgICAgICB3aWR0aDogMTQwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IHRydWUsDQogICAgICAgICAgYWxpZ246ICJjZW50ZXIiLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgY2FwdGlvbjogIkR1bmcgbMaw4bujbmciLA0KICAgICAgICAgIGRhdGFGaWVsZDogIkZpbGVTaXplIiwNCiAgICAgICAgICB3aWR0aDogMTAwLA0KICAgICAgICAgIGF1dG9SZXNpemU6IHRydWUsDQogICAgICAgIH0sDQogICAgICBdOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBTZXQgY8OhYyBnacOhIHRy4buLIGNobyBjb21ibyBiYW4gxJHhuqd1DQogICAgICogxJBhbmcgZmFrZSBk4buvIGxp4buHdQ0KICAgICAqIFRETkdISUEgMjAvOS8yMDIxDQogICAgICovDQogICAgc2V0RGF0YUNvbWJvKCkgew0KICAgICAgdGhpcy5jYm9HZW5kZXJEYXRhID0gWw0KICAgICAgICB7DQogICAgICAgICAgR2VuZGVyOiAxLA0KICAgICAgICAgIEdlbmRlck5hbWU6ICJOYW0iLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgR2VuZGVyOiAwLA0KICAgICAgICAgIEdlbmRlck5hbWU6ICJO4buvIiwNCiAgICAgICAgfSwNCiAgICAgIF07DQoNCiAgICAgIC8vc2V0IGNvbWJvIHRyw6xuaCDEkeG7mSBjaHV5w6puIG3DtG4NCiAgICAgIHRoaXMuY2JvUXVhbGlmaWNhdGlvbiA9IHRoaXMuJHQoImkxOG5QaWNrTGlzdERhdGEuUXVhbGlmaWNhdGlvbiIpOw0KDQogICAgICAvL3NldCBjb21ibyBjaOG7qWMgduG7pSBjaOG7qWMgZGFuaA0KICAgICAgdGhpcy5jYm9Kb2JEYXRhID0gWw0KICAgICAgICB7DQogICAgICAgICAgSUQ6IDEsDQogICAgICAgICAgTmFtZTogIkdpw6FtIMSR4buRYyIsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBJRDogMiwNCiAgICAgICAgICBOYW1lOiAiTmjDom4gdmnDqm4iLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgSUQ6IDMsDQogICAgICAgICAgTmFtZTogIlRoxrAga8O9IiwNCiAgICAgICAgfSwNCiAgICAgIF07DQoNCiAgICAgIC8vc2V0IGNvbWJvIGjhu41jIGjDoG0NCiAgICAgIHRoaXMuY2JvQWNhZGVtaWNSYW5rID0gdGhpcy4kdCgiaTE4blBpY2tMaXN0RGF0YS5BY2FkZW1pY2FSYW5rIik7DQoNCiAgICAgIC8vc2V0IGNvbWJvIGjhu41jIHbhu4sNCiAgICAgIHRoaXMuY2JvQWNhZGVtaWNUaXRsZSA9IHRoaXMuJHQoImkxOG5QaWNrTGlzdERhdGEuQWNhZGVtaWNhVGl0bGUiKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogU+G7sSBraeG7h24gc2VsZWN0IG1lbnV0YWINCiAgICAgKiBURE5HSElBIDIwLzkvMjAyMQ0KICAgICAqLw0KICAgIG1lbnVJdGVtT25DbGljayhpdGVtKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQoNCiAgICAgIGlmICgNCiAgICAgICAgaXRlbS5TdWJTeXN0ZW1Db2RlICE9PSBtZS5hY3RpdmVTdWJzeXN0ZW0gJiYNCiAgICAgICAgaXRlbS5TdWJTeXN0ZW1Db2RlICE9ICJvdGhlciINCiAgICAgICkgew0KICAgICAgICAvL0tp4buDbSB0cmEgeGVtIGPDsyBwaOG6o2kgbMOgIG5vZGUgY2hhIGtow7RuZw0KICAgICAgICBpZiAoaXRlbS5pc1BhcmVudCkgew0KICAgICAgICAgIC8vTuG6v3UgbMOgIG5vZGUgY2hhDQogICAgICAgICAgbWUuYWN0aXZlUGFyZW50U3Vic3lzdGVtID0gaXRlbS5TdWJTeXN0ZW1Db2RlOw0KICAgICAgICAgIG1lLmFjdGl2ZVN1YnN5c3RlbSA9IGl0ZW0uQ2hpbGRyZW4NCiAgICAgICAgICAgID8gaXRlbS5DaGlsZHJlblswXS5TdWJTeXN0ZW1Db2RlDQogICAgICAgICAgICA6IGl0ZW0uU3ViU3lzdGVtQ29kZTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAvL07hur91IGzDoCBub2RlZSBjb24NCiAgICAgICAgICBtZS5hY3RpdmVQYXJlbnRTdWJzeXN0ZW0gPSBpdGVtLlBhcmVudFN1YlN5c3RlbUNvZGU7DQogICAgICAgICAgbWUuYWN0aXZlU3Vic3lzdGVtID0gaXRlbS5TdWJTeXN0ZW1Db2RlOw0KICAgICAgICB9DQoNCiAgICAgICAgbGV0IG1lbnVJbmRleCA9IG1lLmNhY2hlQ2hpbGRyZW5UYWIuaW5kZXhPZihpdGVtKTsNCiAgICAgICAgLy9URE5HSElBIDYvNC8yMDIyOiBjYXNlIHbhu4sgdHLDrSBj4bunYSBtZW51IMSR4buDIG3hu58gZm9ybSByw7p0IGfhu41uIGNobyDEkcO6bmcNCiAgICAgICAgaWYgKG1lbnVJbmRleCA9PSAxMykgew0KICAgICAgICAgIC8vIG1lLmhpZGVFbXVsYXRpb25SZXdhcmQgPSBmYWxzZTsNCiAgICAgICAgICAvLyBtZS5oaWRlRXZhbHVhdGlvbiA9IGZhbHNlOw0KICAgICAgICAgICBtZS5oaWRlQXR0YWNobWVudCA9IGZhbHNlOw0KICAgICAgICAgIC8vIG1lLmhpZGVBY2hpZXZlbWVudElkZWEgPSBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChtZW51SW5kZXggPT0gMTIpIHsNCiAgICAgICAgICAvL21lLmhpZGVFbXVsYXRpb25SZXdhcmQgPSBmYWxzZTsNCiAgICAgICAgICBtZS5oaWRlRXZhbHVhdGlvbiA9IGZhbHNlOw0KICAgICAgICAgIC8vbWUuaGlkZUFjaGlldmVtZW50SWRlYSA9IGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG1lbnVJbmRleCA8IDEyICYmIG1lbnVJbmRleCA+PSA5KSB7DQogICAgICAgICAgbWUuaGlkZUVtdWxhdGlvblJld2FyZCA9IGZhbHNlOw0KICAgICAgICAgIC8vbWUuaGlkZUFjaGlldmVtZW50SWRlYSA9IGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG1lbnVJbmRleCA8IDkgJiYgbWVudUluZGV4ID49IDUpIHsNCiAgICAgICAgICBtZS5oaWRlQWNoaWV2ZW1lbnRJZGVhID0gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgLy9O4bq/dSB0csaw4budbmcgaOG7o3AgY2xpY2sgdsOgbyBtZW51IGNoYQ0KICAgICAgICBpZiAobWVudUluZGV4ID09IC0xKSB7DQogICAgICAgICAgbGV0IG1lbnVQYXJlbnRJbmRleCA9IG1lLmxpc3RJdGVtVGFiLmluZGV4T2YoaXRlbSk7DQogICAgICAgICAgc3dpdGNoIChtZW51UGFyZW50SW5kZXgpIHsNCiAgICAgICAgICAgIGNhc2UgMToNCiAgICAgICAgICAgICAgbWUuaGlkZUFjaGlldmVtZW50SWRlYSA9IGZhbHNlOw0KICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgMjoNCiAgICAgICAgICAgICAgbWUuaGlkZUVtdWxhdGlvblJld2FyZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAvL21lLmhpZGVBY2hpZXZlbWVudElkZWEgPSBmYWxzZTsNCiAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlIDM6DQogICAgICAgICAgICAgIC8vIG1lLmhpZGVFbXVsYXRpb25SZXdhcmQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgbWUuaGlkZUV2YWx1YXRpb24gPSBmYWxzZTsNCiAgICAgICAgICAgICAgLy8gbWUuaGlkZUFjaGlldmVtZW50SWRlYSA9IGZhbHNlOw0KICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgNDoNCiAgICAgICAgICAgICAgLy8gbWUuaGlkZUVtdWxhdGlvblJld2FyZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAvLyBtZS5oaWRlRXZhbHVhdGlvbiA9IGZhbHNlOw0KICAgICAgICAgICAgICBtZS5oaWRlQXR0YWNobWVudCA9IGZhbHNlOw0KICAgICAgICAgICAgICAvLyBtZS5oaWRlQWNoaWV2ZW1lbnRJZGVhID0gZmFsc2U7DQogICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIG1lLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHRoaXMuJHJlZnNbImVtcGxveWVlLWRldGFpbCJdOw0KICAgICAgICAgIGNvbnRhaW5lci5zY3JvbGxUb3AgPSBpdGVtLlNjcm9sbFRvcDsNCiAgICAgICAgfSk7DQogICAgICB9DQoNCiAgICAgIG1lLmlzQ2xpY2tTdWJzeXRlbVJvb3QgPSB0cnVlOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBow6BtIHThu7Egc2Nyb2xsIHbhu4EgxJHDum5nIHRhYiDEkWFuZyBjaOG7jW4NCiAgICAgKiBURE5HSElBIDIwLzkvMjAyMQ0KICAgICAqLw0KICAgIHJpZ2h0RGl2U2Nyb2xsKHNlbmRlcikgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KDQogICAgICAvL0tp4buDbSB0cmEgeGVtIGzDoCBz4buxIGtp4buHbiBrw6lvIGNodeG7mXQgaGF5IGNsaWNrIG1lbnV0YWINCiAgICAgIGlmIChzZW5kZXIgJiYgc2VuZGVyLnRhcmdldCAmJiAhbWUuaXNDbGlja1N1YnN5dGVtUm9vdCkgew0KICAgICAgICBsZXQgb0RpdlNjcm9sbCA9IHNlbmRlci50YXJnZXQ7DQoNCiAgICAgICAgbGV0IGFjdGl2ZWlkID0gbWUuY2FjaGVDaGlsZHJlblRhYlswXS5TdWJTeXN0ZW1Db2RlOw0KICAgICAgICBsZXQgcGFyZW50QWN0aXZlaWQgPSBtZS5jYWNoZUNoaWxkcmVuVGFiWzBdLlN1YlN5c3RlbUNvZGU7DQoNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZS5jYWNoZUNoaWxkcmVuVGFiLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgbGV0IG9TdWJzeXRlbSA9IG1lLmNhY2hlQ2hpbGRyZW5UYWJbaV07DQogICAgICAgICAgaWYgKG9TdWJzeXRlbS5TY3JvbGxUb3AgPD0gb0RpdlNjcm9sbC5zY3JvbGxUb3ApIHsNCiAgICAgICAgICAgIGFjdGl2ZWlkID0gb1N1YnN5dGVtLlN1YlN5c3RlbUNvZGU7DQogICAgICAgICAgICBwYXJlbnRBY3RpdmVpZCA9IG9TdWJzeXRlbS5QYXJlbnRTdWJTeXN0ZW1Db2RlOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICB0aGlzLmFjdGl2ZVN1YnN5c3RlbSA9IGFjdGl2ZWlkOw0KICAgICAgICB0aGlzLmFjdGl2ZVBhcmVudFN1YnN5c3RlbSA9IHBhcmVudEFjdGl2ZWlkOw0KICAgICAgfQ0KICAgICAgbWUuaXNDbGlja1N1YnN5dGVtUm9vdCA9IGZhbHNlOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBDw6BpIMSR4bq3dCBu4buZaSBkdW5nIGNobyBtZW51IGPDoWMgdGFiDQogICAgICogVEROR0hJQSAyMC85LzIwMjENCiAgICAgKi8NCiAgICBzZXRNZW51VGFiKCkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KDQogICAgICBtZS5saXN0SXRlbVRhYiA9IFsNCiAgICAgICAgew0KICAgICAgICAgIGluZGV4OiAxLA0KICAgICAgICAgIHRpdGxlOiAiVGjDtG5nIHRpbiBjaHVuZyIsDQogICAgICAgICAgU3ViU3lzdGVtQ29kZTogImdlbmVyYWxJbmZvIiwNCiAgICAgICAgICBTY3JvbGxUb3A6IDAsDQogICAgICAgICAgaXNQYXJlbnQ6IDEsDQogICAgICAgICAgU2Nyb2xsVGFyZ2V0OiAicG4tZ2VuZXJhbEluZm8iLA0KICAgICAgICAgIENoaWxkcmVuOiBbDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGluZGV4OiAxLA0KICAgICAgICAgICAgICB0aXRsZTogIlRow7RuZyB0aW4gY2h1bmciLA0KICAgICAgICAgICAgICBTdWJTeXN0ZW1Db2RlOiAiZ2VuZXJhbEluZm8iLA0KICAgICAgICAgICAgICBTY3JvbGxUb3A6IDAsDQogICAgICAgICAgICAgIFNjcm9sbFRhcmdldDogInBuLWdlbmVyYWxJbmZvIiwNCiAgICAgICAgICAgICAgUGFyZW50U3ViU3lzdGVtQ29kZTogImdlbmVyYWxJbmZvIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGluZGV4OiAyLA0KICAgICAgICAgICAgICB0aXRsZTogIlF1w6ogcXXDoW4iLA0KICAgICAgICAgICAgICBTdWJTeXN0ZW1Db2RlOiAiaG9tZUFkZHJlc3MiLA0KICAgICAgICAgICAgICBTY3JvbGxUb3A6IDAsDQogICAgICAgICAgICAgIFNjcm9sbFRhcmdldDogInBuLWhvbWVBZGRyZXNzIiwNCiAgICAgICAgICAgICAgUGFyZW50U3ViU3lzdGVtQ29kZTogImdlbmVyYWxJbmZvIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGluZGV4OiAzLA0KICAgICAgICAgICAgICB0aXRsZTogIsSQ4buLYSBjaOG7iSB0aMaw4budbmcgdHLDuiIsDQogICAgICAgICAgICAgIFN1YlN5c3RlbUNvZGU6ICJwZXJtYW5lbnRBZGRyZXNzIiwNCiAgICAgICAgICAgICAgU2Nyb2xsVG9wOiAwLA0KICAgICAgICAgICAgICBTY3JvbGxUYXJnZXQ6ICJwbi1wZXJtYW5lbnRBZGRyZXNzIiwNCiAgICAgICAgICAgICAgUGFyZW50U3ViU3lzdGVtQ29kZTogImdlbmVyYWxJbmZvIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGluZGV4OiA0LA0KICAgICAgICAgICAgICB0aXRsZTogIk7GoWkg4bufIGhp4buHbiBuYXkiLA0KICAgICAgICAgICAgICBTdWJTeXN0ZW1Db2RlOiAiY3VycmVudEFkZHJlc3MiLA0KICAgICAgICAgICAgICBTY3JvbGxUb3A6IDAsDQogICAgICAgICAgICAgIFNjcm9sbFRhcmdldDogInBuLWN1cnJlbnRBZGRyZXNzIiwNCiAgICAgICAgICAgICAgUGFyZW50U3ViU3lzdGVtQ29kZTogImdlbmVyYWxJbmZvIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGluZGV4OiA1LA0KICAgICAgICAgICAgICB0aXRsZTogIlRow7RuZyB0aW4ga2jDoWMiLA0KICAgICAgICAgICAgICBTdWJTeXN0ZW1Db2RlOiAib3RoZXJJbmZvciIsDQogICAgICAgICAgICAgIFNjcm9sbFRvcDogMCwNCiAgICAgICAgICAgICAgU2Nyb2xsVGFyZ2V0OiAicG4tb3RoZXJJbmZvciIsDQogICAgICAgICAgICAgIFBhcmVudFN1YlN5c3RlbUNvZGU6ICJnZW5lcmFsSW5mbyIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgIF0sDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBpbmRleDogMiwNCiAgICAgICAgICB0aXRsZTogIlEuVHLDrG5oIGPDtG5nIHTDoWMsIHPDoW5nIGtp4bq/biIsDQogICAgICAgICAgU3ViU3lzdGVtQ29kZTogIndvcmtQcm9jZXNzIiwNCiAgICAgICAgICBTY3JvbGxUb3A6IDAsDQogICAgICAgICAgaXNQYXJlbnQ6IDEsDQogICAgICAgICAgU2Nyb2xsVGFyZ2V0OiAicG4td29ya1Byb2Nlc3MiLA0KICAgICAgICAgIENoaWxkcmVuOiBbDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGluZGV4OiAxLA0KICAgICAgICAgICAgICB0aXRsZTogIkPDtG5nIHZp4buHYyBoaeG7h24gdOG6oWkiLA0KICAgICAgICAgICAgICBTdWJTeXN0ZW1Db2RlOiAiam9iSW5mbyIsDQogICAgICAgICAgICAgIFNjcm9sbFRvcDogMCwNCiAgICAgICAgICAgICAgU2Nyb2xsVGFyZ2V0OiAicG4tam9iSW5mbyIsDQogICAgICAgICAgICAgIFBhcmVudFN1YlN5c3RlbUNvZGU6ICJ3b3JrUHJvY2VzcyIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBpbmRleDogMiwNCiAgICAgICAgICAgICAgdGl0bGU6ICJRdcOhIHRyw6xuaCBjw7RuZyB0w6FjIiwNCiAgICAgICAgICAgICAgU3ViU3lzdGVtQ29kZTogIndvcmtQcm9jZXNzIiwNCiAgICAgICAgICAgICAgU2Nyb2xsVG9wOiAwLA0KICAgICAgICAgICAgICBTY3JvbGxUYXJnZXQ6ICJwbi13b3JrUHJvY2VzcyIsDQogICAgICAgICAgICAgIFBhcmVudFN1YlN5c3RlbUNvZGU6ICJ3b3JrUHJvY2VzcyIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBpbmRleDogMywNCiAgICAgICAgICAgICAgdGl0bGU6ICJRdXnhu4FuIGjhuqFuLCBuaGnhu4dtIHbhu6UiLA0KICAgICAgICAgICAgICBTdWJTeXN0ZW1Db2RlOiAicm9sZSIsDQogICAgICAgICAgICAgIFNjcm9sbFRvcDogMCwNCiAgICAgICAgICAgICAgU2Nyb2xsVGFyZ2V0OiAicG4tcm9sZSIsDQogICAgICAgICAgICAgIFBhcmVudFN1YlN5c3RlbUNvZGU6ICJ3b3JrUHJvY2VzcyIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBpbmRleDogNCwNCiAgICAgICAgICAgICAgdGl0bGU6ICJTw6FuZyBraeG6v24iLA0KICAgICAgICAgICAgICBTdWJTeXN0ZW1Db2RlOiAiaW52ZW50IiwNCiAgICAgICAgICAgICAgU2Nyb2xsVG9wOiAwLA0KICAgICAgICAgICAgICBTY3JvbGxUYXJnZXQ6ICJwbi1pbnZlbnQiLA0KICAgICAgICAgICAgICBQYXJlbnRTdWJTeXN0ZW1Db2RlOiAid29ya1Byb2Nlc3MiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICBdLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgaW5kZXg6IDMsDQogICAgICAgICAgdGl0bGU6ICJLaGVuIHRoxrDhu59uZywga+G7tyBsdeG6rXQiLA0KICAgICAgICAgIFN1YlN5c3RlbUNvZGU6ICJjZUdvIiwNCiAgICAgICAgICBTY3JvbGxUb3A6IDAsDQogICAgICAgICAgaXNQYXJlbnQ6IDEsDQogICAgICAgICAgU2Nyb2xsVGFyZ2V0OiAicG4tcHJhaXNlIiwNCiAgICAgICAgICBDaGlsZHJlbjogWw0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBpbmRleDogMSwNCiAgICAgICAgICAgICAgdGl0bGU6ICJEYW5oIGhp4buHdSB0aGkgxJF1YSIsDQogICAgICAgICAgICAgIFN1YlN5c3RlbUNvZGU6ICJwcmFpc2UiLA0KICAgICAgICAgICAgICBTY3JvbGxUb3A6IDAsDQogICAgICAgICAgICAgIFNjcm9sbFRhcmdldDogInBuLXByYWlzZSIsDQogICAgICAgICAgICAgIFBhcmVudFN1YlN5c3RlbUNvZGU6ICJjZUdvIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGluZGV4OiAyLA0KICAgICAgICAgICAgICB0aXRsZTogIkjDrG5oIHRo4bupYyBraGVuIHRoxrDhu59uZyIsDQogICAgICAgICAgICAgIFN1YlN5c3RlbUNvZGU6ICJ0eXBlT2ZSZXdhcmQiLA0KICAgICAgICAgICAgICBTY3JvbGxUb3A6IDAsDQogICAgICAgICAgICAgIFNjcm9sbFRhcmdldDogInBuLXR5cGVPZlJld2FyZCIsDQogICAgICAgICAgICAgIFBhcmVudFN1YlN5c3RlbUNvZGU6ICJjZUdvIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGluZGV4OiAzLA0KICAgICAgICAgICAgICB0aXRsZTogIkvhu7cgbHXhuq10IiwNCiAgICAgICAgICAgICAgU3ViU3lzdGVtQ29kZTogImRpc2NpcGxpbmUiLA0KICAgICAgICAgICAgICBTY3JvbGxUb3A6IDAsDQogICAgICAgICAgICAgIFNjcm9sbFRhcmdldDogInBuLWRpc2NpcGxpbmUiLA0KICAgICAgICAgICAgICBQYXJlbnRTdWJTeXN0ZW1Db2RlOiAiY2VHbyIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgIF0sDQogICAgICAgIH0sDQogICAgICBdOw0KDQogICAgICAvLyB0cm9uZyDEkcahbiB24buLDQogICAgICBpZiAoIW1lLmlzT3V0U2lkZXIpIHsNCiAgICAgICAgbWUubGlzdEl0ZW1UYWIucHVzaCh7DQogICAgICAgICAgaW5kZXg6IDQsDQogICAgICAgICAgaXNQYXJlbnQ6IDEsDQogICAgICAgICAgdGl0bGU6ICJL4bq/dCBxdeG6oyDEkcOhbmggZ2nDoSwgeOG6v3AgbG/huqFpIiwNCiAgICAgICAgICBTdWJTeXN0ZW1Db2RlOiAiZXZhbHVhdGlvbiIsDQogICAgICAgICAgU2Nyb2xsVG9wOiAwLA0KICAgICAgICAgIFNjcm9sbFRhcmdldDogInBuLWV2YWx1YXRpb24iLA0KICAgICAgICB9KTsNCiAgICAgIH0NCg0KICAgICAgbWUubGlzdEl0ZW1UYWIucHVzaCh7DQogICAgICAgIGluZGV4OiBtZS5pc091dFNpZGVyID8gNCA6IDUsDQogICAgICAgIGlzUGFyZW50OiAxLA0KICAgICAgICB0aXRsZTogIlTDoGkgbGnhu4d1IMSRw61uaCBrw6htIiwNCiAgICAgICAgU3ViU3lzdGVtQ29kZTogImF0dGFjaG1lbnQiLA0KICAgICAgICBTY3JvbGxUb3A6IDAsDQogICAgICAgIFNjcm9sbFRhcmdldDogInBuLWF0dGFjaG1lbnQiLA0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIFRETkdISUEgMjMvOS8yMDIxDQogICAgICogVGjhu7FjIGhp4buHbiBjbGljayB2w6BvIHRleHQgbGluayDEkeG7gyBt4bufIHBvcHVwIGFkZA0KICAgICAqLw0KICAgIHRleHRMaW5rT25DbGljayhlKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQogICAgICBsZXQgZGV0YWlsTmFtZSA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgiRGV0YWlsTmFtZSIpOw0KICAgICAgLy8gaWYgKGRldGFpbE5hbWUgPT0gIkludmVudERldGFpbCIpIHsNCiAgICAgIC8vICAgbWUuJG1zLm1zZ0JveC5zaG93SW5mbyhtZS4kdCgiaTE4bkNvbW1vbi5GZWF0dXJlc0lzRGV2ZWxvcGluZyIpKTsNCiAgICAgIC8vIH0gZWxzZSB7DQogICAgICBtZS5zaG93Rm9ybURldGFpbEdyaWQoe30sIG1lLiRtcy5lbnVtLkZvcm1TdGF0ZS5BZGQsIGRldGFpbE5hbWUpOw0KICAgICAgLy99DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIFRo4buxYyBoaeG7h24ga2hpIOG6pW4gdHLDqm4gZ3JpZCBxdcOhIHRyw6xuaCBjw7RuZyB0w6FjDQogICAgICogVEROR0hJQSAyMi85LzIwMjENCiAgICAgKi8NCiAgICByb3dBY3Rpb25DbGlja1dvcmtQcm9jZXNzKGNvbW1hbmQsIHJlY29yZCwgZXZlbnQpIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCiAgICAgIHN3aXRjaCAoY29tbWFuZCkgew0KICAgICAgICAvLyBYw7NhDQogICAgICAgIGNhc2UgIkRlbGV0ZSI6DQogICAgICAgICAgbWUuZGVsZXRlRGV0YWlsKHJlY29yZCwgIldvcmtpbmdEZXRhaWwiKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAiRWRpdCI6DQogICAgICAgICAgbWUuc2hvd0Zvcm1EZXRhaWxHcmlkKA0KICAgICAgICAgICAgcmVjb3JkLA0KICAgICAgICAgICAgbWUuJG1zLmVudW0uRm9ybVN0YXRlLkVkaXQsDQogICAgICAgICAgICAiV29ya1Byb2Nlc3NEZXRhaWwiDQogICAgICAgICAgKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgLyoqDQogICAgICogSMOgbSBjaHVuZyB4w7NhIHJvdyBjw6FjIGdyaWQgZGV0YWlsDQogICAgICogVEROR0hJQSAxLzExLzIwMjENCiAgICAgKi8NCiAgICBkZWxldGVEZXRhaWwoZGF0YSwgc3lzQ29kZSkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgaWYgKGRhdGEuRmlsZU5hbWUpIHsNCiAgICAgICAgLy9UaMOqbSB2w6BvIEF0dGFjaG1lbnRDaGFuZ2VzIMSR4buDIHjDs2EgdHLDqm4gc3RvcmFnZSBOVERJRU0gMjUuMTIuMjAyMQ0KICAgICAgICBsZXQgYXR0YWNobWVudENoYW5nZSA9IHsNCiAgICAgICAgICBmaWxlOiBkYXRhLkZpbGVOYW1lLA0KICAgICAgICAgIG5hbWU6IGRhdGEuQXR0YWNobWVudE5hbWUsDQogICAgICAgICAgc3RhdGU6IG1lLiRtcy5lbnVtLk1vZGVsU3RhdGUuRGVsZXRlLA0KICAgICAgICB9Ow0KICAgICAgICBtZS5jdXJyZW50SXRlbS5BdHRhY2htZW50Q2hhbmdlcy5wdXNoKGF0dGFjaG1lbnRDaGFuZ2UpOw0KICAgICAgfQ0KDQogICAgICBzd2l0Y2ggKHN5c0NvZGUpIHsNCiAgICAgICAgY2FzZSAiRW11bGF0aW9uVGl0bGVEZXRhaWxQb3B1cCI6DQogICAgICAgICAgbWUubGlzdFNvdXJjZUVtdWxhdGlvblRpdGxlRGV0YWlsLnJlbW92ZShkYXRhKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAiUmV3YXJkQ2F0ZWdvcnlEZXRhaWxQb3B1cCI6DQogICAgICAgICAgbWUubGlzdFNvdXJjZVJld2FyZENhdGVnb3J5RGV0YWlsLnJlbW92ZShkYXRhKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAiV29ya2luZ0RldGFpbCI6DQogICAgICAgICAgbWUubGlzdFNvdXJjZVdvcmtpbmdEZXRhaWwucmVtb3ZlKGRhdGEpOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICJSb2xlRGV0YWlsIjoNCiAgICAgICAgICBtZS5saXN0U291cmNlTWlzc2lvblJvbGUucmVtb3ZlKGRhdGEpOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICJJbnZlbnREZXRhaWwiOg0KICAgICAgICAgIG1lLmxpc3RTb3VyY2VBY2hpZXZlbWVudElkZWEucmVtb3ZlKGRhdGEpOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICJEaXNjaXBsaW5lRGV0YWlsIjoNCiAgICAgICAgICBtZS5saXN0U291cmNlRGlzY2lwbGluZURldGFpbC5yZW1vdmUoZGF0YSk7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgIkV2YWx1YXRpb25EZXRhaWwiOg0KICAgICAgICAgIG1lLmxpc3RTb3VyY2VFdmFsdWF0aW9uRGV0YWlsLnJlbW92ZShkYXRhKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAiQXR0YWNobWVudERldGFpbCI6DQogICAgICAgICAgbWUuZGVsZXRlQXR0YWNobWVudERldGFpbChkYXRhKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICBicmVhazsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgLyoqDQogICAgICogVGjhu7FjIGhp4buHbiBraGkg4bqlbiB0csOqbiBncmlkIGRhbmggaGnhu4d1IHRoaSDEkXVhDQogICAgICogVEROR0hJQSAyMi85LzIwMjENCiAgICAgKi8NCiAgICByb3dBY3Rpb25DbGlja0VtdWxhdGlvblRpdGxlKGNvbW1hbmQsIHJlY29yZCwgZXZlbnQpIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCiAgICAgIHN3aXRjaCAoY29tbWFuZCkgew0KICAgICAgICAvLyBYw7NhDQogICAgICAgIGNhc2UgIkRlbGV0ZSI6DQogICAgICAgICAgbWUuZGVsZXRlRGV0YWlsKHJlY29yZCwgIkVtdWxhdGlvblRpdGxlRGV0YWlsUG9wdXAiKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAiRWRpdCI6DQogICAgICAgICAgbWUuc2hvd0Zvcm1EZXRhaWxHcmlkKA0KICAgICAgICAgICAgcmVjb3JkLA0KICAgICAgICAgICAgbWUuJG1zLmVudW0uRm9ybVN0YXRlLkVkaXQsDQogICAgICAgICAgICAiRW11bGF0aW9uVGl0bGVEZXRhaWxQb3B1cCINCiAgICAgICAgICApOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgfQ0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBUaOG7sWMgaGnhu4duIGtoaSDhuqVuIHRyw6puIGdyaWQgdOG6rXAgxJHDrW5oIGvDqG0NCiAgICAgKiBURE5HSElBIDIyLzkvMjAyMQ0KICAgICAqLw0KICAgIHJvd0FjdGlvbkNsaWNrQXR0YWNobWVudERldGFpbChjb21tYW5kLCByZWNvcmQsIGV2ZW50KSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQogICAgICBzd2l0Y2ggKGNvbW1hbmQpIHsNCiAgICAgICAgLy8gWMOzYQ0KICAgICAgICBjYXNlICJEZWxldGUiOg0KICAgICAgICAgIG1lLmRlbGV0ZURldGFpbChyZWNvcmQsICJBdHRhY2htZW50RGV0YWlsIik7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgIkVkaXQiOg0KICAgICAgICAgIG1lLnNob3dGb3JtRGV0YWlsR3JpZCgNCiAgICAgICAgICAgIHJlY29yZCwNCiAgICAgICAgICAgIG1lLiRtcy5lbnVtLkZvcm1TdGF0ZS5FZGl0LA0KICAgICAgICAgICAgIkF0dGFjaG1lbnREZXRhaWwiDQogICAgICAgICAgKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAiRG93bmxvYWQiOg0KICAgICAgICAgIG1lLmRvd25sb2FkRmlsZShyZWNvcmQpOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgfQ0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBU4bqjaSB4deG7kW5nIHThu4dwIMSRw61uaCBrw6htDQogICAgICogTlRESUVNIDA4LzA0LzIwMjINCiAgICAgKi8NCiAgICBkb3dubG9hZEZpbGUocmVjb3JkKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQogICAgICANCiAgICAgIGNvbnN0IHR5cGUgPQ0KICAgICAgICByZWNvcmQuRmlsZVR5cGUgPT0gbWUuJG1zLmVudW0uU3RvcmFnZUZpbGVUeXBlLlRlbXANCiAgICAgICAgICA/IHJlY29yZC5GaWxlVHlwZQ0KICAgICAgICAgIDogbWUuJG1zLmVudW0uU3RvcmFnZUZpbGVUeXBlLkF0dGFjaG1lbnQ7DQoNCiAgICAgIGxldCBkb3dubG9hZExpbmsgPSBmaWxlQXBpLmdldERvd25sb2FkTGluaygNCiAgICAgICAgcmVjb3JkLkZpbGVOYW1lLA0KICAgICAgICB0eXBlLA0KICAgICAgICBtZS5jb250ZXh0LkNvbnRleHQuVGVuYW50SUQsDQogICAgICAgIHJlY29yZC5Pcmdhbml6YXRpb25JRA0KICAgICAgICAgID8gcmVjb3JkLk9yZ2FuaXphdGlvbklEDQogICAgICAgICAgOiBtZS5jb250ZXh0Lk9yZ2FuaXphdGlvbi5Pcmdhbml6YXRpb25JRCwNCiAgICAgICAgcmVjb3JkLkF0dGFjaG1lbnROYW1lDQogICAgICApOw0KDQogICAgICBjb21tb25Gbi5kb3dubG9hZEZpbGUoZG93bmxvYWRMaW5rKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogVGjhu7FjIGhp4buHbiBraGkg4bqlbiB0csOqbiBncmlkIGjDrG5oIHRo4bupYyBraGVuIHRoxrDhu59uZw0KICAgICAqIFRETkdISUEgMjIvOS8yMDIxDQogICAgICovDQogICAgcm93QWN0aW9uQ2xpY2tSZXdhcmRGb3JtKGNvbW1hbmQsIHJlY29yZCwgZXZlbnQpIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCiAgICAgIHN3aXRjaCAoY29tbWFuZCkgew0KICAgICAgICAvLyBYw7NhDQogICAgICAgIGNhc2UgIkRlbGV0ZSI6DQogICAgICAgICAgbWUuZGVsZXRlRGV0YWlsKHJlY29yZCwgIlJld2FyZENhdGVnb3J5RGV0YWlsUG9wdXAiKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAiRWRpdCI6DQogICAgICAgICAgbWUuc2hvd0Zvcm1EZXRhaWxHcmlkKA0KICAgICAgICAgICAgcmVjb3JkLA0KICAgICAgICAgICAgbWUuJG1zLmVudW0uRm9ybVN0YXRlLkVkaXQsDQogICAgICAgICAgICAiUmV3YXJkQ2F0ZWdvcnlEZXRhaWxQb3B1cCINCiAgICAgICAgICApOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgfQ0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBIw6BtIGNodW5nIHNob3cgZm9ybSBjaG8gY8OhYyBncmlkDQogICAgICogVGjhu7FjIGhp4buHbiBraGkg4bqlbiB0csOqbiBncmlkIHF1w6EgdHLDrG5oIHF1eeG7gW4gbmhp4buHbSB24bulDQogICAgICogVEROR0hJQSAyMi85LzIwMjENCiAgICAgKi8NCiAgICByb3dBY3Rpb25DbGlja0Rpc2NpcGxpbmUoY29tbWFuZCwgcmVjb3JkLCBldmVudCkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgc3dpdGNoIChjb21tYW5kKSB7DQogICAgICAgIC8vIFjDs2ENCiAgICAgICAgY2FzZSAiRGVsZXRlIjoNCiAgICAgICAgICBtZS5kZWxldGVEZXRhaWwocmVjb3JkLCAiRGlzY2lwbGluZURldGFpbCIpOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICJFZGl0IjoNCiAgICAgICAgICBtZS5zaG93Rm9ybURldGFpbEdyaWQoDQogICAgICAgICAgICByZWNvcmQsDQogICAgICAgICAgICBtZS4kbXMuZW51bS5Gb3JtU3RhdGUuRWRpdCwNCiAgICAgICAgICAgICJEaXNjaXBsaW5lRGV0YWlsIg0KICAgICAgICAgICk7DQogICAgICAgICAgYnJlYWs7DQogICAgICB9DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIEjDoG0gY2h1bmcgc2hvdyBmb3JtIGNobyBjw6FjIGdyaWQNCiAgICAgKiBUaOG7sWMgaGnhu4duIGtoaSDhuqVuIHRyw6puIGdyaWQgcXXDoSB0csOsbmggcXV54buBbiBuaGnhu4dtIHbhu6UNCiAgICAgKiBURE5HSElBIDIyLzkvMjAyMQ0KICAgICAqLw0KICAgIHJvd0FjdGlvbkNsaWNrUm9sZShjb21tYW5kLCByZWNvcmQsIGV2ZW50KSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQogICAgICBzd2l0Y2ggKGNvbW1hbmQpIHsNCiAgICAgICAgLy8gWMOzYQ0KICAgICAgICBjYXNlICJEZWxldGUiOg0KICAgICAgICAgIG1lLmRlbGV0ZURldGFpbChyZWNvcmQsICJSb2xlRGV0YWlsIik7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgIkVkaXQiOg0KICAgICAgICAgIG1lLnNob3dGb3JtRGV0YWlsR3JpZCgNCiAgICAgICAgICAgIHJlY29yZCwNCiAgICAgICAgICAgIG1lLiRtcy5lbnVtLkZvcm1TdGF0ZS5FZGl0LA0KICAgICAgICAgICAgIk1pc3Npb25Sb2xlIg0KICAgICAgICAgICk7DQogICAgICAgICAgYnJlYWs7DQogICAgICB9DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIFRo4buxYyBoaeG7h24ga2hpIOG6pW4gdHLDqm4gZ3JpZCBxdcOhIHRyw6xuaCBxdXnhu4FuIG5oaeG7h20gduG7pQ0KICAgICAqIFRETkdISUEgMjIvOS8yMDIxDQogICAgICovDQogICAgcm93QWN0aW9uQ2xpY2tJbnZlbnQoY29tbWFuZCwgcmVjb3JkLCBldmVudCkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgc3dpdGNoIChjb21tYW5kKSB7DQogICAgICAgIC8vIFjDs2ENCiAgICAgICAgY2FzZSAiRGVsZXRlIjoNCiAgICAgICAgICBtZS5kZWxldGVEZXRhaWwocmVjb3JkLCAiSW52ZW50RGV0YWlsIik7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgIkVkaXQiOg0KICAgICAgICAgIG1lLnNob3dGb3JtRGV0YWlsR3JpZCgNCiAgICAgICAgICAgIHJlY29yZCwNCiAgICAgICAgICAgIG1lLiRtcy5lbnVtLkZvcm1TdGF0ZS5FZGl0LA0KICAgICAgICAgICAgIkludmVudERldGFpbCINCiAgICAgICAgICApOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgfQ0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBUaOG7sWMgaGnhu4duIGtoaSDhuqVuIHRyw6puIGdyaWQgxJHDoW5oIGdpw6ENCiAgICAgKiBOVEJBTyAxOC4wMi4yMDIyDQogICAgICovDQogICAgcm93QWN0aW9uQ2xpY2tFdmFsdWF0aW9uKGNvbW1hbmQsIHJlY29yZCwgZXZlbnQpIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCiAgICAgIHN3aXRjaCAoY29tbWFuZCkgew0KICAgICAgICAvLyBYw7NhDQogICAgICAgIGNhc2UgIkRlbGV0ZSI6DQogICAgICAgICAgbWUuZGVsZXRlRGV0YWlsKHJlY29yZCwgIkV2YWx1YXRpb25EZXRhaWwiKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAiRWRpdCI6DQogICAgICAgICAgbWUuc2hvd0Zvcm1EZXRhaWxHcmlkKA0KICAgICAgICAgICAgcmVjb3JkLA0KICAgICAgICAgICAgbWUuJG1zLmVudW0uRm9ybVN0YXRlLkVkaXQsDQogICAgICAgICAgICAiRXZhbHVhdGlvbkRldGFpbCINCiAgICAgICAgICApOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgfQ0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBIw6BtIGNodW5nIHNob3cgZm9ybSBjaG8gY8OhYyBncmlkDQogICAgICogVEROR0hJQSAyMi85LzIwMjENCiAgICAgKi8NCiAgICBzaG93Rm9ybURldGFpbEdyaWQocmVjb3JkLCBtb2RlLCBTdWJTeXN0ZW1Db2RlKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQogICAgICBsZXQgcGF0aCA9IFN1YlN5c3RlbUNvZGU7DQogICAgICBsZXQgcGFyYW0gPSB7DQogICAgICAgIGRhdGE6IHJlY29yZCwNCiAgICAgICAgbW9kZTogbW9kZSwNCiAgICAgIH07DQogICAgICBsZXQgcG9wID0gcG9wdXBVdGlsLl92aXNpYmxlW3BhdGhdOw0KICAgICAgaWYgKHBvcCkgew0KICAgICAgICBwb3AuYWN0aXZlID0gZmFsc2U7DQogICAgICB9DQoNCiAgICAgIG1lLnNob3dEZXRhaWwocGF0aCwgbW9kZSwgcGFyYW0sIG1lLmdldFBvcHVwT3B0aW9uKHBhdGgpKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogVEROR0hJQSAzMC8xMC8yMDIxDQogICAgICogY2FzZSDEkeG7gyB0cnV54buBbiBjw6FjIHN1Ym1pdGNhbGxiYWNrIGNobyDEkcO6bmcNCiAgICAgKiBDaG8gcGjDqXAgZGV0YWlsIGfhu41pIHThu5tpIHN1Ym1pdERldGFpbENhbGxiYWNrIGPhu6dhIGRhbmggc8OhY2ggc2F1IGtoaSBj4bqldCB4b25nDQogICAgICovDQogICAgZ2V0UG9wdXBPcHRpb24obmFtZSkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgbGV0IG9wdGlvbkRldGFpbCA9IHsNCiAgICAgICAgc2luZ2xlOiB0cnVlLA0KICAgICAgICBjb250ZXh0OiBtZS5vcHRpb25zLmNvbnRleHQsDQogICAgICB9Ow0KICAgICAgc3dpdGNoIChuYW1lKSB7DQogICAgICAgIGNhc2UgIldvcmtQcm9jZXNzRGV0YWlsIjoNCiAgICAgICAgICBvcHRpb25EZXRhaWwuc3VibWl0ID0gbWUuc3VibWl0V29ya2luZ0RldGFpbENhbGxiYWNrOw0KICAgICAgICAgIG9wdGlvbkRldGFpbC5pc091dFNpZGVyID0gbWUuaXNPdXRTaWRlcjsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAiTWlzc2lvblJvbGUiOg0KICAgICAgICAgIG9wdGlvbkRldGFpbC5zdWJtaXQgPSBtZS5zdWJtaXRNaXNzaW9uUm9sZUNhbGxiYWNrOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICJJbnZlbnREZXRhaWwiOg0KICAgICAgICAgIG9wdGlvbkRldGFpbC5zdWJtaXQgPSBtZS5zdWJtaXRJbnZlbnREZXRhaWxDYWxsYmFjazsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAiRW11bGF0aW9uVGl0bGVEZXRhaWxQb3B1cCI6DQogICAgICAgICAgb3B0aW9uRGV0YWlsLnN1Ym1pdCA9IG1lLnN1Ym1pdEVtdWxhdGlvblRpdGxlRGV0YWlsQ2FsbGJhY2s7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgIlJld2FyZENhdGVnb3J5RGV0YWlsUG9wdXAiOg0KICAgICAgICAgIG9wdGlvbkRldGFpbC5zdWJtaXQgPSBtZS5zdWJtaXRSZXdhcmRDYXRlZ29yeURldGFpbENhbGxiYWNrOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICJEaXNjaXBsaW5lRGV0YWlsIjoNCiAgICAgICAgICBvcHRpb25EZXRhaWwuc3VibWl0ID0gbWUuc3VibWl0RGlzY2lwbGluZURldGFpbENhbGxiYWNrOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICJNU0F0dGFjaG1lbnREZXRhaWwiOg0KICAgICAgICAgIG9wdGlvbkRldGFpbC5maWxlU2l6ZVN1bWFyeSA9IG1lLmZpbGVTaXplU3VtYXJ5Ow0KICAgICAgICAgIG9wdGlvbkRldGFpbC5zdWJtaXQgPSBtZS5zdWJtaXRBdHRhY2htZW50RGV0YWlsQ2FsbGJhY2s7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgIkV2YWx1YXRpb25EZXRhaWwiOg0KICAgICAgICAgIG9wdGlvbkRldGFpbC5zdWJtaXQgPSBtZS5zdWJtaXRFdmFsdWF0aW9uRGV0YWlsQ2FsbGJhY2s7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgYnJlYWs7DQogICAgICB9DQoNCiAgICAgIHJldHVybiBvcHRpb25EZXRhaWw7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIEjDoG0geOG7rSBsw70gY2FsbGJhY2sgY2h1bmcgY2hvIGPDoWMgbcOgbiBkZXRhaWwNCiAgICAgKiBURE5HSElBIDEvMTEvMjAyMQ0KICAgICAqLw0KICAgIHN1Ym1pdENhbGxiYWNrKGxpc3REYXRhRGV0YWlsLCBmaWVsZERhdGEsIGZpZWxkU29ydCwgc2F2ZVBhcmFtLCBhY3Rpb24pIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCg0KICAgICAgaWYgKGFjdGlvbiA9PSAidXBkYXRlIikgew0KICAgICAgICB0aGlzLnNldE5ld0VsZW1lbnQobGlzdERhdGFEZXRhaWwsIGZpZWxkRGF0YSwgc2F2ZVBhcmFtLkVudGl0eSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLnNldE5ld0lEKGxpc3REYXRhRGV0YWlsLCBmaWVsZERhdGEsIHNhdmVQYXJhbS5FbnRpdHkpOw0KICAgICAgICAvL1jhu60gbMO9IHRow6ptIHbDoG8gbGlzdCBjaG8gY8OhYyBlbnRpdHkgZOG6oW5nIGFycmF5IE5URElFTSAyNi4xMS4yMDIxDQogICAgICAgIGlmIChzYXZlUGFyYW0uRW50aXR5Lmxlbmd0aCA+IDApIHsNCiAgICAgICAgICBzYXZlUGFyYW0uRW50aXR5LmZvckVhY2goKGl0ZW0pID0+IHsNCiAgICAgICAgICAgIGxpc3REYXRhRGV0YWlsLnB1c2goaXRlbSk7DQogICAgICAgICAgfSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgbGlzdERhdGFEZXRhaWwucHVzaChzYXZlUGFyYW0uRW50aXR5KTsNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICAvL1Row6ptIGRldGFpbCBjw7MgdOG7h3AgxJHDrW5oIGvDqG0gdGjDrCB1cGRhdGUgdOG7h3AgYXR0YWNobWVudENoYW5nZSBjaG8gQXR0YWNobWVudENoYW5nZSBjaHVuZyBOVERJRU0gMjQuMTIuMjAyMQ0KICAgICAgaWYgKHNhdmVQYXJhbS5FbnRpdHkuQXR0YWNobWVudENoYW5nZXMpIHsNCiAgICAgICAgc2F2ZVBhcmFtLkVudGl0eS5BdHRhY2htZW50Q2hhbmdlcy5mb3JFYWNoKChjaGFuZ2UpID0+IHsNCiAgICAgICAgICBtZS5jdXJyZW50SXRlbS5BdHRhY2htZW50Q2hhbmdlcy5wdXNoKGNoYW5nZSk7DQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgICAgLy90aOG7sWMgaGnhu4duIHNvcnQgdHJ1eeG7gW4gdGjDqm0gYmnhur9uIMSRw6FuaCBk4bqldSBwaOG6o2kgY2FzdCB24buBIGRhdGUgdHLGsOG7m2Mga2hpIHNvIHPDoW5oDQogICAgICBpZiAoZmllbGRTb3J0ICE9ICJZZWFyIikgew0KICAgICAgICBsaXN0RGF0YURldGFpbCA9IHRoaXMuJG1zLmNvbW1vbkZuLnNvcnRBcnJheSgNCiAgICAgICAgICB0aGlzLiRtcy5lbnVtLlNvcnRTdGF0dXMuZGVzYywNCiAgICAgICAgICBsaXN0RGF0YURldGFpbCwNCiAgICAgICAgICBmaWVsZFNvcnQsDQogICAgICAgICAgMQ0KICAgICAgICApOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgbGlzdERhdGFEZXRhaWwgPSB0aGlzLiRtcy5jb21tb25Gbi5zb3J0QXJyYXkoDQogICAgICAgICAgdGhpcy4kbXMuZW51bS5Tb3J0U3RhdHVzLmRlc2MsDQogICAgICAgICAgbGlzdERhdGFEZXRhaWwsDQogICAgICAgICAgZmllbGRTb3J0DQogICAgICAgICk7DQogICAgICB9DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIEjDoG0gY2FsbGJhY2sgc2F1IGtoaSBzYXZlIGThu68gbGnhu4d1DQogICAgICogVEROR0hJQSAxLzExLzIwMjENCiAgICAgKi8NCiAgICBzdWJtaXREaXNjaXBsaW5lRGV0YWlsQ2FsbGJhY2socmVzdWx0LCBwYXJhbSwgYWN0aW9uKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQoNCiAgICAgIC8vTMawdSB0aMO0bmcgdGluIGPGoSBxdWFuIHJhIHF1eeG6v3QgxJHhu4tuaCBt4bubaQ0KICAgICAgbWUuc2F2ZURlY2lzaW9uT3JnYW5pemF0aW9uKHJlc3VsdCwgcGFyYW0sIGFjdGlvbiwgIkRpc2NpcGxpbmVEZXRhaWwiKTsNCg0KICAgICAgbWUuc3VibWl0Q2FsbGJhY2soDQogICAgICAgIHRoaXMubGlzdFNvdXJjZURpc2NpcGxpbmVEZXRhaWwsDQogICAgICAgICJJRCIsDQogICAgICAgICJGcm9tRGF0ZSIsDQogICAgICAgIHBhcmFtLA0KICAgICAgICBhY3Rpb24NCiAgICAgICk7DQoNCiAgICAgIG1lLiRyZWZzLmJ0bkRpc2NpcGxpbmUuZm9jdXMoKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogQ2FsbCBiYWNrIHNhdSBraGkgdGhlZW0gZGFuaCBoaeG7h3UgdGhpIMSRdWENCiAgICAgKiBURE5HSElBIDEvMTEvMjAyMQ0KICAgICAqLw0KICAgIHN1Ym1pdEVtdWxhdGlvblRpdGxlRGV0YWlsQ2FsbGJhY2socmVzdWx0LCBwYXJhbSwgYWN0aW9uKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQoNCiAgICAgIC8vTMawdSB0aMO0bmcgdGluIGPGoSBxdWFuIHJhIHF1eeG6v3QgxJHhu4tuaCBt4bubaQ0KICAgICAgbWUuc2F2ZURlY2lzaW9uT3JnYW5pemF0aW9uKA0KICAgICAgICByZXN1bHQsDQogICAgICAgIHBhcmFtLA0KICAgICAgICBhY3Rpb24sDQogICAgICAgICJFbXVsYXRpb25UaXRsZURldGFpbFBvcHVwIg0KICAgICAgKTsNCg0KICAgICAgbWUuc3VibWl0Q2FsbGJhY2soDQogICAgICAgIHRoaXMubGlzdFNvdXJjZUVtdWxhdGlvblRpdGxlRGV0YWlsLA0KICAgICAgICAiSUQiLA0KICAgICAgICAiRGF0ZSIsDQogICAgICAgIHBhcmFtLA0KICAgICAgICBhY3Rpb24NCiAgICAgICk7DQoNCiAgICAgIG1lLiRyZWZzLmJ0bkVtdWxhdGlvblRpdGxlLmZvY3VzKCk7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIENhbGxiYWNrIHNhdSBraGkgdGjDqm0gaMOsbmggdGjhu6ljIGtoZW4gdGjGsOG7n25nDQogICAgICogVEROR0hJQSAxLzExLzIwMjENCiAgICAgKi8NCiAgICBzdWJtaXRSZXdhcmRDYXRlZ29yeURldGFpbENhbGxiYWNrKHJlc3VsdCwgcGFyYW0sIGFjdGlvbikgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KDQogICAgICAvL0zGsHUgdGjDtG5nIHRpbiBjxqEgcXVhbiByYSBxdXnhur90IMSR4buLbmggbeG7m2kNCiAgICAgIG1lLnNhdmVEZWNpc2lvbk9yZ2FuaXphdGlvbigNCiAgICAgICAgcmVzdWx0LA0KICAgICAgICBwYXJhbSwNCiAgICAgICAgYWN0aW9uLA0KICAgICAgICAiUmV3YXJkQ2F0ZWdvcnlEZXRhaWxQb3B1cCINCiAgICAgICk7DQoNCiAgICAgIG1lLnN1Ym1pdENhbGxiYWNrKA0KICAgICAgICB0aGlzLmxpc3RTb3VyY2VSZXdhcmRDYXRlZ29yeURldGFpbCwNCiAgICAgICAgIklEIiwNCiAgICAgICAgIkRhdGUiLA0KICAgICAgICBwYXJhbSwNCiAgICAgICAgYWN0aW9uDQogICAgICApOw0KDQogICAgICBtZS4kcmVmcy5idG5SZXdhcmRDYXRlZ29yeS5mb2N1cygpOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBDYWxsYmFjayBzYXUga2hpIHNhdmUgcXXDoSB0csOsbmggY8O0bmcgdMOhYw0KICAgICAqIFRETkdISUEgMS8xMS8yMDIxDQogICAgICovDQogICAgc3VibWl0V29ya2luZ0RldGFpbENhbGxiYWNrKHJlc3VsdCwgcGFyYW0sIGFjdGlvbikgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KDQogICAgICBtZS5zdWJtaXRDYWxsYmFjaygNCiAgICAgICAgdGhpcy5saXN0U291cmNlV29ya2luZ0RldGFpbCwNCiAgICAgICAgIldvcmtpbmdJRCIsDQogICAgICAgICJUb0RhdGUiLA0KICAgICAgICBwYXJhbSwNCiAgICAgICAgYWN0aW9uDQogICAgICApOw0KDQogICAgICBtZS4kcmVmcy5idG5Xb3JraW5nLmZvY3VzKCk7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIENhbGxiYWNrIHNhdSBraGkgc2F2ZSBxdXnhu4FuIGjhuqFuIG5oaeG7h20gduG7pSDEkcaw4bujYyBnaWFvDQogICAgICogVEROR0hJQSAxLzExLzIwMjENCiAgICAgKi8NCiAgICBzdWJtaXRNaXNzaW9uUm9sZUNhbGxiYWNrKHJlc3VsdCwgcGFyYW0sIGFjdGlvbikgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgbWUuc3VibWl0Q2FsbGJhY2soDQogICAgICAgIHRoaXMubGlzdFNvdXJjZU1pc3Npb25Sb2xlLA0KICAgICAgICAiUm9sZUlEIiwNCiAgICAgICAgIlllYXIiLA0KICAgICAgICBwYXJhbSwNCiAgICAgICAgYWN0aW9uDQogICAgICApOw0KDQogICAgICBtZS4kcmVmcy5idG5Sb2xlLmZvY3VzKCk7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIENhbGxiYWNrIHNhdSBraGkgc2F2ZSBzw6FuZyBraeG6v24NCiAgICAgKiBOVFRIQU5IMSAwNy8xMi8yMDIxDQogICAgICogTW9kaWZ5IDA0LzAzLzIwMjINCiAgICAgKi8NCiAgICBzdWJtaXRJbnZlbnREZXRhaWxDYWxsYmFjayhyZXN1bHQsIHBhcmFtLCBhY3Rpb24pIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCg0KICAgICAgLy9MxrB1IHRow7RuZyB0aW4gY8ahIHF1YW4gcmEgcXV54bq/dCDEkeG7i25oIG3hu5tpDQogICAgICBtZS5zYXZlRGVjaXNpb25Pcmdhbml6YXRpb24ocmVzdWx0LCBwYXJhbSwgYWN0aW9uLCAiSW52ZW50RGV0YWlsIik7DQoNCiAgICAgIG1lLnN1Ym1pdENhbGxiYWNrKA0KICAgICAgICB0aGlzLmxpc3RTb3VyY2VBY2hpZXZlbWVudElkZWEsDQogICAgICAgICJJbnZlbnRJRCIsDQogICAgICAgICJZZWFyIiwNCiAgICAgICAgcGFyYW0sDQogICAgICAgIGFjdGlvbg0KICAgICAgKTsNCg0KICAgICAgbWUuJHJlZnMuYnRuSW52ZW50LmZvY3VzKCk7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIENhbGxiYWNrIHNhdSBraGkgc2F2ZSDEkcOhbmggZ2nDoSwgeOG6v3AgbG/huqFpDQogICAgICogTlRCQU8gMTcuMDIuMjAyMg0KICAgICAqLw0KICAgIHN1Ym1pdEV2YWx1YXRpb25EZXRhaWxDYWxsYmFjayhyZXN1bHQsIHBhcmFtLCBhY3Rpb24pIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCg0KICAgICAgbWUuc3VibWl0Q2FsbGJhY2soDQogICAgICAgIHRoaXMubGlzdFNvdXJjZUV2YWx1YXRpb25EZXRhaWwsDQogICAgICAgICJJRCIsDQogICAgICAgICJEYXRlIiwNCiAgICAgICAgcGFyYW0sDQogICAgICAgIGFjdGlvbg0KICAgICAgKTsNCg0KICAgICAgbWUuJHJlZnMuYnRuRXZhbC5mb2N1cygpOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBDYWxsYmFjayBzYXUga2hpIHRow6ptIHThu4dwIMSRw61uaCBrw6htDQogICAgICogTlRESUVNIDE4LjExLjIwMjENCiAgICAgKi8NCiAgICBzdWJtaXRBdHRhY2htZW50RGV0YWlsQ2FsbGJhY2socmVzdWx0LCBwYXJhbSwgYWN0aW9uKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQogICAgICBtZS5zdWJtaXRDYWxsYmFjaygNCiAgICAgICAgdGhpcy5saXN0U291cmNlQXR0YWNobWVudERldGFpbCwNCiAgICAgICAgIklEIiwNCiAgICAgICAgIkF0dGFjaG1lbnROYW1lIiwNCiAgICAgICAgcGFyYW0sDQogICAgICAgIGFjdGlvbg0KICAgICAgKTsNCiAgICAgIGlmIChwYXJhbS5BdHRhY2htZW50Q2hhbmdlcykgew0KICAgICAgICBwYXJhbS5BdHRhY2htZW50Q2hhbmdlcy5mb3JFYWNoKChjaGFuZ2UpID0+IHsNCiAgICAgICAgICBtZS5jdXJyZW50SXRlbS5BdHRhY2htZW50Q2hhbmdlcy5wdXNoKGNoYW5nZSk7DQogICAgICAgIH0pOw0KICAgICAgfQ0KDQogICAgICBtZS4kcmVmcy5idG5BdHRhY2guZm9jdXMoKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogTMawdSB0aMO0bmcgdGluIGPGoSBxdWFuIHJhIHF1eeG6v3QgxJHhu4tuaCBt4bubaQ0KICAgICAqIE5UVEhBTkgxIDA0LzAzLzIwMjINCiAgICAgKi8NCiAgICBzYXZlRGVjaXNpb25Pcmdhbml6YXRpb24ocmVzdWx0LCBwYXJhbSwgYWN0aW9uLCBkZXRhaWxOYW1lKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQogICAgICBsZXQgZW50aXR5ID0gbnVsbDsNCiAgICAgIHN3aXRjaCAoZGV0YWlsTmFtZSkgew0KICAgICAgICBjYXNlICJJbnZlbnREZXRhaWwiOg0KICAgICAgICAgIGlmIChwYXJhbS5FbnRpdHkgJiYgcGFyYW0uRW50aXR5LkRlY2lzaW9uT3JnYW5pemF0aW9uKSB7DQogICAgICAgICAgICBlbnRpdHkgPSB7DQogICAgICAgICAgICAgIFBpY2tMaXN0TmFtZTogcGFyYW0uRW50aXR5LkRlY2lzaW9uT3JnYW5pemF0aW9uLA0KICAgICAgICAgICAgICBQaWNrTGlzdFR5cGU6IG1lLiRtcy5lbnVtLlBpY2tMaXN0VHlwZS5EZWNpc2lvbk9yZ2FuaXphdGlvbiwNCiAgICAgICAgICAgIH07DQogICAgICAgICAgfQ0KICAgICAgICBjYXNlICJFbXVsYXRpb25UaXRsZURldGFpbFBvcHVwIjoNCiAgICAgICAgY2FzZSAiUmV3YXJkQ2F0ZWdvcnlEZXRhaWxQb3B1cCI6DQogICAgICAgIGNhc2UgIkRpc2NpcGxpbmVEZXRhaWwiOg0KICAgICAgICAgIGlmIChwYXJhbS5FbnRpdHkgJiYgcGFyYW0uRW50aXR5Lk9yZ2FuaXphdGlvbkJlbG9uZykgew0KICAgICAgICAgICAgZW50aXR5ID0gew0KICAgICAgICAgICAgICBQaWNrTGlzdE5hbWU6IHBhcmFtLkVudGl0eS5Pcmdhbml6YXRpb25CZWxvbmcsDQogICAgICAgICAgICAgIFBpY2tMaXN0VHlwZTogbWUuJG1zLmVudW0uUGlja0xpc3RUeXBlLkRlY2lzaW9uT3JnYW5pemF0aW9uLA0KICAgICAgICAgICAgfTsNCiAgICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIGlmIChlbnRpdHkpIHsNCiAgICAgICAgUGlja0xpc3RBUEkuaW5zZXJ0Q2hlY2tEdXBsaWNhdGUoZW50aXR5KQ0KICAgICAgICAgIC50aGVuKChyZXMpID0+IHt9KQ0KICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7DQogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOw0KICAgICAgICAgIH0pOw0KICAgICAgfQ0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBD4bqtcCBuaOG6rXQgbOG6oWkgYuG6o24gZ2hpIMSRxrDhu6NjIHPhu61hIGNobyBjw6FjIGLhuqNuZyBjb24NCiAgICAgKiBURE5HSElBIDMxLzEwLzIwMjENCiAgICAgKi8NCiAgICBzZXROZXdFbGVtZW50KGFyciwgZmllbGREYXRhLCBvYmopIHsNCiAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBhcnIubGVuZ3RoOyBpbmRleCsrKSB7DQogICAgICAgIGlmIChhcnJbaW5kZXhdW2ZpZWxkRGF0YV0gPT09IG9ialtmaWVsZERhdGFdKSB7DQogICAgICAgICAgYXJyW2luZGV4XSA9IHsgLi4ub2JqIH07DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KDQogICAgLyoqDQogICAgICogdHLhuqMgduG7gSBJRCBt4bubaSBuaOG6pXQgY2hvIGLhuqNuIGdoaQ0KICAgICAqIFRETkdISUEgMzEvMTAvMjAyMQ0KICAgICAqLw0KICAgIHNldE5ld0lEKGFyciwgZGF0YUZpZWxkLCBvYmplY3QpIHsNCiAgICAgIGxldCBuZXdJRCA9IDE7DQoNCiAgICAgIGlmIChhcnIubGVuZ3RoID4gMCkgew0KICAgICAgICBsZXQgYXJySUQgPSBhcnIubWFwKGZ1bmN0aW9uIChpdGVtKSB7DQogICAgICAgICAgcmV0dXJuIGl0ZW1bZGF0YUZpZWxkXTsNCiAgICAgICAgfSk7DQogICAgICAgIG5ld0lEID0gTWF0aC5tYXgoLi4uYXJySUQpICsgMTsNCiAgICAgIH0NCiAgICAgIG9iamVjdFtkYXRhRmllbGRdID0gbmV3SUQ7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIEjDoG0gc2hvdyBjw6FjIHBvcHVwDQogICAgICogQHBhcmFtIG5hbWUgdMOqbiBj4bunYSBjb21wb25lbnQNCiAgICAgKi8NCiAgICBzaG93RGV0YWlsKG5hbWUsIG1vZGUsIGRhdGEsIG9wdGlvbikgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgcG9wdXBVdGlsLnNob3cobWUsIG5hbWUsIGRhdGEsIG9wdGlvbik7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIENo4buNbiB04buJbmgvdGjDoG5oIHBo4buRIHF1w6ogcXXDoW4NCiAgICAgKi8NCiAgICBzZWxlY3RlZFByb3ZpbmNlSG9tZShzZWxlY3RlZERhdGEpIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCiAgICAgIGxldCBpdGVtID0gc2VsZWN0ZWREYXRhLm5ld0RhdGE7DQoNCiAgICAgIG1lLmN1cnJlbnRJdGVtLkhvbWVQcm92aW5jZU5hbWUgPSBpdGVtLkxvY2F0aW9uTmFtZTsNCiAgICAgIG1lLmN1cnJlbnRJdGVtLkhvbWVEaXN0cmljdCA9IG51bGw7DQogICAgICBtZS5jdXJyZW50SXRlbS5Ib21lV2FyZCA9IG51bGw7DQogICAgICBtZS5jdXJyZW50SXRlbS5Ib21lRGlzdHJpY3ROYW1lID0gbnVsbDsNCiAgICAgIG1lLmN1cnJlbnRJdGVtLkhvbWVXYXJkTmFtZSA9IG51bGw7DQoNCiAgICAgIG1lLmRpc3RyaWN0RGF0YUhvbWUgPSBbXTsNCiAgICAgIG1lLndhcmREYXRhSG9tZSA9IFtdOw0KICAgICAgbWUuZ2V0RGlzdHJpY3RCeVByb3ZpbmNlSUQoaXRlbS5Mb2NhdGlvbklELCAxKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogVEROR0hJQSAyMy85LzIwMjENCiAgICAgKiBIw6BtIHjhu60gbMO9IGxvYWQgY29tYm8gZGlzdHJpY3QgxJHhu4thIGNo4buJIHRoxrDhu51uZyB0csO6DQogICAgICovDQogICAgc2VsZWN0ZWRQcm92aW5jZVBlcm1hbmVudChzZWxlY3RlZERhdGEpIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCiAgICAgIGxldCBpdGVtID0gc2VsZWN0ZWREYXRhLm5ld0RhdGE7DQoNCiAgICAgIG1lLmN1cnJlbnRJdGVtLlBlcm1hbmVudFByb3ZpbmNlTmFtZSA9IGl0ZW0uTG9jYXRpb25OYW1lOw0KICAgICAgbWUuY3VycmVudEl0ZW0uUGVybWFuZW50RGlzdHJpY3QgPSBudWxsOw0KICAgICAgbWUuY3VycmVudEl0ZW0uUGVybWFuZW50V2FyZCA9IG51bGw7DQogICAgICBtZS5jdXJyZW50SXRlbS5QZXJtYW5lbnREaXN0cmljdE5hbWUgPSBudWxsOw0KICAgICAgbWUuY3VycmVudEl0ZW0uUGVybWFuZW50V2FyZE5hbWUgPSBudWxsOw0KDQogICAgICBtZS5kaXN0cmljdERhdGFQZXJtYW5lbnQgPSBbXTsNCiAgICAgIG1lLndhcmREYXRhUGVybWFuZW50ID0gW107DQogICAgICBtZS5nZXREaXN0cmljdEJ5UHJvdmluY2VJRChpdGVtLkxvY2F0aW9uSUQsIDIpOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBURE5HSElBIDIzLzkvMjAyMQ0KICAgICAqIEjDoG0geOG7rSBsw70gbG9hZCBjb21ibyBkaXN0cmljdCBuxqFpIOG7nyBoaeG7h24gbmF5DQogICAgICovDQogICAgc2VsZWN0ZWRQcm92aW5jZUN1cnJlbnQoc2VsZWN0ZWREYXRhKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQogICAgICBsZXQgaXRlbSA9IHNlbGVjdGVkRGF0YS5uZXdEYXRhOw0KDQogICAgICBtZS5jdXJyZW50SXRlbS5DdXJyZW50RGlzdHJpY3ROYW1lID0gaXRlbS5Mb2NhdGlvbk5hbWU7DQogICAgICBtZS5jdXJyZW50SXRlbS5DdXJyZW50RGlzdHJpY3QgPSBudWxsOw0KICAgICAgbWUuY3VycmVudEl0ZW0uQ3VycmVudFdhcmQgPSBudWxsOw0KICAgICAgbWUuY3VycmVudEl0ZW0uQ3VycmVudERpc3RyaWN0TmFtZSA9IG51bGw7DQogICAgICBtZS5jdXJyZW50SXRlbS5DdXJyZW50V2FyZE5hbWUgPSBudWxsOw0KDQogICAgICBtZS5kaXN0cmljdERhdGFDdXJyZW50ID0gW107DQogICAgICBtZS53YXJkRGF0YUN1cnJlbnQgPSBbXTsNCiAgICAgIG1lLmdldERpc3RyaWN0QnlQcm92aW5jZUlEKGl0ZW0uTG9jYXRpb25JRCwgMyk7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIEzhuqV5IGRhbmggc8OhY2ggUXXhuq1uL2h1eeG7h24NCiAgICAgKiBURE5HSElBIDE0LzEwLzIwMjENCiAgICAgKi8NCiAgICBnZXREaXN0cmljdEJ5UHJvdmluY2VJRChpZCwgbW9kZSkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KDQogICAgICBpZiAoaWQpIHsNCiAgICAgICAgbWUuJHN0b3JlDQogICAgICAgICAgLmRpc3BhdGNoKGAke01vZHVsZUxvY2F0aW9ufS9nZXRSZWZlcmVuY2VEaXN0cmljdGAsIHsNCiAgICAgICAgICAgIHByb3ZpbmNlSUQ6IGlkLA0KICAgICAgICAgIH0pDQogICAgICAgICAgLnRoZW4oKHJlcykgPT4gew0KICAgICAgICAgICAgaWYgKHJlcykgew0KICAgICAgICAgICAgICBzd2l0Y2ggKG1vZGUpIHsNCiAgICAgICAgICAgICAgICBjYXNlIDE6DQogICAgICAgICAgICAgICAgICBtZS5kaXN0cmljdERhdGFIb21lID0gcmVzOw0KICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAyOg0KICAgICAgICAgICAgICAgICAgbWUuZGlzdHJpY3REYXRhUGVybWFuZW50ID0gcmVzOw0KICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAzOg0KICAgICAgICAgICAgICAgICAgbWUuZGlzdHJpY3REYXRhQ3VycmVudCA9IHJlczsNCiAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgfSk7DQogICAgICB9DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIFPhu7Ega2nhu4duIHRoYXkgxJHhu5VpIFF14bqtbiBIdXnhu4duIHF1w6ogcXXDoW4NCiAgICAgKiBESFBISQ0KICAgICAqLw0KICAgIHNlbGVjdGVkRGlzdHJpY3RIb21lKHNlbGVjdGVkRGF0YSkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgbGV0IGl0ZW0gPSBzZWxlY3RlZERhdGEubmV3RGF0YTsNCg0KICAgICAgbWUuY3VycmVudEl0ZW0uSG9tZURpc3RyaWN0TmFtZSA9IGl0ZW0uTG9jYXRpb25OYW1lOw0KICAgICAgbWUuY3VycmVudEl0ZW0uSG9tZVdhcmQgPSBudWxsOw0KICAgICAgbWUuY3VycmVudEl0ZW0uSG9tZVdhcmROYW1lID0gbnVsbDsNCg0KICAgICAgbWUud2FyZERhdGFIb21lID0gW107DQogICAgICBtZS5nZXRXYXJkQnlEaXN0cmljdElEKGl0ZW0uTG9jYXRpb25JRCwgMSk7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIFPhu7Ega2nhu4duIHRoYXkgxJHhu5VpIFF14bqtbiBIdXnhu4duIHRoxrDhu51uZyB0csO6DQogICAgICogREhQSEkNCiAgICAgKi8NCiAgICBzZWxlY3RlZERpc3RyaWN0UGVybWFuZW50KHNlbGVjdGVkRGF0YSkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgbGV0IGl0ZW0gPSBzZWxlY3RlZERhdGEubmV3RGF0YTsNCg0KICAgICAgbWUuY3VycmVudEl0ZW0uUGVybWFuZW50RGlzdHJpY3ROYW1lID0gaXRlbS5Mb2NhdGlvbk5hbWU7DQogICAgICBtZS5jdXJyZW50SXRlbS5QZXJtYW5lbnRXYXJkID0gbnVsbDsNCiAgICAgIG1lLmN1cnJlbnRJdGVtLlBlcm1hbmVudFdhcmROYW1lID0gbnVsbDsNCg0KICAgICAgbWUud2FyZERhdGFQZXJtYW5lbnQgPSBbXTsNCiAgICAgIG1lLmdldFdhcmRCeURpc3RyaWN0SUQoaXRlbS5Mb2NhdGlvbklELCAyKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogU+G7sSBraeG7h24gdGhheSDEkeG7lWkgUXXhuq1uIEh1eeG7h24NCiAgICAgKiBESFBISQ0KICAgICAqLw0KICAgIHNlbGVjdGVkRGlzdHJpY3RDdXJyZW50KHNlbGVjdGVkRGF0YSkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgbGV0IGl0ZW0gPSBzZWxlY3RlZERhdGEubmV3RGF0YTsNCg0KICAgICAgbWUuY3VycmVudEl0ZW0uQ3VycmVudERpc3RyaWN0TmFtZSA9IGl0ZW0uTG9jYXRpb25OYW1lOw0KICAgICAgbWUuY3VycmVudEl0ZW0uQ3VycmVudFdhcmQgPSBudWxsOw0KICAgICAgbWUuY3VycmVudEl0ZW0uQ3VycmVudFdhcmROYW1lID0gbnVsbDsNCg0KICAgICAgbWUud2FyZERhdGFDdXJyZW50ID0gW107DQogICAgICBtZS5nZXRXYXJkQnlEaXN0cmljdElEKGl0ZW0uTG9jYXRpb25JRCwgMyk7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIHPhu7Ega2nhu4duIHRoYXkgxJHhu5VpIHjDoyAvIHBoxrDhu51uZw0KICAgICAqIE5NVFVBTjIgMDQuMDEuMjAyMg0KICAgICAqLw0KICAgIHNlbGVjdGVkV2FyZEhvbWUoc2VsZWN0ZWREYXRhKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQogICAgICBsZXQgaXRlbSA9IHNlbGVjdGVkRGF0YS5uZXdEYXRhOw0KDQogICAgICBtZS5jdXJyZW50SXRlbS5Ib21lV2FyZE5hbWUgPSBpdGVtLkxvY2F0aW9uTmFtZTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogc+G7sSBraeG7h24gdGhheSDEkeG7lWkgeMOjIC8gcGjGsOG7nW5nDQogICAgICogTk1UVUFOMiAwNC4wMS4yMDIyDQogICAgICovDQogICAgc2VsZWN0ZWRXYXJkUGVybWFuZW50KHNlbGVjdGVkRGF0YSkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgbGV0IGl0ZW0gPSBzZWxlY3RlZERhdGEubmV3RGF0YTsNCg0KICAgICAgbWUuY3VycmVudEl0ZW0uUGVybWFuZW50V2FyZE5hbWUgPSBpdGVtLkxvY2F0aW9uTmFtZTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogc+G7sSBraeG7h24gdGhheSDEkeG7lWkgeMOjIC8gcGjGsOG7nW5nDQogICAgICogTk1UVUFOMiAwNC4wMS4yMDIyDQogICAgICovDQogICAgc2VsZWN0ZWRXYXJkQ3VycmVudChzZWxlY3RlZERhdGEpIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCiAgICAgIGxldCBpdGVtID0gc2VsZWN0ZWREYXRhLm5ld0RhdGE7DQoNCiAgICAgIG1lLmN1cnJlbnRJdGVtLkN1cnJlbnRXYXJkTmFtZSA9IGl0ZW0uTG9jYXRpb25OYW1lOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBM4bqleSBk4buvIGxp4buHdSB04buJbmggdGjDoG5oIHBo4buRDQogICAgICogVEROR0hJQSAxNC8xMC8yMDIxDQogICAgICovDQogICAgZ2V0UHJvdmluY2VEYXRhKCkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KDQogICAgICBtZS4kc3RvcmUuZGlzcGF0Y2goYCR7TW9kdWxlTG9jYXRpb259L2dldEFsbFByb3ZpbmNlYCkudGhlbigocmVzKSA9PiB7DQogICAgICAgIGlmIChyZXMpIHsNCiAgICAgICAgICBtZS5wcm92aW5jZURhdGEgPSByZXM7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBM4bqleSBkYW5oIHPDoWNoIFjDoy9QaMaw4budbmcNCiAgICAgKi8NCiAgICBnZXRXYXJkQnlEaXN0cmljdElEKGlkLCBtb2RlKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQoNCiAgICAgIGlmIChpZCkgew0KICAgICAgICBtZS4kc3RvcmUNCiAgICAgICAgICAuZGlzcGF0Y2goYCR7TW9kdWxlTG9jYXRpb259L2dldFdhcmRCeURpc3RyaWN0SURgLCB7DQogICAgICAgICAgICBkaXN0cmljdElEOiBpZCwNCiAgICAgICAgICB9KQ0KICAgICAgICAgIC50aGVuKChyZXMpID0+IHsNCiAgICAgICAgICAgIGlmIChyZXMpIHsNCiAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7DQogICAgICAgICAgICAgICAgY2FzZSAxOg0KICAgICAgICAgICAgICAgICAgbWUud2FyZERhdGFIb21lID0gcmVzOw0KICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAyOg0KICAgICAgICAgICAgICAgICAgbWUud2FyZERhdGFQZXJtYW5lbnQgPSByZXM7DQogICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlIDM6DQogICAgICAgICAgICAgICAgICBtZS53YXJkRGF0YUN1cnJlbnQgPSByZXM7DQogICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pOw0KICAgICAgfQ0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBDb3B5IMSR4buLYSBjaOG7iSB04burIDE6IHF1w6ogcXXDoW4gMjogdGjGsOG7nW5nIHRyw7oNCiAgICAgKiBURE5HSElBIDI5LzEwLzIwMjENCiAgICAgKi8NCiAgICBjb3B5QWRkcmVzcyhtb2RlKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQoNCiAgICAgIHN3aXRjaCAobW9kZSkgew0KICAgICAgICBjYXNlIDE6DQogICAgICAgICAgbWUuY3VycmVudEl0ZW0uUGVybWFuZW50UHJvdmluY2UgPSBtZS5jdXJyZW50SXRlbS5Ib21lUHJvdmluY2U7DQogICAgICAgICAgbWUuY3VycmVudEl0ZW0uUGVybWFuZW50RGlzdHJpY3QgPSBtZS5jdXJyZW50SXRlbS5Ib21lRGlzdHJpY3Q7DQogICAgICAgICAgbWUuY3VycmVudEl0ZW0uUGVybWFuZW50V2FyZCA9IG1lLmN1cnJlbnRJdGVtLkhvbWVXYXJkOw0KICAgICAgICAgIG1lLmN1cnJlbnRJdGVtLlBlcm1hbmVudFByb3ZpbmNlTmFtZSA9DQogICAgICAgICAgICBtZS5jdXJyZW50SXRlbS5Ib21lUHJvdmluY2VOYW1lOw0KICAgICAgICAgIG1lLmN1cnJlbnRJdGVtLlBlcm1hbmVudERpc3RyaWN0TmFtZSA9DQogICAgICAgICAgICBtZS5jdXJyZW50SXRlbS5Ib21lRGlzdHJpY3ROYW1lOw0KICAgICAgICAgIG1lLmN1cnJlbnRJdGVtLlBlcm1hbmVudFdhcmROYW1lID0gbWUuY3VycmVudEl0ZW0uSG9tZVdhcmROYW1lOw0KICAgICAgICAgIG1lLmN1cnJlbnRJdGVtLlBlcm1hbmVudEFkZHJlc3MgPSBtZS5jdXJyZW50SXRlbS5Ib21lQWRkcmVzczsNCiAgICAgICAgICBtZS5nZXREaXN0cmljdEJ5UHJvdmluY2VJRChtZS5jdXJyZW50SXRlbS5QZXJtYW5lbnRQcm92aW5jZSwgMik7DQogICAgICAgICAgbWUuZ2V0V2FyZEJ5RGlzdHJpY3RJRChtZS5jdXJyZW50SXRlbS5QZXJtYW5lbnREaXN0cmljdCwgMik7DQogICAgICAgICAgLy8gLy9Dw6BpIHNlbGVjdGlvbiBjaG8gMyBjb21ibw0KICAgICAgICAgIC8vIG1lLnNldEludGVybmFsVmFsdWVDb21ibygNCiAgICAgICAgICAvLyAgIG1lLiRyZWZzLmNib1Byb3ZpbmNlUGVybWFuZW50LA0KICAgICAgICAgIC8vICAgbWUuY3VycmVudEl0ZW0uSG9tZVByb3ZpbmNlTmFtZSwNCiAgICAgICAgICAvLyAgIG1lLmN1cnJlbnRJdGVtLkhvbWVQcm92aW5jZQ0KICAgICAgICAgIC8vICk7DQogICAgICAgICAgLy8gbWUuc2V0SW50ZXJuYWxWYWx1ZUNvbWJvKA0KICAgICAgICAgIC8vICAgbWUuJHJlZnMuY2JvRGlzdHJpY3RQZXJtYW5lbnQsDQogICAgICAgICAgLy8gICBtZS5jdXJyZW50SXRlbS5Ib21lRGlzdHJpY3ROYW1lLA0KICAgICAgICAgIC8vICAgbWUuY3VycmVudEl0ZW0uSG9tZURpc3RyaWN0DQogICAgICAgICAgLy8gKTsNCiAgICAgICAgICAvLyBtZS5zZXRJbnRlcm5hbFZhbHVlQ29tYm8oDQogICAgICAgICAgLy8gICBtZS4kcmVmcy5jYm9XYXJkUGVybWFuZW50LA0KICAgICAgICAgIC8vICAgbWUuY3VycmVudEl0ZW0uSG9tZVdhcmROYW1lLA0KICAgICAgICAgIC8vICAgbWUuY3VycmVudEl0ZW0uSG9tZVdhcmQNCiAgICAgICAgICAvLyApOw0KICAgICAgICAgIGJyZWFrOw0KDQogICAgICAgIGNhc2UgMjoNCiAgICAgICAgICBtZS5jdXJyZW50SXRlbS5DdXJyZW50UHJvdmluY2UgPSBtZS5jdXJyZW50SXRlbS5QZXJtYW5lbnRQcm92aW5jZTsNCiAgICAgICAgICBtZS5jdXJyZW50SXRlbS5DdXJyZW50RGlzdHJpY3QgPSBtZS5jdXJyZW50SXRlbS5QZXJtYW5lbnREaXN0cmljdDsNCiAgICAgICAgICBtZS5jdXJyZW50SXRlbS5DdXJyZW50V2FyZCA9IG1lLmN1cnJlbnRJdGVtLlBlcm1hbmVudFdhcmQ7DQogICAgICAgICAgbWUuY3VycmVudEl0ZW0uQ3VycmVudFByb3ZpbmNlTmFtZSA9DQogICAgICAgICAgICBtZS5jdXJyZW50SXRlbS5QZXJtYW5lbnRQcm92aW5jZU5hbWU7DQogICAgICAgICAgbWUuY3VycmVudEl0ZW0uQ3VycmVudERpc3RyaWN0TmFtZSA9DQogICAgICAgICAgICBtZS5jdXJyZW50SXRlbS5QZXJtYW5lbnREaXN0cmljdE5hbWU7DQogICAgICAgICAgbWUuY3VycmVudEl0ZW0uQ3VycmVudFdhcmROYW1lID0gbWUuY3VycmVudEl0ZW0uUGVybWFuZW50V2FyZE5hbWU7DQogICAgICAgICAgbWUuY3VycmVudEl0ZW0uQ3VycmVudEFkZHJlc3MgPSBtZS5jdXJyZW50SXRlbS5QZXJtYW5lbnRBZGRyZXNzOw0KICAgICAgICAgIG1lLmdldERpc3RyaWN0QnlQcm92aW5jZUlEKG1lLmN1cnJlbnRJdGVtLkN1cnJlbnRQcm92aW5jZSwgMyk7DQogICAgICAgICAgbWUuZ2V0V2FyZEJ5RGlzdHJpY3RJRChtZS5jdXJyZW50SXRlbS5DdXJyZW50RGlzdHJpY3QsIDMpOw0KICAgICAgICAgIC8vIC8vQ8OgaSBzZWxlY3Rpb24gY2hvIDMgY29tYm8NCiAgICAgICAgICAvLyBtZS5zZXRJbnRlcm5hbFZhbHVlQ29tYm8oDQogICAgICAgICAgLy8gICBtZS4kcmVmcy5jYm9Qcm92aW5jZUN1cnJlbnQsDQogICAgICAgICAgLy8gICBtZS5jdXJyZW50SXRlbS5QZXJtYW5lbnRQcm92aW5jZU5hbWUsDQogICAgICAgICAgLy8gICBtZS5jdXJyZW50SXRlbS5QZXJtYW5lbnRQcm92aW5jZQ0KICAgICAgICAgIC8vICk7DQogICAgICAgICAgLy8gbWUuc2V0SW50ZXJuYWxWYWx1ZUNvbWJvKA0KICAgICAgICAgIC8vICAgbWUuJHJlZnMuY2JvRGlzdHJpY3RDdXJyZW50LA0KICAgICAgICAgIC8vICAgbWUuY3VycmVudEl0ZW0uUGVybWFuZW50RGlzdHJpY3ROYW1lLA0KICAgICAgICAgIC8vICAgbWUuY3VycmVudEl0ZW0uUGVybWFuZW50RGlzdHJpY3QNCiAgICAgICAgICAvLyApOw0KICAgICAgICAgIC8vIG1lLnNldEludGVybmFsVmFsdWVDb21ibygNCiAgICAgICAgICAvLyAgIG1lLiRyZWZzLmNib1dhcmRDdXJyZW50LA0KICAgICAgICAgIC8vICAgbWUuY3VycmVudEl0ZW0uUGVybWFuZW50V2FyZE5hbWUsDQogICAgICAgICAgLy8gICBtZS5jdXJyZW50SXRlbS5QZXJtYW5lbnRXYXJkDQogICAgICAgICAgLy8gKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgLyoqDQogICAgICogQ29weSBnacOhIHRy4buLIG3hu5tpIGNobyBjb21ibyDEkeG7i2EgY2jhu4kNCiAgICAgKiBURE5HSElBIDI3LzEyLzIwMjENCiAgICAgKi8NCiAgICBzZXRJbnRlcm5hbFZhbHVlQ29tYm8oY29tYm8sIHRleHQsIHZhbHVlKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQogICAgICBsZXQgaXRlbSA9IHsNCiAgICAgICAgS2luZDogMywNCiAgICAgICAgTG9jYXRpb25JRDogdmFsdWUsDQogICAgICAgIExvY2F0aW9uTmFtZTogdGV4dCwNCiAgICAgIH07DQoNCiAgICAgIGNvbWJvLnNldEludGVybmFsSXRlbShpdGVtKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogQ3VzdG9tIGThu68gbGnhu4d1IHRo4buxYyBoaeG7h24gY+G6pXQNCiAgICAgKiBKU09OIGzhuqFpIGPDoWMgYuG6o25nDQogICAgICovDQogICAgY3VzdG9tU2F2ZURhdGEoZWRpdE1vZGUsIGRhdGEpIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCg0KICAgICAgaWYgKGRhdGEuRGF0ZU9mQmlydGggIT09IG51bGwpIHsNCiAgICAgICAgaWYgKGRhdGEuVGltZVR5cGUgPT09IDApIHsNCiAgICAgICAgICBkYXRhLkRhdGVPZkJpcnRoID0gbWUuJG1zLmNvbW1vbkZuLmZvcm1hdERhdGVUaW1lKGRhdGEuRGF0ZU9mQmlydGgpOw0KICAgICAgICB9DQogICAgICB9DQogICAgICBkYXRhLldvcmtpbmdEZXRhaWwgPSBKU09OLnN0cmluZ2lmeShtZS5saXN0U291cmNlV29ya2luZ0RldGFpbCk7DQogICAgICBkYXRhLk1pc3Npb25Sb2xlID0gSlNPTi5zdHJpbmdpZnkobWUubGlzdFNvdXJjZU1pc3Npb25Sb2xlKTsNCg0KICAgICAgLy9LaGkgbMawdSB0aMOsIHjDs2EgYuG7m3QgdGjDtG5nIHRpbiBraMO0bmcgY+G6p24gdGhp4bq/dCBsacOqbiBxdWFuIMSR4bq/biB04buHcCDEkcOtbmgga8OobQ0KICAgICAgbWUubGlzdFNvdXJjZUFjaGlldmVtZW50SWRlYS5mb3JFYWNoKChpdGVtKSA9PiB7DQogICAgICAgIGRlbGV0ZSBpdGVtLkF0dGFjaG1lbnRDaGFuZ2VzOw0KICAgICAgICBkZWxldGUgaXRlbS5GaWxlVHlwZTsNCiAgICAgIH0pOw0KICAgICAgZGF0YS5BY2hpZXZlbWVudElkZWEgPSBKU09OLnN0cmluZ2lmeShtZS5saXN0U291cmNlQWNoaWV2ZW1lbnRJZGVhKTsNCg0KICAgICAgLy9LaGkgbMawdSB0aMOsIHjDs2EgYuG7m3QgdGjDtG5nIHRpbiBraMO0bmcgY+G6p24gdGhp4bq/dCBsacOqbiBxdWFuIMSR4bq/biB04buHcCDEkcOtbmgga8OobQ0KICAgICAgbWUubGlzdFNvdXJjZUVtdWxhdGlvblRpdGxlRGV0YWlsLmZvckVhY2goKGl0ZW0pID0+IHsNCiAgICAgICAgZGVsZXRlIGl0ZW0uQXR0YWNobWVudENoYW5nZXM7DQogICAgICAgIGRlbGV0ZSBpdGVtLkZpbGVUeXBlOw0KICAgICAgfSk7DQoNCiAgICAgIGRhdGEuRW11bGF0aW9uVGl0bGVEZXRhaWwgPSBKU09OLnN0cmluZ2lmeSgNCiAgICAgICAgbWUubGlzdFNvdXJjZUVtdWxhdGlvblRpdGxlRGV0YWlsDQogICAgICApOw0KDQogICAgICAvL0toaSBsxrB1IHRow6wgeMOzYSBi4bubdCB0aMO0bmcgdGluIGtow7RuZyBj4bqnbiB0aGnhur90IGxpw6puIHF1YW4gxJHhur9uIHThu4dwIMSRw61uaCBrw6htDQogICAgICBtZS5saXN0U291cmNlUmV3YXJkQ2F0ZWdvcnlEZXRhaWwuZm9yRWFjaCgoaXRlbSkgPT4gew0KICAgICAgICBkZWxldGUgaXRlbS5BdHRhY2htZW50Q2hhbmdlczsNCiAgICAgICAgZGVsZXRlIGl0ZW0uRmlsZVR5cGU7DQogICAgICB9KTsNCiAgICAgIGRhdGEuUmV3YXJkQ2F0ZWdvcnlEZXRhaWwgPSBKU09OLnN0cmluZ2lmeSgNCiAgICAgICAgbWUubGlzdFNvdXJjZVJld2FyZENhdGVnb3J5RGV0YWlsDQogICAgICApOw0KICAgICAgLy9UaMOqbSBlZGl0TW9kZSBjaG8gdHLGsOG7nW5nIGRldGFpbCB04buHcCDEkcOtbmgga8OobQ0KICAgICAgbWUubGlzdFNvdXJjZUF0dGFjaG1lbnREZXRhaWwuZm9yRWFjaCgoaXRlbSkgPT4gew0KICAgICAgICBpdGVtLkVudGl0eVN0YXRlID0NCiAgICAgICAgICBpdGVtLkVudGl0eVN0YXRlID09IG1lLiRtcy5lbnVtLk1vZGVsU3RhdGUuVXBkYXRlDQogICAgICAgICAgICA/IG1lLiRtcy5lbnVtLk1vZGVsU3RhdGUuVXBkYXRlDQogICAgICAgICAgICA6IG1lLiRtcy5lbnVtLk1vZGVsU3RhdGUuSW5zZXJ0Ow0KICAgICAgfSk7DQogICAgICAvL01lcmdlIHRow6ptIGRhbmggc8OhY2ggeMOzYSB04buHcCDEkcOtbmgga8OobSB2w6BvIMSR4buBIHjDs2EgbWFzdGVyLWRldGFpbA0KICAgICAgZGF0YS5BdHRhY2htZW50RGV0YWlsID0gWw0KICAgICAgICAuLi5tZS5saXN0U291cmNlQXR0YWNobWVudERldGFpbCwNCiAgICAgICAgLi4ubWUubGlzdERlbGV0ZUF0dGFjaG1lbnQsDQogICAgICBdOw0KDQogICAgICAvL0toaSBsxrB1IHRow6wgeMOzYSBi4bubdCB0aMO0bmcgdGluIGtow7RuZyBj4bqnbiB0aGnhur90IGxpw6puIHF1YW4gxJHhur9uIHThu4dwIMSRw61uaCBrw6htDQogICAgICBtZS5saXN0U291cmNlRGlzY2lwbGluZURldGFpbC5mb3JFYWNoKChpdGVtKSA9PiB7DQogICAgICAgIGRlbGV0ZSBpdGVtLkF0dGFjaG1lbnRDaGFuZ2VzOw0KICAgICAgICBkZWxldGUgaXRlbS5GaWxlVHlwZTsNCiAgICAgIH0pOw0KICAgICAgZGF0YS5EaXNjaXBsaW5lRGV0YWlsID0gSlNPTi5zdHJpbmdpZnkobWUubGlzdFNvdXJjZURpc2NpcGxpbmVEZXRhaWwpOw0KDQogICAgICAvLyBUaMO0bmcgdGluIMSRw6FuaCBnacOhDQogICAgICBkYXRhLkV2YWx1YXRpb25EZXRhaWwgPSBKU09OLnN0cmluZ2lmeShtZS5saXN0U291cmNlRXZhbHVhdGlvbkRldGFpbCk7DQoNCiAgICAgIGxldCBuYW1lQXJyID0gZGF0YS5GdWxsTmFtZS5zcGxpdCgiICIpOw0KICAgICAgZGF0YS5GaXJzdE5hbWUgPSBuYW1lQXJyWzBdOw0KICAgICAgZGF0YS5MYXN0TmFtZSA9IG5hbWVBcnJbbmFtZUFyci5sZW5ndGggLSAxXTsNCg0KICAgICAgaWYgKCFtZS5pc091dFNpZGVyKSB7DQogICAgICAgIGRhdGEuRGVwYXJ0bWVudE5hbWUgPSBtZS4kcmVmcy5jYm9EZXBhcnRtZW50LmludGVybmFsVGV4dDsNCiAgICAgIH0NCg0KICAgICAgZGF0YS5BY2FkZW1pY1RpdGxlTmFtZSA9IG1lLiRyZWZzLkFjYWRlbWljVGl0bGVDYm8uaW50ZXJuYWxUZXh0Ow0KICAgICAgZGF0YS5BY2FkZW1pY1JhbmtOYW1lID0gbWUuJHJlZnMuQWNhZGVtaWNSYW5rQ2JvLmludGVybmFsVGV4dDsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogY3VzdG9tZSBs4bqhaSBwYXlsb2FkIGPhu6dhIGNvbWJvIGRlcGFydG1lbnQNCiAgICAgKiBURE5HSElBIDI4LzEwLzIwMjENCiAgICAgKiB0eXBlIHThu7EgdOG6oW8gcmEgxJHhu4MgY2FzZSBjaG8gdOG7q25nIGNvbWJvIHRyb25nIG3DoG4gbsOgeQ0KICAgICAqLw0KICAgIGN1c3RvbVBheWxvYWRDb21ibyhwYXlsb2FkLCB0eXBlKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQoNCiAgICAgIGlmICghcGF5bG9hZC5maWx0ZXIpIHsNCiAgICAgICAgcGF5bG9hZC5maWx0ZXIgPSBbXTsNCiAgICAgIH0NCiAgICAgIGlmICgNCiAgICAgICAgbWUub3B0aW9ucy5jb250ZXh0Lk9yZ2FuaXphdGlvbi5BZG1pbmlzdHJhdGl2ZUxldmVsICE9DQogICAgICAgIG1lLiRtcy5lbnVtLkFwcGx5TGV2ZWwuUHJvdmluY2VMZXZlbA0KICAgICAgKSB7DQogICAgICAgIHBheWxvYWQuZmlsdGVyLnB1c2goew0KICAgICAgICAgIHByb3BlcnR5OiAiQXBwbHlMZXZlbElEIiwNCiAgICAgICAgICB2YWx1ZTogbWUub3B0aW9ucy5jb250ZXh0Lk9yZ2FuaXphdGlvbi5BZG1pbmlzdHJhdGl2ZUxldmVsLnRvU3RyaW5nKCksDQogICAgICAgICAgb3BlcmF0b3I6IG1lLiRtcy5lbnVtLkZpbHRlckhlYWRlci5Db250YWlucywNCiAgICAgICAgICBvcGVyYW5kOiAiYW5kIiwNCiAgICAgICAgfSk7DQogICAgICB9DQoNCiAgICAgIHBheWxvYWQuZmlsdGVyLnB1c2goew0KICAgICAgICBwcm9wZXJ0eTogIkluYWN0aXZlIiwNCiAgICAgICAgdmFsdWU6ICIwIiwNCiAgICAgICAgb3BlcmF0b3I6IG1lLiRtcy5lbnVtLkZpbHRlckhlYWRlci5FcXVhbHMsDQogICAgICAgIG9wZXJhbmQ6ICJhbmQiLA0KICAgICAgfSk7DQoNCiAgICAgIHBheWxvYWQuZmlsdGVyLnB1c2goew0KICAgICAgICBwcm9wZXJ0eTogIkpvYlBvc2l0aW9uVHlwZSIsDQogICAgICAgIHZhbHVlOiB0eXBlID09IG1lLiRtcy5lbnVtLkpvYlBvc2l0aW9uVHlwZS5Qb3NpdGlvbiA/ICIwIiA6ICIxIiwNCiAgICAgICAgb3BlcmF0b3I6IG1lLiRtcy5lbnVtLkZpbHRlckhlYWRlci5FcXVhbHMsDQogICAgICAgIG9wZXJhbmQ6ICJhbmQiLA0KICAgICAgfSk7DQoNCiAgICAgIHBheWxvYWRbInNvcnQiXSA9ICJKb2JQb3NpdGlvbk5hbWUgQVNDIjsgLy9UaMOqbSBzb3J0IHbDoG8gcGF5bG9hZCDEkeG7gyBz4bqvcCB44bq/cCBs4bqhaSB0aOG7qSB04buxIGNvbWJvIE5URElFTSAzMS4wMy4yMDIyDQoNCiAgICAgIG1lLnN1cGVyKCJjdXN0b21QYXlsb2FkQ29tYm8iLCBwYXlsb2FkKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogY3VzdG9tIHRoYW0gc+G7kSBs4bqleSBk4buvIGxp4buHdSBuZ2jhu4EgbmdoaeG7h3ANCiAgICAgKiBOVFRIQU5IMQ0KICAgICAqLw0KICAgIGN1c3RvbVBheWxvYWRQaWNrTGlzdChwYXlsb2FkKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQoNCiAgICAgIGlmICghcGF5bG9hZC5maWx0ZXIpIHsNCiAgICAgICAgcGF5bG9hZC5maWx0ZXIgPSBbXTsNCiAgICAgIH0NCg0KICAgICAgcGF5bG9hZC5maWx0ZXIucHVzaCgNCiAgICAgICAgew0KICAgICAgICAgIHByb3BlcnR5OiAiUGlja0xpc3RUeXBlIiwNCiAgICAgICAgICB2YWx1ZTogbWUuJG1zLmVudW0uUGlja0xpc3RUeXBlLkNhcmVlck5hbWUsDQogICAgICAgICAgb3BlcmF0b3I6IG1lLiRtcy5lbnVtLkZpbHRlckhlYWRlci5FcXVhbHMsDQogICAgICAgICAgb3BlcmFuZDogImFuZCIsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBwcm9wZXJ0eTogIkluYWN0aXZlIiwNCiAgICAgICAgICB2YWx1ZTogZmFsc2UsDQogICAgICAgICAgb3BlcmF0b3I6IG1lLiRtcy5lbnVtLkZpbHRlckhlYWRlci5FcXVhbHMsDQogICAgICAgICAgb3BlcmFuZDogImFuZCIsDQogICAgICAgIH0NCiAgICAgICk7DQogICAgICByZXR1cm4gcGF5bG9hZDsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogQ29weSB0aMO0bmcgdGluIGPDtG5nIHZp4buHYyBn4bqnbiBuaOG6pXQNCiAgICAgKiBURE5HSElBIDIvMTEvMjAyMQ0KICAgICAqLw0KICAgIGdldEN1cnJlbnRXb3JraW5nRGV0YWlsKCkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KDQogICAgICBpZiAobWUubGlzdFNvdXJjZVdvcmtpbmdEZXRhaWxbMF0pIHsNCiAgICAgICAgbGV0IGl0ZW0gPSBtZS5saXN0U291cmNlV29ya2luZ0RldGFpbFswXTsNCg0KICAgICAgICBtZS5jdXJyZW50SXRlbS5Pcmdhbml6YXRpb25OYW1lID0gaXRlbS5Pcmdhbml6YXRpb25OYW1lOw0KICAgICAgICBtZS5jdXJyZW50SXRlbS5Kb2JQb3NpdGlvbklEID0gaXRlbS5Kb2JQb3NpdGlvbklEOw0KICAgICAgICBtZS5jdXJyZW50SXRlbS5Kb2JQb3NpdGlvbk5hbWUgPSBpdGVtLkpvYlBvc2l0aW9uTmFtZTsNCiAgICAgICAgbWUuY3VycmVudEl0ZW0uSm9iVGl0bGVJRCA9IGl0ZW0uSm9iVGl0bGVJRDsNCiAgICAgICAgbWUuY3VycmVudEl0ZW0uSm9iVGl0bGVOYW1lID0gaXRlbS5Kb2JUaXRsZU5hbWU7DQogICAgICAgIG1lLmN1cnJlbnRJdGVtLldvcmtpbmdPbkRhdGUgPSBpdGVtLkZyb21EYXRlOw0KICAgICAgICBtZS5jdXJyZW50SXRlbS5EZXBhcnRtZW50SUQgPSBudWxsOw0KICAgICAgICBtZS5jdXJyZW50SXRlbS5EZXBhcnRtZW50TmFtZSA9IGl0ZW0uRGVwYXJ0bWVudE5hbWU7DQogICAgICB9DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIENoZWNrIGNoYW5nZSB0csaw4bubYyBraGkgdGhvw6F0IHJhDQogICAgICogVEROR0hJQSAxMS8xMS8yMDIxDQogICAgICovDQogICAgY2xvc2UoKSB7DQogICAgICBsZXQgbWUgPSB0aGlzOw0KDQogICAgICBpZiAobWUuY2hlY2tDaGFuZ2VzKCkpIHsNCiAgICAgICAgbGV0IG1zZyA9IG1lLmdldENsb3NlQ29uZmlybU1lc3NhZ2UoKTsNCiAgICAgICAgbWUuJG1zLm1zZ0JveA0KICAgICAgICAgIC5zaG93Q29uZmlybShtc2csIG51bGwsIG51bGwsICJMxrB1IGjhu5Mgc8ahIHRow6BuaCB0w61jaCIpDQogICAgICAgICAgLnRoZW4oKGFuc3dlcikgPT4gew0KICAgICAgICAgICAgaWYgKGFuc3dlciA9PT0gIlllcyIpIHsNCiAgICAgICAgICAgICAgbWUuc2F2ZSh0aGlzLiRtcy5lbnVtLlNhdmVNb2RlLlNhdmUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGFuc3dlciA9PSAiTm8iKSB7DQogICAgICAgICAgICAgIG1lLmhpZGUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIG1lLmhpZGUoKTsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgLyoqDQogICAgICogTOG6pXkgbuG7mWkgZHVuZyB0aMO0bmcgYsOhbyB0aGVvIG3DoyB2YWxpZGF0ZQ0KICAgICAqIFRETkdISUEgb3ZlcnJpZGUgbOG6oWkgY3VzdG9tIGPDonUgZHVwbGljYXRlDQogICAgICovDQogICAgZ2V0VmFsaWRhdGVNZXNzYWdlKHZhbGlkYXRlQ29kZSwgZGF0YSkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgbGV0IG1zZyA9IHZhbGlkYXRlQ29kZTsNCiAgICAgIGxldCB0aXRsZU5hbWUgPSBtZS5nZXRGb3JtVGl0bGUobWUuZWRpdE1vZGUpOw0KICAgICAgbGV0IGZpZWxkID0gbWUuJHN0b3JlLnN0YXRlW21lLm1vZHVsZV0uX2NvbmZpZy5maWVsZDsNCg0KICAgICAgc3dpdGNoICh2YWxpZGF0ZUNvZGUpIHsNCiAgICAgICAgY2FzZSAiRHVwbGljYXRlIjoNCiAgICAgICAgICB2YXIgY29kZUR1cGxpY2F0ZSA9DQogICAgICAgICAgICBtZS5jdXJyZW50SXRlbVtmaWVsZC51bmlxdWVdIHx8DQogICAgICAgICAgICBtZS5jdXJyZW50SXRlbVtmaWVsZC5jb2RlXSB8fA0KICAgICAgICAgICAgbWUuY3VycmVudEl0ZW1bZmllbGQubmFtZV07DQogICAgICAgICAgdmFyIG1vZHVsZU5hbWUgPSBtZS4kdCgNCiAgICAgICAgICAgICJpMThuQ29tbW9uLm1vZHVsZS4iICsgbWUubW9kdWxlLnRvTG93ZXJDYXNlKCkNCiAgICAgICAgICApOw0KICAgICAgICAgIG1zZyA9ICJT4buRIGhp4buHdSBjw6FuIGLhu5kgPGI+ezB9PC9iPiDEkcOjIHThu5NuIHThuqFpIHRyb25nIGRhbmggc8OhY2guIFhpbiB2dWkgbMOybmcga2nhu4NtIHRyYSBs4bqhaS4iLmZvcm1hdCgNCiAgICAgICAgICAgIGNvZGVEdXBsaWNhdGUNCiAgICAgICAgICApOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgIG1zZyA9IG1lLnN1cGVyKCJnZXRWYWxpZGF0ZU1lc3NhZ2UiLCB2YWxpZGF0ZUNvZGUsIGRhdGEpOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIG1zZzsNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIFjDs2EgdOG7h3AgxJHDrW5oIGvDqG0NCiAgICAgKiBOVERJRU0gMjIuMTEuMjAyMQ0KICAgICAqIHVwZGF0ZTpDaOG7iSB4w7NhIGdp4bqjIHRyw6puIGLhuqNuZyB0aMO0aS4gS2hpIG7DoG8g4bqlbiBsxrB1IG3hu5tpIHjDs2EgdHLDqm4gZGINCiAgICAgKi8NCiAgICBkZWxldGVBdHRhY2htZW50RGV0YWlsKHJlY29yZCkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgLy9Yw7NhIHRycmVlbiBsaXN0DQogICAgICBtZS5saXN0U291cmNlQXR0YWNobWVudERldGFpbC5yZW1vdmUocmVjb3JkKTsNCiAgICAgIC8vVGjDqm0gdsOgbyBkYW5oIHPDoWNoIHjDs2EgxJHhu4MgeMOzYSB0cm9uZyBEQg0KICAgICAgLy9UaMOqbSBTdGF0ZSB2w6BvIMSR4buDIGNo4bqheSBtYXN0ZXItZGV0YWlsIEJFIHThu7EgxJHhu5luZyB4w7NhDQogICAgICByZWNvcmQuRW50aXR5U3RhdGUgPSBtZS4kbXMuZW51bS5Nb2RlbFN0YXRlLkRlbGV0ZTsNCiAgICAgIG1lLmxpc3REZWxldGVBdHRhY2htZW50LnB1c2gocmVjb3JkKTsNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIGNsaWNrIGLhuqNuIGdoaSAtPiBoaeG7g24gdGjhu4sgbWVudQ0KICAgICAqLw0KICAgIGdyaWRSb3dPdmVyKHJlY29yZCwgZSkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgbWUucm93QWN0aW9ucyA9IG1lLmdldFJlY29yZEFjdGlvbnMocmVjb3JkKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogbOG6pXkgZGFuaCBzw6FjaCBhY3Rpb24gY+G7p2EgYuG6o24gZ2hpDQogICAgICovDQogICAgZ2V0UmVjb3JkQWN0aW9ucyhyZWNvcmQpIHsNCiAgICAgIGlmICh0eXBlb2YgcmVjb3JkLkNlcnRpZmljYXRlSUQgIT09ICJ1bmRlZmluZWQiKSB7DQogICAgICAgIGlmIChyZWNvcmQuQ2VydGlmaWNhdGVJRCAhPT0gbnVsbCkgew0KICAgICAgICAgIHJldHVybiBbXTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICByZXR1cm4gWw0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBjb21tYW5kOiAiRWRpdCIsDQogICAgICAgICAgICAgIGljb246ICJlZGl0IiwNCiAgICAgICAgICAgICAgdGV4dDogdGhpcy4kdCgiaTE4bkNvbW1vbi5jb21tYW5kLmVkaXQiKSwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGNvbW1hbmQ6ICJEZWxldGUiLA0KICAgICAgICAgICAgICBpY29uOiAiZGVsZXRlIiwNCiAgICAgICAgICAgICAgdGV4dDogdGhpcy4kdCgiaTE4bkNvbW1vbi5jb21tYW5kLmRlbGV0ZSIpLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICBdOw0KICAgICAgICB9DQogICAgICB9DQogICAgICByZXR1cm4gWw0KICAgICAgICB7DQogICAgICAgICAgY29tbWFuZDogIkVkaXQiLA0KICAgICAgICAgIGljb246ICJlZGl0IiwNCiAgICAgICAgICB0ZXh0OiB0aGlzLiR0KCJpMThuQ29tbW9uLmNvbW1hbmQuZWRpdCIpLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgY29tbWFuZDogIkRlbGV0ZSIsDQogICAgICAgICAgaWNvbjogImRlbGV0ZSIsDQogICAgICAgICAgdGV4dDogdGhpcy4kdCgiaTE4bkNvbW1vbi5jb21tYW5kLmRlbGV0ZSIpLA0KICAgICAgICB9LA0KICAgICAgXTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogS2hpIGNo4buNbiBjaGVja2JveCDEkMOjIGhpIHNpbmgvdOG7qyB0cuG6p24gdGjDrCBt4bq3YyDEkeG7i25oIG7Eg20gaGkgc2luaC904burIHRy4bqnbiBsw6AgbsSDbSBoaeG7h24gdOG6oWkNCiAgICAgKg0KICAgICAqIE5NVFVBTjMgMjEvMTIvMjAyMQ0KICAgICAqLw0KICAgIHNldERhdGVPZkRlYXRoKCkgew0KICAgICAgaWYgKHRoaXMuY3VycmVudEl0ZW0uSXNHb25lKSB7DQogICAgICAgIGxldCBub3cgPSBuZXcgRGF0ZSgpOw0KDQogICAgICAgIHRoaXMuY3VycmVudEl0ZW0uRGF0ZU9mRGVhdGggPSB0aGlzLmN1cnJlbnRJdGVtLkRhdGVPZkRlYXRoDQogICAgICAgICAgPyB0aGlzLmN1cnJlbnRJdGVtLkRhdGVPZkRlYXRoDQogICAgICAgICAgOiBub3cuZ2V0RnVsbFllYXIoKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIC8qKg0KICAgICAqIFPhu7Ega2nhu4duIGNsaWNrIGNvbWJvIGNib1RpbWVUeXBlSW5QZXJpb2QNCiAgICAgKiBETEh1eSAyNy4xMi4yMDIxDQogICAgICovDQogICAgdGltZVR5cGVJblBlcmlvZF9TZWxlY3RlZChtZXRhRGF0YSkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KDQogICAgICBtZS5jdXJyZW50SXRlbS5EYXRlT2ZCaXJ0aCA9IG51bGw7DQogICAgfSwNCg0KICAgIC8qKiBi4bqvdCBz4buxIGtp4buHbiBraGkgY2xpY2sgcmEgbmdvw6BpIGRhdGVwaWNrZXIgKi8NCiAgICBibHVyRGF0ZVBpY2tlcigpIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCg0KICAgICAgbWUuJHJlZnMuY2JvRnJvbURhdGVfUGVyaW9kX0RheS5tb21lbnRNYXNrLm1hc2sgPQ0KICAgICAgICBtZS4kcmVmcy5jYm9Gcm9tRGF0ZV9QZXJpb2RfRGF5LnJhd1ZhbHVlOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBFbnRlciBjw6FjIGxpbmsgdGV4dA0KICAgICAqIFRETkdISUEgMy8zLzIwMjENCiAgICAgKi8NCiAgICBsaW5rVGV4dE9uRW50ZXIodHlwZSkgew0KICAgICAgbGV0IG1lID0gdGhpczsNCg0KICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT0gMTMpIHsNCiAgICAgICAgc3dpdGNoICh0eXBlKSB7DQogICAgICAgICAgY2FzZSAxOg0KICAgICAgICAgICAgbWUuY29weUFkZHJlc3MoMSk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgICBjYXNlIDI6DQogICAgICAgICAgICBtZS5jb3B5QWRkcmVzcygyKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIGNhc2UgMzoNCiAgICAgICAgICAgIG1lLmdldEN1cnJlbnRXb3JraW5nRGV0YWlsKCk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgbWUudGV4dExpbmtPbkNsaWNrKGV2ZW50KTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIFNldCBhdmF0YXIgbOG6pXkgdOG7qyBzdG9yYWdlDQogICAgICogTlRESUVNIDE3LzAzLzIwMjINCiAgICAgKi8NCiAgICBzZXRBdmF0YXIodmFsdWUsIGNoYW5nZSwgYXZhdGFyRmlsZSkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KDQogICAgICBsZXQgcGFyYW0gPSB7DQogICAgICAgICAgdXNlcklEOiBtZS5jdXJyZW50SXRlbS5FbXBsb3llZUlELA0KICAgICAgICAgIGZ1bGxOYW1lOiBtZS5jdXJyZW50SXRlbS5GdWxsTmFtZSwNCiAgICAgICAgICB0ZW5hbnRJRDogbWUuY29udGV4dC5Db250ZXh0LlRlbmFudElELA0KICAgICAgICAgIG9yZ2FuaXphdGlvbklEOiBtZS5jb250ZXh0Lk9yZ2FuaXphdGlvbi5Pcmdhbml6YXRpb25JRCwNCiAgICAgICAgfSwNCiAgICAgICAgdGltZSA9ICImIiArIG5ldyBEYXRlKCkuZ2V0VGltZSgpLnRvU3RyaW5nKCk7DQoNCiAgICAgIC8vTOG6pXkgdGjDqm0gdGjhu51pIGdpYW4gdsOgbyB1cmwgxJHhu4Mga2jDtG5nIGLhu4sgY2FjaGUgTlRESUVNIDE3LzAzLzIwMjINCiAgICAgIG1lLmF2YXRhclVybCA9IEltYWdlQVBJLmdldEF2YXRhckxpbmsoDQogICAgICAgIHBhcmFtLnVzZXJJRCwNCiAgICAgICAgcGFyYW0uZnVsbE5hbWUsDQogICAgICAgIHBhcmFtLnRlbmFudElELA0KICAgICAgICBwYXJhbS5vcmdhbml6YXRpb25JRA0KICAgICAgKTsNCiAgICAgIGRvY3VtZW50DQogICAgICAgIC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJlbXBveWVlLWF2YXRhciIpWzBdDQogICAgICAgIC5zZXRBdHRyaWJ1dGUoInNyYyIsIG1lLmF2YXRhclVybCArIHRpbWUpOw0KDQogICAgICBtZS5hdmF0YXJGaWxlID0gYXZhdGFyRmlsZTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogWOG7rSBsw70gc2F1IGtoaSBj4bqldA0KICAgICAqIFRETkdISUEgMTgvMy8yMDIxDQogICAgICogT3ZlcnJpZGUgbOG6oWkgxJHhu4MgZ+G7jWkgbMawdSBhdnQgZG8gY8OzIGNhc2UgbMawdSB2w6AgdGjDqm0gbeG7m2kgbsOqbiBwaOG6o2kgb3ZlcnJpZGUNCiAgICAgKiBPdmVycmlkZSBs4bqhaSDEkeG7gyB44butIGzDvSBsxrB1IEF2YXRhciBjw7MgdHLGsOG7nW5nIGjhu6NwIHRow6ptIG3hu5tpIE5URElFTSAxOC8wMy8yMDIyDQogICAgICogKi8NCiAgICBhZnRlclN1Ym1pdChyZXN1bHQsIHBhcmFtLCBhY3Rpb24pIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCg0KICAgICAgLy9ETEh1eSAwNi4xMS4yMDIxIHRow6ptIGjDoG0gbsOgeSDEkeG7gyBjdXN0b20gbOG6oWkgY8OidSB0aMO0bmcgYsOhbw0KICAgICAgbWUuZ2V0Tm90aVN1Y2Nlc3MoKTsNCg0KICAgICAgaWYgKG1lLm9wdGlvbnMgJiYgbWUub3B0aW9ucy5zdWJtaXQpIHsNCiAgICAgICAgbWUub3B0aW9ucy5zdWJtaXQocmVzdWx0LCBwYXJhbSwgYWN0aW9uKTsNCiAgICAgIH0NCg0KICAgICAgbWUuaXNDaGFuZ2VEYXRhID0gdHJ1ZTsNCg0KICAgICAgc3dpdGNoIChwYXJhbS5Nb2RlKSB7DQogICAgICAgIGNhc2UgbWUuJG1zLmVudW0uU2F2ZU1vZGUuU2F2ZToNCiAgICAgICAgICBtZS5zYXZlQXZhdGFyKHJlc3VsdC5EYXRhLkVtcGxveWVlSUQpOw0KICAgICAgICAgIG1lLmFmdGVyU3VibWl0TW9kZVNhdmUocmVzdWx0LCBwYXJhbSk7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgbWUuJG1zLmVudW0uU2F2ZU1vZGUuU2F2ZU5ldzoNCiAgICAgICAgICBtZS5zYXZlQXZhdGFyKHJlc3VsdC5EYXRhLkVtcGxveWVlSUQpOw0KICAgICAgICAgIG1lLmFkZCh7fSk7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIC8vIHB2ZHV5IDA0LzAzLzIwMjEgY+G6pXQgdGjDoG5oIGPDtG5nIHThuqFpIG1vZGUgdmlldw0KICAgICAgICBjYXNlIG1lLiRtcy5lbnVtLlNhdmVNb2RlLlNhdmVWaWV3Og0KICAgICAgICAgIG1lLmFmdGVyU3VibWl0TW9kZVZpZXcoKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSBtZS4kbXMuZW51bS5TYXZlTW9kZS5TYXZlQW5kQ29uZmlnOg0KICAgICAgICAgIG1lLmFmdGVyU3VibWl0TW9kZVNhdmVBbmRDb25maWcocmVzdWx0LCBwYXJhbSwgYWN0aW9uKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICBtZS5oaWRlKCk7DQogICAgICAgICAgYnJlYWs7DQogICAgICB9DQoNCiAgICAgIC8vIE5NVFVBTjMgNy8zLzIwMjI6IFThuqFvIHRow7RuZyBiw6FvIHNhdSBraGkgc3VibWl0DQogICAgICBtZS5jcmVhdGVOb3RpZmljYXRpb24ocmVzdWx0LkRhdGEsIHBhcmFtLCBhY3Rpb24pOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBMxrB1IGzhuqFpIGF2YXRhciB0aGVvIEVtcGxveWVlSUQga2hpIHRow6ptIG3hu5tpIGjhu5Mgc8ahDQogICAgICogTlRESUVNIDE4LzAzLzIwMjINCiAgICAgKi8NCiAgICBzYXZlQXZhdGFyKHVzZXJJRCkgew0KICAgICAgY29uc3QgbWUgPSB0aGlzOw0KICAgICAgbGV0IHBhcmFtID0gew0KICAgICAgICB1c2VySUQ6IG1lLmN1cnJlbnRJdGVtLkVtcGxveWVlSUQsDQogICAgICAgIGZ1bGxOYW1lOiBtZS5jdXJyZW50SXRlbS5GdWxsTmFtZSwNCiAgICAgICAgdGVuYW50SUQ6IG1lLmNvbnRleHQuQ29udGV4dC5UZW5hbnRJRCwNCiAgICAgICAgb3JnYW5pemF0aW9uSUQ6IG1lLmNvbnRleHQuT3JnYW5pemF0aW9uLk9yZ2FuaXphdGlvbklELA0KICAgICAgfTsNCg0KICAgICAgaWYgKG1lLmF2YXRhckZpbGUpIHsNCiAgICAgICAgbWUuYXZhdGFyRmlsZS5GaWxlTmFtZSA9IHVzZXJJRC50b1N0cmluZygpOw0KICAgICAgICAvL1jDs2EgYXZhdGFyIGzDoCBjaHXhu5dpIGd1aWQgdHLhu5FuZyB0csOqbiBzdG9yYWdlDQogICAgICAgIG1lLmRlbGV0ZVRlbXBBdmF0YXIocGFyYW0udXNlcklELCBwYXJhbS50ZW5hbnRJRCwgcGFyYW0ub3JnYW5pemF0aW9uSUQpOw0KICAgICAgICAvL0zGsHUgbOG6oWkgYXZhdGFyIG5nxrDhu51pIGTDuW5nIGPDsyB0w6puIGLhurFuZyBFbXBsb3llZUlEDQogICAgICAgIGZpbGVBcGkudXBsb2FkcyhbbWUuYXZhdGFyRmlsZV0sIG1lLiRtcy5lbnVtLlN0b3JhZ2VGaWxlVHlwZS5BdmF0YXIpOw0KICAgICAgfQ0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBYw7NhIGF2YXRhciBjw7MgdMOqbiBsw6AgY2h14buXaSBndWlkIHLhu5duZyB0csOqbiBzdG9yYWdlDQogICAgICogTlRESUVNIDMxLzAzLzIwMjINCiAgICAgKi8NCiAgICBhc3luYyBkZWxldGVUZW1wQXZhdGFyKHVzZXJJRCwgdGVuYW5JRCwgb3JnYW5pemF0aW9uSUQpIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCg0KICAgICAgYXdhaXQgZmlsZUFwaS5kZWxldGVGaWxlKA0KICAgICAgICB1c2VySUQsDQogICAgICAgIG1lLiRtcy5lbnVtLlN0b3JhZ2VGaWxlVHlwZS5BdmF0YXIsDQogICAgICAgIHRlbmFuSUQsDQogICAgICAgIG9yZ2FuaXphdGlvbklEDQogICAgICApOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBAb3ZlcnJpZGUNCiAgICAgKiBLaeG7g20gdHJhIHbDoCB4w7NhIGF2YXRhciBraGkgxJHDs25nIGjhu5Mgc8ahIGPDoSBuaMOibg0KICAgICAqIE5URElFTSAzMS8wMy8yMDIyDQogICAgICovDQogICAgaGlkZSgpIHsNCiAgICAgIGNvbnN0IG1lID0gdGhpczsNCg0KICAgICAgLy9O4bq/dSBuZ8aw4budaSBkw7luZyB0aMOqbSBhdmF0YXIgLT4gxJHDs25nIGjhu5Mgc8ahIC0+IHjDs2EgZmlsZSDhuqNuaCBjw7MgVXNlcklkID0gZ3VpZCB0cuG7kW5nIHRyw6puIHN0b3JhZ2UgxJFpDQogICAgICBpZiAoDQogICAgICAgIG1lLmF2YXRhckZpbGUgJiYNCiAgICAgICAgbWUuY3VycmVudEl0ZW0uRW1wbG95ZWVJRCA9PSAiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIg0KICAgICAgKSB7DQogICAgICAgIG1lLmRlbGV0ZVRlbXBBdmF0YXIoDQogICAgICAgICAgbWUuY3VycmVudEl0ZW0uRW1wbG95ZWVJRCwNCiAgICAgICAgICBtZS5jb250ZXh0LkNvbnRleHQuVGVuYW50SUQsDQogICAgICAgICAgbWUuY29udGV4dC5Pcmdhbml6YXRpb24uT3JnYW5pemF0aW9uSUQNCiAgICAgICAgKTsNCiAgICAgIH0NCg0KICAgICAgbWUuc3VwZXIoImhpZGUiKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICog4bqobiBoaeG7h24gY2hpIHRp4bq/dCBjw6FjIHRow7RuZyB0aW4NCiAgICAgKiBESFBoaSAyOC8wMy8yMDIyDQogICAgICovDQogICAgaGlkZUluZm9ybWF0aW9uKHZhbHVlKSB7DQogICAgICBzd2l0Y2ggKHZhbHVlKSB7DQogICAgICAgIGNhc2UgImhpZGVJbmZvciI6DQogICAgICAgICAgdGhpcy5oaWRlSW5mb3IgPSAhdGhpcy5oaWRlSW5mb3I7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgImhpZGVFbXVsYXRpb25SZXdhcmQiOg0KICAgICAgICAgIHRoaXMuaGlkZUVtdWxhdGlvblJld2FyZCA9ICF0aGlzLmhpZGVFbXVsYXRpb25SZXdhcmQ7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgImhpZGVFdmFsdWF0aW9uIjoNCiAgICAgICAgICB0aGlzLmhpZGVFdmFsdWF0aW9uID0gIXRoaXMuaGlkZUV2YWx1YXRpb247DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgImhpZGVBY2hpZXZlbWVudElkZWEiOg0KICAgICAgICAgIHRoaXMuaGlkZUFjaGlldmVtZW50SWRlYSA9ICF0aGlzLmhpZGVBY2hpZXZlbWVudElkZWE7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgImhpZGVBdHRhY2htZW50IjoNCiAgICAgICAgICB0aGlzLmhpZGVBdHRhY2htZW50ID0gIXRoaXMuaGlkZUF0dGFjaG1lbnQ7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgYnJlYWs7DQogICAgICB9DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIFTDrW5oIHThu5VuZyBkdW5nIGzGsOG7o25nIGZpbGUNCiAgICAgKiBOVERJRU0gMDcvMDQvMjAyMg0KICAgICAqLw0KICAgIGNhY3VsYXRlRmlsZVNpemUoKSB7DQogICAgICBjb25zdCBtZSA9IHRoaXM7DQoNCiAgICAgIG1lLmZpbGVTaXplU3VtYXJ5ID0gMDsgLy9Hw6FuIGLhurFuZyAwIMSR4buDIHTDrW5oIGzhuqFpIGtoaSBjw7Mgc+G7sSB0aGF5IMSR4buVaSB04buHcCDEkcOtbmgga8OobQ0KICAgICAgbGV0IHR5cGUgPSAiIjsNCiAgICAgIGlmIChtZS5saXN0U291cmNlQXR0YWNobWVudERldGFpbCkgew0KICAgICAgICBtZS5saXN0U291cmNlQXR0YWNobWVudERldGFpbC5mb3JFYWNoKChhdHRhY2htZW50KSA9PiB7DQogICAgICAgICAgdHlwZSA9IGF0dGFjaG1lbnQuRmlsZVNpemUuc2xpY2UoDQogICAgICAgICAgICBhdHRhY2htZW50LkZpbGVTaXplLmxlbmd0aCAtIDIsDQogICAgICAgICAgICBhdHRhY2htZW50LkZpbGVTaXplLmxlbmd0aA0KICAgICAgICAgICk7DQogICAgICAgICAgc3dpdGNoICh0eXBlKSB7DQogICAgICAgICAgICBjYXNlICJNQiI6DQogICAgICAgICAgICAgIG1lLmZpbGVTaXplU3VtYXJ5ICs9DQogICAgICAgICAgICAgICAgcGFyc2VGbG9hdCgNCiAgICAgICAgICAgICAgICAgIGF0dGFjaG1lbnQuRmlsZVNpemUuc2xpY2UoMCwgYXR0YWNobWVudC5GaWxlU2l6ZS5sZW5ndGggLSAzKQ0KICAgICAgICAgICAgICAgICkgKiAxMDQ4NTc2Ow0KICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgIktCIjoNCiAgICAgICAgICAgICAgbWUuZmlsZVNpemVTdW1hcnkgKz0NCiAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KA0KICAgICAgICAgICAgICAgICAgYXR0YWNobWVudC5GaWxlU2l6ZS5zbGljZSgwLCBhdHRhY2htZW50LkZpbGVTaXplLmxlbmd0aCAtIDMpDQogICAgICAgICAgICAgICAgKSAqIDEwMjQ7DQogICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICB9LA0KICB9LA0KfTsNCg=="},null]}